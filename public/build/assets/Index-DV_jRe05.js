import{c as l,b as t,i as _,w as f,g as p,u as k,s as C,d as n,F as x,r as b,n as v,o as s,k as j,p as J,a as M,h as E,q as m,t as d,v as U,B as S,f as q,j as G}from"./app-BNdkYu5R.js";import{_ as K}from"./AuthenticatedLayout-scuR3k28.js";import"./ApplicationLogo-Btd2wIUd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-7-ZIUky-.js";const Q={key:0,class:"flex items-center justify-between"},W={class:"flex flex-1 justify-between sm:hidden"},X={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-center"},Y={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},Z=["innerHTML"],tt={__name:"Pagination",props:{links:Array},setup(i){return(u,o)=>i.links.length>3?(s(),l("nav",Q,[t("div",W,[i.links[0].url?(s(),_(k(C),{key:0,href:i.links[0].url,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"},{default:f(()=>[...o[0]||(o[0]=[p(" Précédent ",-1)])]),_:1},8,["href"])):n("",!0),i.links[i.links.length-1].url?(s(),_(k(C),{key:1,href:i.links[i.links.length-1].url,class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"},{default:f(()=>[...o[1]||(o[1]=[p(" Suivant ",-1)])]),_:1},8,["href"])):n("",!0)]),t("div",X,[t("div",null,[t("nav",Y,[(s(!0),l(x,null,b(i.links,(a,g)=>(s(),l(x,{key:g},[a.url?(s(),_(k(C),{key:0,href:a.url,innerHTML:a.label,class:v(["relative inline-flex items-center border px-4 py-2 text-sm font-medium focus:z-20",[a.active?"z-10 border-indigo-500 bg-indigo-50 text-indigo-600 dark:border-indigo-400 dark:bg-indigo-900/50 dark:text-indigo-400":"border-gray-300 bg-white text-gray-500 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700",g===0?"rounded-l-md":"",g===i.links.length-1?"rounded-r-md":""]])},null,8,["href","innerHTML","class"])):(s(),l("span",{key:1,innerHTML:a.label,class:v(["relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-400 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-500",[g===0?"rounded-l-md":"",g===i.links.length-1?"rounded-r-md":""]])},null,10,Z))],64))),128))])])])])):n("",!0)}},et={class:"py-12"},rt={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},at={class:"mb-6 rounded-lg bg-white p-4 shadow dark:bg-gray-800"},st={class:"grid grid-cols-1 gap-4 md:grid-cols-5"},dt=["value"],lt={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ot={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},it={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},nt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-200"},gt={class:"text-xs text-gray-500 dark:text-gray-400"},ut={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-200"},yt={class:"mr-2"},xt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},mt={key:0},ct={key:1},kt={class:"whitespace-nowrap px-6 py-4 text-sm"},bt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},ft={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},pt=["onClick"],vt={key:0},ht={key:0,class:"border-t border-gray-200 px-4 py-3 dark:border-gray-700"},wt={class:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0"},_t={class:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all dark:bg-gray-800 sm:my-8 sm:w-full sm:max-w-2xl sm:align-middle"},Ct={class:"bg-white px-4 pb-4 pt-5 dark:bg-gray-800 sm:p-6 sm:pb-4"},jt={class:"flex items-start justify-between"},Mt={class:"text-lg font-medium leading-6 text-gray-900 dark:text-gray-100"},St={class:"mt-4 space-y-4"},Tt={class:"grid grid-cols-2 gap-4 text-sm"},Vt={class:"ml-2 text-gray-900 dark:text-gray-100"},At={key:0},Bt={class:"ml-2 text-gray-900 dark:text-gray-100"},$t={class:"ml-2 text-gray-900 dark:text-gray-100"},Dt={key:0},Lt={class:"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-600"},Ft={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-600"},Nt={class:"divide-y divide-gray-200 dark:divide-gray-600"},Pt={class:"px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100"},Ht={class:"px-4 py-2 text-sm text-red-600 dark:text-red-400"},Ot={class:"px-4 py-2 text-sm text-green-600 dark:text-green-400"},Ut={key:1},zt={class:"overflow-auto rounded-lg bg-gray-100 p-3 text-xs dark:bg-gray-700"},It={key:2},Rt={class:"break-all text-sm text-gray-600 dark:text-gray-400"},Qt={__name:"Index",props:{logs:Object,filters:Object,categories:Array},setup(i){const u=i,o=j({category:u.filters.category||"",from:u.filters.from||"",to:u.filters.to||"",status:u.filters.status||"",search:u.filters.search||""}),a=j(null),g=j(!1),y=()=>{G.get(route("audit-logs.index"),{...o.value},{preserveState:!0,preserveScroll:!0})},z=()=>{o.value={category:"",from:"",to:"",status:"",search:""},y()},I=c=>{a.value=c,g.value=!0},h=()=>{g.value=!1,a.value=null},R=()=>{window.location.href=route("audit-logs.export",o.value)},T=c=>c==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";let V;return J(()=>o.value.search,()=>{clearTimeout(V),V=setTimeout(y,500)}),(c,e)=>(s(),l(x,null,[M(k(E),{title:"Journal d'activité"}),M(K,null,{header:f(()=>[t("div",{class:"flex items-center justify-between"},[e[6]||(e[6]=t("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"}," Journal d'activité ",-1)),t("button",{onClick:R,class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-200 dark:ring-gray-600 dark:hover:bg-gray-600"},[...e[5]||(e[5]=[t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),p(" Exporter CSV ",-1)])])])]),default:f(()=>{var A,B,$,D,L,F,N,P,H,O;return[t("div",et,[t("div",rt,[t("div",at,[t("div",st,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Catégorie",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.category=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},[e[7]||(e[7]=t("option",{value:""},"Toutes",-1)),(s(!0),l(x,null,b(i.categories,r=>(s(),l("option",{key:r.value,value:r.value},d(r.label),9,dt))),128))],544),[[U,o.value.category]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Du",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=r=>o.value.from=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,544),[[S,o.value.from]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Au",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=r=>o.value.to=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,544),[[S,o.value.to]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Statut",-1)),m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.value.status=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},[...e[11]||(e[11]=[t("option",{value:""},"Tous",-1),t("option",{value:"success"},"Succès",-1),t("option",{value:"failed"},"Échec",-1)])],544),[[U,o.value.status]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Rechercher",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=r=>o.value.search=r),placeholder:"Action, IP...",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,512),[[S,o.value.search]])])]),t("div",{class:"mt-4 flex justify-end"},[t("button",{onClick:z,class:"text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"}," Réinitialiser les filtres ")])]),t("div",lt,[t("table",ot,[e[15]||(e[15]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Date/Heure "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Action "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Ressource "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Statut "),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," IP "),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," Actions ")])],-1)),t("tbody",it,[(s(!0),l(x,null,b(i.logs.data,r=>(s(),l("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",nt,[t("div",null,d(r.created_at),1),t("div",gt,d(r.created_at_human),1)]),t("td",ut,[t("span",yt,d(r.action_emoji),1),p(" "+d(r.action_label),1)]),t("td",xt,[r.auditable_type?(s(),l("span",mt,d(r.auditable_type)+" #"+d(r.auditable_id),1)):(s(),l("span",ct,"-"))]),t("td",kt,[t("span",{class:v([T(r.status),"inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},d(r.status==="success"?"Succès":"Échec"),3)]),t("td",bt,d(r.ip_address||"-"),1),t("td",ft,[t("button",{onClick:w=>I(r),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"}," Détails ",8,pt)])]))),128)),i.logs.data.length===0?(s(),l("tr",vt,[...e[14]||(e[14]=[t("td",{colspan:"6",class:"px-6 py-12 text-center text-sm text-gray-500 dark:text-gray-400"}," Aucune entrée dans le journal d'activité. ",-1)])])):n("",!0)])]),i.logs.data.length>0?(s(),l("div",ht,[M(tt,{links:i.logs.links},null,8,["links"])])):n("",!0)])])]),g.value?(s(),l("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:q(h,["self"])},[t("div",wt,[e[25]||(e[25]=t("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900"})],-1)),e[26]||(e[26]=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"​",-1)),t("div",_t,[t("div",Ct,[t("div",jt,[t("h3",Mt,d((A=a.value)==null?void 0:A.action_emoji)+" "+d((B=a.value)==null?void 0:B.action_label),1),t("button",{onClick:h,class:"text-gray-400 hover:text-gray-500"},[...e[16]||(e[16]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",St,[t("div",Tt,[t("div",null,[e[17]||(e[17]=t("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"Date :",-1)),t("span",Vt,d(($=a.value)==null?void 0:$.created_at),1)]),t("div",null,[e[18]||(e[18]=t("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"Statut :",-1)),t("span",{class:v([T((D=a.value)==null?void 0:D.status),"ml-2 inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},d(((L=a.value)==null?void 0:L.status)==="success"?"Succès":"Échec"),3)]),(F=a.value)!=null&&F.auditable_type?(s(),l("div",At,[e[19]||(e[19]=t("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"Ressource :",-1)),t("span",Bt,d(a.value.auditable_type)+" #"+d(a.value.auditable_id),1)])):n("",!0),t("div",null,[e[20]||(e[20]=t("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"IP :",-1)),t("span",$t,d(((N=a.value)==null?void 0:N.ip_address)||"-"),1)])]),(P=a.value)!=null&&P.changed_fields&&Object.keys(a.value.changed_fields).length>0?(s(),l("div",Dt,[e[22]||(e[22]=t("h4",{class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},"Modifications :",-1)),t("div",Lt,[t("table",Ft,[e[21]||(e[21]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},"Champ"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},"Avant"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},"Après")])],-1)),t("tbody",Nt,[(s(!0),l(x,null,b(a.value.changed_fields,(r,w)=>(s(),l("tr",{key:w},[t("td",Pt,d(w),1),t("td",Ht,d(r.old??"-"),1),t("td",Ot,d(r.new??"-"),1)]))),128))])])])])):n("",!0),(H=a.value)!=null&&H.metadata&&Object.keys(a.value.metadata).length>0?(s(),l("div",Ut,[e[23]||(e[23]=t("h4",{class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},"Métadonnées :",-1)),t("pre",zt,d(JSON.stringify(a.value.metadata,null,2)),1)])):n("",!0),(O=a.value)!=null&&O.user_agent?(s(),l("div",It,[e[24]||(e[24]=t("h4",{class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},"Navigateur :",-1)),t("p",Rt,d(a.value.user_agent),1)])):n("",!0)])]),t("div",{class:"bg-gray-50 px-4 py-3 dark:bg-gray-700 sm:flex sm:flex-row-reverse sm:px-6"},[t("button",{onClick:h,class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-600 sm:ml-3 sm:mt-0 sm:w-auto sm:text-sm"}," Fermer ")])])])])):n("",!0)]}),_:1})],64))}};export{Qt as default};
