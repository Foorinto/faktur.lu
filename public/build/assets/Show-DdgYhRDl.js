import{u as L,c as r,a as u,b as l,h as D,i as p,d as e,t as a,x as f,o as d,F as h,j as C,e as b,g as N,w as T,f as V,v as q,l as M,r as j}from"./app-WPm1OF2O.js";import{_ as I}from"./AppLayout-BTmNPb5-.js";import{u as R}from"./useTranslations-1apgeaO4.js";import{_ as U}from"./PrimaryButton-CN5TWnQp.js";import{_ as $}from"./InputError-CsMzV-Dp.js";import"./DropdownLink-BLl5iJ8c.js";const O={class:"flex items-center gap-4"},E={class:"text-xl font-semibold text-slate-900 dark:text-white"},G={class:"mx-auto max-w-3xl"},H={class:"mb-6 rounded-2xl bg-white p-6 border border-slate-200 dark:bg-slate-800 dark:border-slate-700"},J={class:"flex items-start justify-between"},K={class:"text-lg font-medium text-slate-900 dark:text-white"},P={class:"mt-1 text-sm text-slate-500 dark:text-slate-400"},Q={class:"space-y-4 mb-6"},W={class:"flex items-center gap-2 mb-2"},X={key:0,class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},Y={class:"flex-1"},Z={class:"text-xs text-slate-500 dark:text-slate-400 ml-2"},ee={class:"pl-10 text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap"},te={key:0,class:"mt-3 pl-10"},se=["href"],ae={class:"text-slate-400"},le={key:0,class:"rounded-2xl bg-white p-6 border border-slate-200 dark:bg-slate-800 dark:border-slate-700"},re={class:"text-lg font-medium text-slate-900 dark:text-white mb-4"},de=["placeholder"],oe={class:"mt-4"},ne={key:0,class:"flex items-center justify-between rounded-xl bg-slate-50 p-3 dark:bg-slate-700"},ie={class:"flex items-center gap-2"},ce={class:"text-sm text-slate-600 dark:text-slate-300"},ue={key:1,class:"inline-flex cursor-pointer items-center gap-2 text-sm text-slate-500 hover:text-primary-600 dark:text-slate-400 dark:hover:text-primary-400"},pe={class:"mt-4 flex justify-end"},me={key:1,class:"rounded-2xl bg-slate-50 p-6 text-center dark:bg-slate-800/50"},xe={class:"text-sm text-slate-500 dark:text-slate-400"},ye={__name:"Show",props:{ticket:{type:Object,required:!0},statuses:{type:Object,required:!0},canReply:{type:Boolean,default:!0}},setup(o){const{t:n}=R(),S=o,i=L({message:"",attachment:null}),k=j(null),m=j(""),B=c=>{const t=c.target.files[0];t&&(i.attachment=t,m.value=t.name)},g=()=>{i.attachment=null,m.value="",k.value&&(k.value.value="")},z=()=>{i.post(route("support.reply",S.ticket.id),{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{i.reset(),g()}})},F=c=>{const t={new:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",open:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",in_progress:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",waiting:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",resolved:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",closed:"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-400"};return t[c]||t.closed},v=c=>{const t=new Date(c);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)};return(c,t)=>(d(),r(h,null,[u(l(D),{title:o.ticket.reference+" - "+o.ticket.subject},null,8,["title"]),u(I,null,{header:p(()=>[e("div",O,[u(l(M),{href:c.route("support.index"),class:"rounded-lg p-2 text-slate-400 hover:bg-slate-100 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-slate-300"},{default:p(()=>[...t[1]||(t[1]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("div",null,[e("h1",E,a(o.ticket.reference),1)])])]),default:p(()=>[e("div",G,[e("div",H,[e("div",J,[e("div",null,[e("h2",K,a(o.ticket.subject),1),e("p",P,a(l(n)("created_on"))+" "+a(v(o.ticket.created_at)),1)]),e("span",{class:f([F(o.ticket.status),"inline-flex items-center rounded-xl px-3 py-1 text-sm font-medium"])},a(o.statuses[o.ticket.status]),3)])]),e("div",Q,[(d(!0),r(h,null,C(o.ticket.messages,s=>{var y,_,w,A;return d(),r("div",{key:s.id,class:f(["rounded-2xl p-4",s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"bg-primary-50 border border-primary-100 dark:bg-primary-900/20 dark:border-primary-800":"bg-white border border-slate-200 dark:bg-slate-800 dark:border-slate-700"])},[e("div",W,[e("div",{class:f(["h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium",s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"bg-primary-500 text-white":"bg-slate-200 text-slate-600 dark:bg-slate-600 dark:text-slate-300"])},[s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?(d(),r("svg",X,[...t[2]||(t[2]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.99 5.99 0 00-4.793 2.39A6.483 6.483 0 0010 16.5a6.483 6.483 0 004.793-2.11A5.99 5.99 0 0010 12z","clip-rule":"evenodd"},null,-1)])])):(d(),r(h,{key:1},[b(a(((w=(_=(y=s.sender)==null?void 0:y.name)==null?void 0:_.charAt(0))==null?void 0:w.toUpperCase())||"U"),1)],64))],2),e("div",Y,[e("span",{class:f(["text-sm font-medium",s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"text-primary-700 dark:text-primary-400":"text-slate-900 dark:text-white"])},a(s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"Support":((A=s.sender)==null?void 0:A.name)||l(n)("you")),3),e("span",Z,a(v(s.created_at)),1)])]),e("div",ee,a(s.content),1),s.attachments&&s.attachments.length>0?(d(),r("div",te,[(d(!0),r(h,null,C(s.attachments,x=>(d(),r("div",{key:x.id,class:"inline-flex items-center gap-2 rounded-lg bg-slate-100 px-3 py-1.5 text-sm dark:bg-slate-700"},[t[3]||(t[3]=e("svg",{class:"h-4 w-4 text-slate-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M15.621 4.379a3 3 0 00-4.242 0l-7 7a3 3 0 004.241 4.243h.001l.497-.5a.75.75 0 011.064 1.057l-.498.501-.002.002a4.5 4.5 0 01-6.364-6.364l7-7a4.5 4.5 0 016.368 6.36l-3.455 3.553A2.625 2.625 0 119.52 9.52l3.45-3.451a.75.75 0 111.061 1.06l-3.45 3.451a1.125 1.125 0 001.587 1.595l3.454-3.553a3 3 0 000-4.242z","clip-rule":"evenodd"})],-1)),e("a",{href:x.url,target:"_blank",class:"text-primary-600 hover:text-primary-500 dark:text-primary-400"},a(x.filename),9,se),e("span",ae,a(x.size_formatted),1)]))),128))])):N("",!0)],2)}),128))]),o.canReply?(d(),r("div",le,[e("h3",re,a(l(n)("reply")),1),e("form",{onSubmit:T(z,["prevent"])},[V(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>l(i).message=s),rows:"4",class:"block w-full rounded-xl border-0 py-2 px-3 text-slate-900 ring-1 ring-inset ring-slate-200 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-primary-500 dark:bg-slate-700 dark:text-white dark:ring-slate-600 dark:placeholder:text-slate-500 sm:text-sm sm:leading-6",placeholder:l(n)("your_reply"),required:""},null,8,de),[[q,l(i).message]]),u($,{message:l(i).errors.message,class:"mt-2"},null,8,["message"]),e("div",oe,[m.value?(d(),r("div",ne,[e("div",ie,[t[4]||(t[4]=e("svg",{class:"h-5 w-5 text-slate-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M15.621 4.379a3 3 0 00-4.242 0l-7 7a3 3 0 004.241 4.243h.001l.497-.5a.75.75 0 011.064 1.057l-.498.501-.002.002a4.5 4.5 0 01-6.364-6.364l7-7a4.5 4.5 0 016.368 6.36l-3.455 3.553A2.625 2.625 0 119.52 9.52l3.45-3.451a.75.75 0 111.061 1.06l-3.45 3.451a1.125 1.125 0 001.587 1.595l3.454-3.553a3 3 0 000-4.242z","clip-rule":"evenodd"})],-1)),e("span",ce,a(m.value),1)]),e("button",{type:"button",onClick:g,class:"rounded p-1 text-slate-400 hover:bg-slate-200 hover:text-slate-600 dark:hover:bg-slate-600"},[...t[5]||(t[5]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])):(d(),r("label",ue,[t[6]||(t[6]=e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)),e("span",null,a(l(n)("add_attachment")),1),e("input",{ref_key:"fileInput",ref:k,type:"file",class:"hidden",onChange:B,accept:".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.xls,.xlsx,.txt"},null,544)]))]),e("div",pe,[u(U,{disabled:l(i).processing},{default:p(()=>[b(a(l(n)("send")),1)]),_:1},8,["disabled"])])],32)])):(d(),r("div",me,[e("p",xe,a(l(n)("ticket_closed_message")),1),u(l(M),{href:c.route("support.create"),class:"mt-4 inline-flex items-center text-primary-600 hover:text-primary-500 dark:text-primary-400"},{default:p(()=>[b(a(l(n)("new_request")),1)]),_:1},8,["href"])]))])]),_:1})],64))}};export{ye as default};
