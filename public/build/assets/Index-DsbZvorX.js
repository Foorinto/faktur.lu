import{k as v,e as B,l as ce,K as xe,p as W,c as l,a as N,u as o,h as pe,w as H,b as e,o as i,t as d,g as V,f as $,q as m,F as f,r as S,v as h,B as k,d as x,n as X,i as ye,s as P,z as be,j as K,A as Y}from"./app-B2KrZOCa.js";import{_ as ve}from"./AppLayout-CMhKAyAT.js";import"./ApplicationLogo-CBvPJGvQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Dw9Qk6Ag.js";const fe={class:"flex items-center justify-between"},he={class:"mb-6 overflow-hidden rounded-lg bg-gradient-to-r from-indigo-500 to-purple-600 shadow-lg"},ke={class:"px-6 py-5"},we={key:0,class:"flex items-center justify-between"},_e={class:"mt-1 text-3xl font-bold text-white"},Se={class:"mt-1 text-sm text-indigo-200"},Ae=["disabled"],je={key:0,class:"mr-2 h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none"},Te={key:1,class:"mr-2 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},Ce={key:1},Ve=["value"],Me=["disabled"],ze={class:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3"},De={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 px-4 py-5"},Fe={class:"mt-1 text-2xl font-semibold text-gray-900 dark:text-white"},Ee={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 px-4 py-5"},Ie={class:"mt-1 text-2xl font-semibold text-amber-600 dark:text-amber-400"},Ue={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 px-4 py-5"},Re={class:"mt-1 text-2xl font-semibold text-indigo-600 dark:text-indigo-400"},Be={class:"mb-6 overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ne={class:"grid grid-cols-1 gap-4 sm:grid-cols-6"},He={class:"sm:col-span-1"},$e={class:"sm:col-span-1"},qe=["value"],Le={class:"sm:col-span-1"},Oe={class:"sm:col-span-1"},Pe={class:"sm:col-span-1"},Ke={class:"sm:col-span-1 flex items-end"},Ge=["disabled"],Je={class:"mb-6 flex flex-wrap items-center justify-between gap-4"},Qe={class:"flex flex-wrap gap-4"},We=["value"],Xe=["value"],Ye={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ze={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},et={class:"bg-gray-50 dark:bg-gray-700"},tt={class:"py-3.5 pl-4 pr-3 sm:pl-6"},rt=["checked"],st={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},ot={key:0},it={class:"py-4 pl-4 pr-3 sm:pl-6"},lt=["checked","onChange"],dt={class:"whitespace-nowrap py-4 px-3 text-sm text-gray-500 dark:text-gray-400"},at={class:"text-xs"},nt={class:"whitespace-nowrap px-3 py-4"},ut={class:"font-medium text-gray-900 dark:text-white"},mt={class:"text-sm text-gray-500 dark:text-gray-400"},gt={class:"hidden px-3 py-4 text-sm text-gray-500 dark:text-gray-400 md:table-cell"},ct={class:"truncate max-w-xs block"},xt={class:"whitespace-nowrap px-3 py-4 text-right text-sm font-mono font-medium text-gray-900 dark:text-white"},pt={class:"hidden whitespace-nowrap px-3 py-4 text-right text-sm text-gray-500 dark:text-gray-400 lg:table-cell"},yt={class:"whitespace-nowrap px-3 py-4 text-center text-sm"},bt={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},vt={key:0,class:"flex items-center justify-end gap-2"},ft=["onClick"],ht=["onClick"],kt={key:0,class:"mt-6 flex items-center justify-between"},wt={class:"text-sm text-gray-700 dark:text-gray-400"},_t={class:"isolate inline-flex -space-x-px rounded-md shadow-sm"},St={key:1,class:"relative z-50"},At={class:"fixed inset-0 z-50 overflow-y-auto"},jt={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Tt={class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all dark:bg-gray-800 sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},Ct={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Vt={class:"mt-1 relative rounded-md shadow-sm"},Mt={key:1,class:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 sm:text-sm"},zt={class:"flex items-center"},Dt={class:"mt-6 flex justify-end space-x-3"},Ft=["disabled"],Et={key:2,class:"relative z-50"},It={class:"fixed inset-0 z-50 overflow-y-auto"},Ut={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Rt={class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all dark:bg-gray-800 sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},Bt={key:0,class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},Nt={key:0,class:"rounded-md bg-amber-50 p-4 dark:bg-amber-900/20"},Ht={key:1},$t=["value"],qt={key:2,class:"grid grid-cols-2 gap-4"},Lt={class:"mt-1 relative rounded-md shadow-sm"},Ot={key:1,class:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 sm:text-sm"},Pt={class:"mt-6 flex justify-end space-x-3"},Kt=["disabled"],Zt={__name:"Index",props:{entries:Object,runningTimer:Object,summary:Object,filters:Object,clients:Array,periods:Array,draftInvoices:Array,defaultHourlyRate:[Number,String],isVatExempt:Boolean},setup(a){const n=a,q=n.isVatExempt?0:17,M=v(n.filters.client_id||""),z=v(n.filters.billed||""),D=v(n.filters.period||""),u=v([]),F=v(!1),E=v(!1),y=v(null),p=B({client_id:"",project_name:"",description:""}),g=B({client_id:"",project_name:"",description:"",date:new Date().toISOString().split("T")[0],duration:""}),b=B({time_entry_ids:[],hourly_rate:100,vat_rate:q,group_by_project:!0}),c=B({invoice_id:"",hourly_rate:"",vat_rate:q}),A=v(0),j=v(!1),Z=v(null);let w=null,I=null;const ee=s=>{const t=s.target;t.style.height="auto",t.style.height=Math.min(t.scrollHeight,128)+"px"},G=()=>I?Math.floor((Date.now()-I)/1e3):0,L=()=>{w&&(clearInterval(w),w=null),n.runningTimer&&n.runningTimer.started_at&&(I=new Date(n.runningTimer.started_at).getTime(),A.value=G(),w=setInterval(()=>{A.value=G()},1e3))},O=()=>{w&&(clearInterval(w),w=null),I=null,A.value=0};ce(()=>{n.runningTimer&&L()}),xe(()=>{O()}),W(()=>n.runningTimer,(s,t)=>{s&&!t?L():!s&&t?O():s&&t&&s.id!==t.id&&L()},{deep:!0});const te=Y(()=>{const s=Math.floor(A.value/3600),t=Math.floor(A.value%3600/60),_=A.value%60;return`${s}:${String(t).padStart(2,"0")}:${String(_).padStart(2,"0")}`});W([M,z,D],()=>{K.get(route("time-entries.index"),{client_id:M.value||void 0,billed:z.value||void 0,period:D.value||void 0},{preserveState:!0,replace:!0})});const re=()=>{p.processing||p.post(route("time-entries.start"),{preserveScroll:!0,onSuccess:()=>{p.reset()}})},se=()=>{!n.runningTimer||j.value||(j.value=!0,K.post(route("time-entries.stop",n.runningTimer.id),{},{preserveScroll:!0,onSuccess:()=>{O()},onFinish:()=>{j.value=!1}}))},oe=()=>{g.post(route("time-entries.store"),{preserveScroll:!0,onSuccess:()=>{g.reset(),g.date=new Date().toISOString().split("T")[0]}})},ie=s=>{confirm("Supprimer cette entrée de temps ?")&&K.delete(route("time-entries.destroy",s.id),{preserveScroll:!0})},le=s=>{const t=u.value.indexOf(s);t===-1?u.value.push(s):u.value.splice(t,1)},de=()=>{const s=n.entries.data.filter(t=>!t.is_billed);u.value.length===s.length?u.value=[]:u.value=s.map(t=>t.id)},ae=()=>{if(u.value.length===0){alert("Veuillez sélectionner au moins une entrée de temps.");return}const s=n.entries.data.find(t=>t.id===u.value[0]);s&&s.client&&(b.hourly_rate=s.client.default_hourly_rate||100),F.value=!0},ne=()=>{b.time_entry_ids=u.value,b.post(route("time-entries.to-invoice"),{onSuccess:()=>{F.value=!1,u.value=[]}})},U=Y(()=>y.value?n.draftInvoices.filter(s=>s.client_id===y.value.client_id):[]),ue=s=>{y.value=s,c.reset(),c.vat_rate=q;const t=n.clients.find(T=>T.id===s.client_id);c.hourly_rate=s.hourly_rate||(t==null?void 0:t.default_hourly_rate)||n.defaultHourlyRate||0;const _=n.draftInvoices.filter(T=>T.client_id===s.client_id);_.length>0&&(c.invoice_id=_[0].id),E.value=!0},me=()=>{y.value&&c.post(route("time-entries.add-to-invoice",y.value.id),{onSuccess:()=>{E.value=!1,y.value=null}})},J=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(s),ge=s=>s?new Date(s).toLocaleDateString("fr-FR"):"-",Q=s=>s?new Date(s).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"-";return(s,t)=>(i(),l(f,null,[N(o(pe),{title:"Suivi du temps"}),N(ve,null,{header:H(()=>[e("div",fe,[t[20]||(t[20]=e("h1",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Suivi du temps ",-1)),N(o(P),{href:s.route("time-entries.summary"),class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},{default:H(()=>[...t[19]||(t[19]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M15.5 2A1.5 1.5 0 0014 3.5v13a1.5 1.5 0 001.5 1.5h1a1.5 1.5 0 001.5-1.5v-13A1.5 1.5 0 0016.5 2h-1zM9.5 6A1.5 1.5 0 008 7.5v9A1.5 1.5 0 009.5 18h1a1.5 1.5 0 001.5-1.5v-9A1.5 1.5 0 0010.5 6h-1zM3.5 10A1.5 1.5 0 002 11.5v5A1.5 1.5 0 003.5 18h1A1.5 1.5 0 006 16.5v-5A1.5 1.5 0 004.5 10h-1z"})],-1),V(" Résumé ",-1)])]),_:1},8,["href"])])]),default:H(()=>{var _,T;return[e("div",he,[e("div",ke,[a.runningTimer?(i(),l("div",we,[e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm font-medium text-indigo-100"},"Timer en cours",-1)),e("p",_e,d(te.value),1),e("p",Se,d((_=a.runningTimer.client)==null?void 0:_.name)+" - "+d(a.runningTimer.project_name||"Sans projet"),1)]),e("button",{onClick:se,disabled:j.value,class:"inline-flex items-center rounded-full bg-white/20 px-6 py-3 text-sm font-semibold text-white backdrop-blur hover:bg-white/30 focus:outline-none focus:ring-2 focus:ring-white disabled:opacity-50 disabled:cursor-not-allowed"},[j.value?(i(),l("svg",je,[...t[22]||(t[22]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(i(),l("svg",Te,[...t[23]||(t[23]=[e("path",{"fill-rule":"evenodd",d:"M5.5 3.5A1.5 1.5 0 017 5v10a1.5 1.5 0 01-3 0V5a1.5 1.5 0 011.5-1.5zm8 0A1.5 1.5 0 0115 5v10a1.5 1.5 0 01-3 0V5a1.5 1.5 0 011.5-1.5z","clip-rule":"evenodd"},null,-1)])])),V(" "+d(j.value?"Arrêt...":"Arrêter"),1)],8,Ae)])):(i(),l("div",Ce,[t[26]||(t[26]=e("p",{class:"mb-4 text-sm font-medium text-indigo-100"},"Démarrer un nouveau timer",-1)),e("form",{onSubmit:$(re,["prevent"]),class:"flex flex-wrap gap-3"},[m(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>o(p).client_id=r),required:"",class:"rounded-md border-0 bg-white/10 py-2 pl-3 pr-10 text-white placeholder-indigo-200 backdrop-blur focus:ring-2 focus:ring-white sm:text-sm"},[t[24]||(t[24]=e("option",{value:"",class:"text-gray-900"},"Sélectionner un client",-1)),(i(!0),l(f,null,S(a.clients,r=>(i(),l("option",{key:r.id,value:r.id,class:"text-gray-900"},d(r.name),9,Ve))),128))],512),[[h,o(p).client_id]]),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>o(p).project_name=r),type:"text",placeholder:"Nom du projet",class:"rounded-md border-0 bg-white/10 py-2 px-3 text-white placeholder-indigo-200 backdrop-blur focus:ring-2 focus:ring-white sm:text-sm"},null,512),[[k,o(p).project_name]]),m(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=r=>o(p).description=r),placeholder:"Description (optionnel)",rows:"1",onInput:ee,ref_key:"timerDescriptionRef",ref:Z,class:"flex-1 rounded-md border-0 bg-white/10 py-2 px-3 text-white placeholder-indigo-200 backdrop-blur focus:ring-2 focus:ring-white sm:text-sm resize-y min-h-[38px] max-h-32"},null,544),[[k,o(p).description]]),e("button",{type:"submit",disabled:o(p).processing||!o(p).client_id,class:"inline-flex items-center rounded-full bg-white px-6 py-2 text-sm font-semibold text-indigo-600 shadow-sm hover:bg-indigo-50 disabled:opacity-50"},[...t[25]||(t[25]=[e("svg",{class:"mr-2 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})],-1),V(" Démarrer ",-1)])],8,Me)],32)]))])]),e("div",ze,[e("div",De,[t[27]||(t[27]=e("dt",{class:"truncate text-sm font-medium text-gray-500 dark:text-gray-400"},"Temps total",-1)),e("dd",Fe,d(a.summary.total_formatted),1)]),e("div",Ee,[t[28]||(t[28]=e("dt",{class:"truncate text-sm font-medium text-gray-500 dark:text-gray-400"},"Non facturé",-1)),e("dd",Ie,d(a.summary.unbilled_formatted),1)]),e("div",Ue,[t[29]||(t[29]=e("dt",{class:"truncate text-sm font-medium text-gray-500 dark:text-gray-400"},"Sélectionné",-1)),e("dd",Re,d(u.value.length)+" entrées ",1)])]),e("div",Be,[t[36]||(t[36]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h3",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Ajouter une entrée manuelle")],-1)),e("form",{onSubmit:$(oe,["prevent"]),class:"px-6 py-4"},[e("div",Ne,[e("div",He,[t[30]||(t[30]=e("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},"Date",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>o(g).date=r),type:"date",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(g).date]])]),e("div",$e,[t[32]||(t[32]=e("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},"Client",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=r=>o(g).client_id=r),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},[t[31]||(t[31]=e("option",{value:""},"Sélectionner",-1)),(i(!0),l(f,null,S(a.clients,r=>(i(),l("option",{key:r.id,value:r.id},d(r.name),9,qe))),128))],512),[[h,o(g).client_id]])]),e("div",Le,[t[33]||(t[33]=e("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},"Projet",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>o(g).project_name=r),type:"text",placeholder:"Nom du projet",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(g).project_name]])]),e("div",Oe,[t[34]||(t[34]=e("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},"Durée (HH:MM)",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>o(g).duration=r),type:"text",required:"",placeholder:"1:30",pattern:"\\d+:\\d{2}",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(g).duration]])]),e("div",Pe,[t[35]||(t[35]=e("label",{class:"block text-xs font-medium text-gray-700 dark:text-gray-300"},"Description",-1)),m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=r=>o(g).description=r),type:"text",placeholder:"Description",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(g).description]])]),e("div",Ke,[e("button",{type:"submit",disabled:o(g).processing,class:"w-full inline-flex justify-center items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"}," Ajouter ",8,Ge)])])],32)]),e("div",Je,[e("div",Qe,[m(e("select",{"onUpdate:modelValue":t[8]||(t[8]=r=>M.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[t[37]||(t[37]=e("option",{value:""},"Tous les clients",-1)),(i(!0),l(f,null,S(a.clients,r=>(i(),l("option",{key:r.id,value:r.id},d(r.name),9,We))),128))],512),[[h,M.value]]),m(e("select",{"onUpdate:modelValue":t[9]||(t[9]=r=>z.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[...t[38]||(t[38]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"0"},"Non facturé",-1),e("option",{value:"1"},"Facturé",-1)])],512),[[h,z.value]]),m(e("select",{"onUpdate:modelValue":t[10]||(t[10]=r=>D.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[t[39]||(t[39]=e("option",{value:""},"Toutes les périodes",-1)),(i(!0),l(f,null,S(a.periods,r=>(i(),l("option",{key:r.value,value:r.value},d(r.label),9,Xe))),128))],512),[[h,D.value]])]),u.value.length>0?(i(),l("button",{key:0,onClick:ae,class:"inline-flex items-center rounded-md bg-green-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"},[t[40]||(t[40]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.5 2A1.5 1.5 0 003 3.5v13A1.5 1.5 0 004.5 18h11a1.5 1.5 0 001.5-1.5V7.621a1.5 1.5 0 00-.44-1.06l-4.12-4.122A1.5 1.5 0 0011.378 2H4.5zm4.75 6.75a.75.75 0 011.5 0v2.546l.943-1.048a.75.75 0 011.114 1.004l-2.25 2.5a.75.75 0 01-1.114 0l-2.25-2.5a.75.75 0 111.114-1.004l.943 1.048V8.75z","clip-rule":"evenodd"})],-1)),V(" Convertir en facture ("+d(u.value.length)+") ",1)])):x("",!0)]),e("div",Ye,[e("table",Ze,[e("thead",et,[e("tr",null,[e("th",tt,[e("input",{type:"checkbox",checked:u.value.length>0&&u.value.length===a.entries.data.filter(r=>!r.is_billed).length,onChange:de,class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,40,rt)]),t[41]||(t[41]=e("th",{class:"py-3.5 px-3 text-left text-sm font-semibold text-gray-900 dark:text-white"}," Date ",-1)),t[42]||(t[42]=e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"}," Client / Projet ",-1)),t[43]||(t[43]=e("th",{class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white md:table-cell"}," Description ",-1)),t[44]||(t[44]=e("th",{class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"}," Durée ",-1)),t[45]||(t[45]=e("th",{class:"hidden px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white lg:table-cell"}," Montant ",-1)),t[46]||(t[46]=e("th",{class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 dark:text-white"}," Statut ",-1)),t[47]||(t[47]=e("th",{class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},[e("span",{class:"sr-only"},"Actions")],-1))])]),e("tbody",st,[a.entries.data.length===0?(i(),l("tr",ot,[...t[48]||(t[48]=[e("td",{colspan:"8",class:"py-10 text-center text-sm text-gray-500 dark:text-gray-400"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"mt-2"},"Aucune entrée de temps trouvée."),e("p",{class:"mt-1 text-xs"},"Démarrez un timer ou ajoutez une entrée manuelle.")],-1)])])):x("",!0),(i(!0),l(f,null,S(a.entries.data,r=>{var C;return i(),l("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",it,[r.is_billed?x("",!0):(i(),l("input",{key:0,type:"checkbox",checked:u.value.includes(r.id),onChange:R=>le(r.id),class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,40,lt))]),e("td",dt,[e("div",null,d(ge(r.started_at)),1),e("div",at,d(Q(r.started_at))+" - "+d(Q(r.stopped_at)),1)]),e("td",nt,[e("div",ut,d(((C=r.client)==null?void 0:C.name)||"Client inconnu"),1),e("div",mt,d(r.project_name||"Sans projet"),1)]),e("td",gt,[e("span",ct,d(r.description||"-"),1)]),e("td",xt,d(r.duration_formatted),1),e("td",pt,d(r.amount?J(r.amount):"-"),1),e("td",yt,[e("span",{class:X(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",r.is_billed?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200"])},d(r.is_billed?"Facturé":"Non facturé"),3)]),e("td",bt,[r.is_billed?x("",!0):(i(),l("div",vt,[a.draftInvoices.some(R=>R.client_id===r.client_id)?(i(),l("button",{key:0,onClick:R=>ue(r),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:"Ajouter à une facture"},[...t[49]||(t[49]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)])],8,ft)):x("",!0),e("button",{onClick:R=>ie(r),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"Supprimer"},[...t[50]||(t[50]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z","clip-rule":"evenodd"})],-1)])],8,ht)]))])])}),128))])])]),a.entries.links&&a.entries.links.length>3?(i(),l("div",kt,[e("div",wt," Affichage de "+d(a.entries.from)+" à "+d(a.entries.to)+" sur "+d(a.entries.total)+" entrées ",1),e("nav",_t,[(i(!0),l(f,null,S(a.entries.links,(r,C)=>(i(),l(f,{key:C},[r.url?(i(),ye(o(P),{key:0,href:r.url,class:X([r.active?"z-10 bg-indigo-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:text-gray-300 dark:ring-gray-600 dark:hover:bg-gray-700","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20",C===0?"rounded-l-md":"",C===a.entries.links.length-1?"rounded-r-md":""]),innerHTML:r.label,"preserve-scroll":""},null,8,["href","class","innerHTML"])):x("",!0)],64))),128))])])):x("",!0),F.value?(i(),l("div",St,[t[57]||(t[57]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",At,[e("div",jt,[e("div",Tt,[e("div",null,[t[51]||(t[51]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Convertir en facture ",-1)),e("p",Ct,d(u.value.length)+" entrées sélectionnées ",1)]),e("form",{onSubmit:$(ne,["prevent"]),class:"mt-6 space-y-4"},[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Taux horaire ",-1)),e("div",Vt,[m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=r=>o(b).hourly_rate=r),type:"number",step:"0.01",min:"0",required:"",class:"block w-full rounded-md border-gray-300 pr-12 focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(b).hourly_rate]]),t[52]||(t[52]=e("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[e("span",{class:"text-gray-500 dark:text-gray-400 sm:text-sm"},"EUR/h")],-1))])]),e("div",null,[t[55]||(t[55]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Taux de TVA ",-1)),a.isVatExempt?(i(),l("div",Mt," 0% (Exonéré) ")):m((i(),l("select",{key:0,"onUpdate:modelValue":t[12]||(t[12]=r=>o(b).vat_rate=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},[...t[54]||(t[54]=[e("option",{value:0},"0% (Exonéré)",-1),e("option",{value:3},"3% (Super-réduit)",-1),e("option",{value:8},"8% (Réduit)",-1),e("option",{value:14},"14% (Intermédiaire)",-1),e("option",{value:17},"17% (Standard)",-1)])],512)),[[h,o(b).vat_rate]])]),e("div",zt,[m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=r=>o(b).group_by_project=r),type:"checkbox",id:"group_by_project",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[be,o(b).group_by_project]]),t[56]||(t[56]=e("label",{for:"group_by_project",class:"ml-2 block text-sm text-gray-700 dark:text-gray-300"}," Regrouper par projet ",-1))]),e("div",Dt,[e("button",{type:"button",onClick:t[14]||(t[14]=r=>F.value=!1),class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}," Annuler "),e("button",{type:"submit",disabled:o(b).processing,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"}," Créer la facture ",8,Ft)])],32)])])])])):x("",!0),E.value?(i(),l("div",Et,[t[67]||(t[67]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",It,[e("div",Ut,[e("div",Rt,[e("div",null,[t[58]||(t[58]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Ajouter à une facture ",-1)),y.value?(i(),l("p",Bt,d((T=y.value.client)==null?void 0:T.name)+" - "+d(y.value.duration_formatted),1)):x("",!0)]),e("form",{onSubmit:$(me,["prevent"]),class:"mt-6 space-y-4"},[U.value.length===0?(i(),l("div",Nt,[t[60]||(t[60]=e("p",{class:"text-sm text-amber-800 dark:text-amber-200"}," Aucune facture brouillon disponible pour ce client. ",-1)),N(o(P),{href:s.route("invoices.create"),class:"mt-2 inline-flex text-sm font-medium text-amber-800 hover:text-amber-700 dark:text-amber-200"},{default:H(()=>[...t[59]||(t[59]=[V(" Créer une nouvelle facture → ",-1)])]),_:1},8,["href"])])):(i(),l("div",Ht,[t[62]||(t[62]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Facture ",-1)),m(e("select",{"onUpdate:modelValue":t[15]||(t[15]=r=>o(c).invoice_id=r),required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},[t[61]||(t[61]=e("option",{value:""},"Sélectionner une facture",-1)),(i(!0),l(f,null,S(U.value,r=>(i(),l("option",{key:r.id,value:r.id},d(r.title||r.display_number)+" - "+d(r.created_at)+" ("+d(J(r.total_ht))+" HT) ",9,$t))),128))],512),[[h,o(c).invoice_id]])])),U.value.length>0?(i(),l("div",qt,[e("div",null,[t[64]||(t[64]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Taux horaire ",-1)),e("div",Lt,[m(e("input",{"onUpdate:modelValue":t[16]||(t[16]=r=>o(c).hourly_rate=r),type:"number",step:"0.01",min:"0",required:"",class:"block w-full rounded-md border-gray-300 pr-12 focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[k,o(c).hourly_rate]]),t[63]||(t[63]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("span",{class:"text-gray-500 dark:text-gray-400 sm:text-sm"},"€/h")],-1))])]),e("div",null,[t[66]||(t[66]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Taux de TVA ",-1)),a.isVatExempt?(i(),l("div",Ot," 0% (Exonéré) ")):m((i(),l("select",{key:0,"onUpdate:modelValue":t[17]||(t[17]=r=>o(c).vat_rate=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:text-sm"},[...t[65]||(t[65]=[e("option",{value:0},"0% (Exonéré)",-1),e("option",{value:3},"3% (Super-réduit)",-1),e("option",{value:8},"8% (Réduit)",-1),e("option",{value:14},"14% (Intermédiaire)",-1),e("option",{value:17},"17% (Standard)",-1)])],512)),[[h,o(c).vat_rate]])])])):x("",!0),e("div",Pt,[e("button",{type:"button",onClick:t[18]||(t[18]=r=>{E.value=!1,y.value=null}),class:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}," Annuler "),U.value.length>0?(i(),l("button",{key:0,type:"submit",disabled:o(c).processing||!o(c).invoice_id,class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"}," Ajouter ",8,Kt)):x("",!0)])],32)])])])])):x("",!0)]}),_:1})],64))}};export{Zt as default};
