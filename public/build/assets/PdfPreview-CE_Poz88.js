import{r as d,c as m,a as u,b as p,h as M,i as v,d as e,o as c,w as V,f as b,v as h,g as w,e as n,t as x,l as z,F as A,p as L}from"./app-Cqq6IbMT.js";import{_ as B}from"./AppLayout-CnSWd9CQ.js";import"./DropdownLink-b1Fc-hHx.js";import"./useTranslations-D7SxVrzl.js";const F={class:"flex items-center justify-between"},j={class:"flex items-center space-x-4"},H={class:"text-xl font-semibold text-slate-900 dark:text-white"},E={class:"flex items-center space-x-3"},T={class:"bg-slate-100 dark:bg-slate-900 rounded-2xl p-4"},_=["innerHTML"],N={key:0,class:"relative z-50"},P={class:"fixed inset-0 z-50 overflow-y-auto"},$={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},D={class:"relative transform overflow-hidden rounded-2xl bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all dark:bg-slate-800 sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},S={class:"mt-6 flex justify-end space-x-3"},O=["disabled"],U={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},K={__name:"PdfPreview",props:{invoice:Object,htmlContent:String},setup(s){var f;const o=s,i=d(!1),l=d({email:((f=o.invoice.buyer_snapshot)==null?void 0:f.email)||"",message:""}),a=d(!1),g=()=>{window.location.href=route("invoices.pdf",o.invoice.id)},k=()=>{window.open(route("invoices.pdf.stream",o.invoice.id),"_blank")},y=()=>{a.value=!0,L.post(route("invoices.send",o.invoice.id),l.value,{onFinish:()=>{a.value=!1,i.value=!1}})};return(C,t)=>(c(),m(A,null,[u(p(M),{title:`Aperçu - ${s.invoice.is_credit_note?"Avoir":"Facture"} ${s.invoice.number}`},null,8,["title"]),u(B,null,{header:v(()=>[e("div",F,[e("div",j,[u(p(z),{href:C.route("invoices.show",s.invoice.id),class:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200"},{default:v(()=>[...t[4]||(t[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",H," Aperçu PDF - "+x(s.invoice.is_credit_note?"Avoir":"Facture")+" "+x(s.invoice.number),1)]),e("div",E,[e("button",{onClick:k,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[...t[5]||(t[5]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06l7.22 7.22H6.75a.75.75 0 000 1.5h7.5a.747.747 0 00.75-.75v-7.5a.75.75 0 00-1.5 0v5.69L6.28 5.22z"})],-1),n(" Ouvrir ",-1)])]),e("button",{onClick:g,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[...t[6]||(t[6]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),n(" Télécharger ",-1)])]),e("button",{onClick:t[0]||(t[0]=r=>i.value=!0),class:"inline-flex items-center rounded-xl bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500"},[...t[7]||(t[7]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"}),e("path",{d:"M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"})],-1),n(" Envoyer par email ",-1)])])])])]),default:v(()=>[e("div",T,[e("div",{class:"bg-white shadow-lg mx-auto max-w-4xl",style:{"min-height":"800px"},innerHTML:s.htmlContent},null,8,_)]),i.value?(c(),m("div",N,[t[12]||(t[12]=e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",P,[e("div",$,[e("div",D,[t[11]||(t[11]=e("div",null,[e("div",{class:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-primary-100 dark:bg-primary-900"},[e("svg",{class:"h-6 w-6 text-primary-600 dark:text-primary-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"}),e("path",{d:"M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"})])]),e("div",{class:"mt-3 text-center sm:mt-5"},[e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"}," Envoyer la facture par email "),e("p",{class:"mt-2 text-sm text-slate-500 dark:text-slate-400"}," La facture sera envoyée en pièce jointe au format PDF. ")])],-1)),e("form",{onSubmit:V(y,["prevent"]),class:"mt-6 space-y-4"},[e("div",null,[t[8]||(t[8]=e("label",{for:"email",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Adresse email du destinataire ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>l.value.email=r),type:"email",id:"email",required:"",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white sm:text-sm",placeholder:"email@exemple.com"},null,512),[[h,l.value.email]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"message",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Message personnalisé (optionnel) ",-1)),b(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=r=>l.value.message=r),id:"message",rows:"3",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white sm:text-sm",placeholder:"Ajoutez un message personnalisé..."},null,512),[[h,l.value.message]])]),e("div",S,[e("button",{type:"button",onClick:t[3]||(t[3]=r=>i.value=!1),class:"rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"}," Annuler "),e("button",{type:"submit",disabled:a.value,class:"inline-flex items-center rounded-xl bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[a.value?(c(),m("svg",U,[...t[10]||(t[10]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):w("",!0),n(" "+x(a.value?"Envoi...":"Envoyer"),1)],8,O)])],32)])])])])):w("",!0)]),_:1})],64))}};export{K as default};
