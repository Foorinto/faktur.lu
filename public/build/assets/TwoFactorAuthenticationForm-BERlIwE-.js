import{o as s,c,d as o,n as $,m as k,i as l,a as i,e as d,x as S,t as a,L as M,M as H,N as I,r as w,u as R,B as U,b as r,g as f,F as W,j as Q,A as G,p as K,E as J}from"./app-BKH9vAec.js";import{_ as O}from"./Modal-lKQ9XTEs.js";import{_ as N}from"./InputError-Di87Doje.js";import{_ as B}from"./PrimaryButton-C0flks-A.js";import{_ as T}from"./SecondaryButton-9kduSLVG.js";import{_ as E}from"./TextInput-D0CChAb6.js";import{_ as X}from"./DangerButton-DiQmIhVt.js";import{_ as Y}from"./InputLabel-CmPAT9T5.js";import{u as Z}from"./useTranslations-CNYJWptv.js";const ee={class:"md:grid md:grid-cols-3 md:gap-6"},te={class:"md:col-span-1 flex justify-between"},se={class:"px-4 sm:px-0"},oe={class:"text-lg font-medium text-slate-900 dark:text-slate-100"},ae={class:"mt-1 text-sm text-slate-600 dark:text-slate-400"},le={class:"mt-5 md:mt-0 md:col-span-2"},re={class:"px-4 py-5 sm:p-6 bg-white dark:bg-slate-800 shadow-xl shadow-slate-200/50 border border-slate-200 dark:border-slate-700 dark:shadow-slate-900/50 sm:rounded-2xl"},ne={__name:"ActionSection",props:{title:String,description:String},setup(_){return(e,g)=>(s(),c("div",ee,[o("div",te,[o("div",se,[o("h3",oe,[$(e.$slots,"title")]),o("p",ae,[$(e.$slots,"description")])])]),o("div",le,[o("div",re,[$(e.$slots,"content")])])]))}},ce={class:"px-6 py-4"},ie={class:"text-lg font-medium text-slate-900 dark:text-slate-100"},de={class:"mt-4 text-sm text-slate-600 dark:text-slate-400"},ue={class:"flex flex-row justify-end px-6 py-4 bg-slate-100 dark:bg-slate-800 text-end"},me={__name:"DialogModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(_,{emit:e}){const g=e,y=()=>{g("close")};return(t,n)=>(s(),k(O,{show:_.show,"max-width":_.maxWidth,closeable:_.closeable,onClose:y},{default:l(()=>[o("div",ce,[o("div",ie,[$(t.$slots,"title")]),o("div",de,[$(t.$slots,"content")])]),o("div",ue,[$(t.$slots,"footer")])]),_:3},8,["show","max-width","closeable"]))}},_e={class:"mt-4"},C={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirmer le mot de passe"},content:{type:String,default:"Pour votre sécurité, veuillez confirmer votre mot de passe pour continuer."},button:{type:String,default:"Confirmer"}},emits:["confirmed"],setup(_,{emit:e}){const g=e,y=w(!1),t=I({password:"",error:"",processing:!1}),n=w(null),v=()=>{axios.get(route("password.confirmation")).then(u=>{u.data.confirmed?g("confirmed"):(y.value=!0,setTimeout(()=>n.value.focus(),250))})},b=()=>{t.processing=!0,axios.post(route("password.confirm"),{password:t.password}).then(()=>{t.processing=!1,h(),H().then(()=>g("confirmed"))}).catch(u=>{t.processing=!1,t.error=u.response.data.errors.password[0],n.value.focus()})},h=()=>{y.value=!1,t.password="",t.error=""};return(u,m)=>(s(),c("span",null,[o("span",{onClick:v},[$(u.$slots,"default")]),i(me,{show:y.value,onClose:h},{title:l(()=>[d(a(_.title),1)]),content:l(()=>[d(a(_.content)+" ",1),o("div",_e,[i(E,{ref_key:"passwordInput",ref:n,modelValue:t.password,"onUpdate:modelValue":m[0]||(m[0]=x=>t.password=x),type:"password",class:"mt-1 block w-3/4",placeholder:"Mot de passe",autocomplete:"current-password",onKeyup:M(b,["enter"])},null,8,["modelValue"]),i(N,{message:t.error,class:"mt-2"},null,8,["message"])])]),footer:l(()=>[i(T,{onClick:h},{default:l(()=>[...m[1]||(m[1]=[d(" Annuler ",-1)])]),_:1}),i(B,{class:S(["ms-3",{"opacity-25":t.processing}]),disabled:t.processing,onClick:b},{default:l(()=>[d(a(_.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},fe={key:0,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},pe={key:1,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},ve={key:2,class:"text-lg font-medium text-slate-900 dark:text-slate-100"},he={class:"mt-3 max-w-xl text-sm text-slate-600 dark:text-slate-400"},xe={key:3},we={key:0},ge={class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},ye={key:0,class:"font-semibold"},be={key:1},ke=["innerHTML"],$e={key:0,class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},Ce={class:"font-semibold"},Se={class:"font-mono text-base select-all"},Fe={key:1,class:"mt-4"},Te={key:1},Ve={class:"mt-4 max-w-xl text-sm text-slate-600 dark:text-slate-400"},Be={class:"font-semibold"},Ae={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-slate-100 dark:bg-slate-900 rounded-xl"},Pe={class:"mt-5"},qe={key:0},Ke={key:1},Re={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(_){const{t:e}=Z(),g=_,y=J(),t=w(!1),n=w(!1),v=w(!1),b=w(null),h=w(null),u=w([]),m=R({code:""}),x=G(()=>{var p;return!t.value&&((p=y.props.auth.user)==null?void 0:p.two_factor_enabled)});U(x,()=>{x.value||(m.reset(),m.clearErrors())});const L=()=>{t.value=!0,K.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([j(),z(),V()]),onFinish:()=>{t.value=!1,n.value=g.requiresConfirmation}})},j=()=>axios.get(route("two-factor.qr-code")).then(p=>{b.value=p.data.svg}),z=()=>axios.get(route("two-factor.secret-key")).then(p=>{h.value=p.data.secretKey}),V=()=>axios.get(route("two-factor.recovery-codes")).then(p=>{u.value=p.data}),A=()=>{m.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{n.value=!1,b.value=null,h.value=null}})},D=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>V())},P=()=>{v.value=!0,K.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{v.value=!1,n.value=!1}})};return(p,q)=>(s(),k(ne,null,{title:l(()=>[d(a(r(e)("two_factor_authentication")),1)]),description:l(()=>[d(a(r(e)("two_factor_description")),1)]),content:l(()=>[x.value&&!n.value?(s(),c("h3",fe,a(r(e)("two_factor_enabled")),1)):x.value&&n.value?(s(),c("h3",pe,a(r(e)("two_factor_finish_enabling")),1)):(s(),c("h3",ve,a(r(e)("two_factor_not_enabled")),1)),o("div",he,[o("p",null,a(r(e)("two_factor_explanation")),1)]),x.value?(s(),c("div",xe,[b.value?(s(),c("div",we,[o("div",ge,[n.value?(s(),c("p",ye,a(r(e)("two_factor_scan_qr_confirming")),1)):(s(),c("p",be,a(r(e)("two_factor_scan_qr_enabled")),1))]),o("div",{class:"mt-4 p-4 bg-white inline-block rounded-xl",innerHTML:b.value},null,8,ke),h.value?(s(),c("div",$e,[o("p",Ce,[d(a(r(e)("setup_key"))+" ",1),o("span",Se,a(h.value),1)])])):f("",!0),n.value?(s(),c("div",Fe,[i(Y,{for:"code",value:r(e)("code")},null,8,["value"]),i(E,{id:"code",modelValue:r(m).code,"onUpdate:modelValue":q[0]||(q[0]=F=>r(m).code=F),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:M(A,["enter"])},null,8,["modelValue"]),i(N,{message:r(m).errors.code,class:"mt-2"},null,8,["message"])])):f("",!0)])):f("",!0),u.value.length>0&&!n.value?(s(),c("div",Te,[o("div",Ve,[o("p",Be,a(r(e)("recovery_codes_info")),1)]),o("div",Ae,[(s(!0),c(W,null,Q(u.value,F=>(s(),c("div",{key:F},a(F),1))),128))])])):f("",!0)])):f("",!0),o("div",Pe,[x.value?(s(),c("div",Ke,[i(C,{onConfirmed:A},{default:l(()=>[n.value?(s(),k(B,{key:0,type:"button",class:S(["me-3",{"opacity-25":t.value}]),disabled:t.value},{default:l(()=>[d(a(r(e)("confirm")),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),i(C,{onConfirmed:D},{default:l(()=>[u.value.length>0&&!n.value?(s(),k(T,{key:0,class:"me-3"},{default:l(()=>[d(a(r(e)("regenerate_recovery_codes")),1)]),_:1})):f("",!0)]),_:1}),i(C,{onConfirmed:V},{default:l(()=>[u.value.length===0&&!n.value?(s(),k(T,{key:0,class:"me-3"},{default:l(()=>[d(a(r(e)("show_recovery_codes")),1)]),_:1})):f("",!0)]),_:1}),i(C,{onConfirmed:P},{default:l(()=>[n.value?(s(),k(T,{key:0,class:S({"opacity-25":v.value}),disabled:v.value},{default:l(()=>[d(a(r(e)("cancel")),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),i(C,{onConfirmed:P},{default:l(()=>[n.value?f("",!0):(s(),k(X,{key:0,class:S({"opacity-25":v.value}),disabled:v.value},{default:l(()=>[d(a(r(e)("disable")),1)]),_:1},8,["class","disabled"]))]),_:1})])):(s(),c("div",qe,[i(C,{onConfirmed:L},{default:l(()=>[i(B,{type:"button",class:S({"opacity-25":t.value}),disabled:t.value},{default:l(()=>[d(a(r(e)("enable")),1)]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Re as default};
