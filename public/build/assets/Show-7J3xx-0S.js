import{u as F,r as j,c as r,a as g,b as a,h as R,i as w,d as e,t as i,o,F as c,j as v,x as k,e as B,g as b,w as L,f,v as O,s as E,k as U,l as P,B as I,p as _}from"./app-Ci_uaEa0.js";import{_ as Z}from"./AdminLayout-Dq642xqg.js";const $={class:"flex items-center gap-4"},G={class:"text-xl font-semibold text-white"},H={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},J={class:"lg:col-span-2 space-y-6"},K={class:"rounded-xl bg-slate-800 p-6 border border-slate-700"},Q={class:"text-lg font-medium text-white mb-2"},W={class:"flex flex-wrap gap-4 text-sm text-slate-400"},X={class:"space-y-4"},Y={class:"flex items-center gap-2 mb-2"},ee={key:0,class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},te={key:1,class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},se={class:"flex-1"},le={class:"text-xs text-slate-400 ml-2"},ie={class:"pl-10 text-sm text-slate-300 whitespace-pre-wrap"},re={key:0,class:"mt-3 pl-10"},oe=["href"],de={class:"text-slate-500"},ne={class:"rounded-xl bg-slate-800 p-6 border border-slate-700"},ae={class:"mt-4 flex items-center justify-between"},ue={class:"flex items-center gap-2 text-sm text-slate-300"},ce={class:"flex gap-2"},pe=["disabled"],me=["disabled"],xe={class:"space-y-6"},ve={class:"rounded-xl bg-slate-800 p-6 border border-slate-700"},be={class:"space-y-3"},fe={class:"text-white"},he={class:"text-white"},ye={class:"rounded-xl bg-slate-800 p-6 border border-slate-700"},ge={class:"space-y-4"},we=["value"],ke=["value"],_e={class:"text-white"},Ae={class:"text-white"},Me={key:0},Ce={class:"text-white"},Se={key:1},ze={class:"text-white"},Be={__name:"Show",props:{ticket:{type:Object,required:!0},categories:{type:Object,required:!0},statuses:{type:Object,required:!0},priorities:{type:Object,required:!0}},setup(l){const u=l,d=F({message:"",is_internal:!1,status:null}),p=j(u.ticket.status),h=j(u.ticket.priority),N=()=>{d.post(route("admin.support.reply",u.ticket.id),{preserveScroll:!0,onSuccess:()=>{d.reset()}})},A=()=>{_.put(route("admin.support.update",u.ticket.id),{status:p.value,priority:h.value},{preserveScroll:!0})},q=()=>{p.value="resolved",_.put(route("admin.support.update",u.ticket.id),{status:"resolved"},{preserveScroll:!0})},D=I(()=>!["resolved","closed"].includes(p.value)),T=()=>{confirm("Êtes-vous sûr de vouloir supprimer ce ticket ? Cette action est irréversible.")&&_.delete(route("admin.support.destroy",u.ticket.id))},m=y=>{const t=new Date(y);return new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)};return(y,t)=>(o(),r(c,null,[g(a(R),{title:l.ticket.reference+" - Support Admin"},null,8,["title"]),g(Z,null,{header:w(()=>[e("div",$,[g(a(P),{href:y.route("admin.support.index"),class:"rounded-lg p-2 text-slate-400 hover:bg-slate-700 hover:text-white"},{default:w(()=>[...t[4]||(t[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",G,i(l.ticket.reference),1)])]),default:w(()=>{var M,C;return[e("div",H,[e("div",J,[e("div",K,[e("h2",Q,i(l.ticket.subject),1),e("div",W,[e("span",null,i(l.categories[l.ticket.category]),1),e("span",null,"Créé le "+i(m(l.ticket.created_at)),1)])]),e("div",X,[(o(!0),r(c,null,v(l.ticket.messages,s=>{var n,S,z,V;return o(),r("div",{key:s.id,class:k(["rounded-xl p-4 border",s.is_internal?"bg-yellow-900/20 border-yellow-700":s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"bg-purple-900/20 border-purple-700":"bg-slate-800 border-slate-700"])},[e("div",Y,[e("div",{class:k(["h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium",s.is_internal?"bg-yellow-600 text-white":s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"bg-purple-600 text-white":"bg-slate-600 text-slate-300"])},[s.is_internal?(o(),r("svg",ee,[...t[5]||(t[5]=[e("path",{"fill-rule":"evenodd",d:"M3.28 2.22a.75.75 0 00-1.06 1.06l14.5 14.5a.75.75 0 101.06-1.06l-1.745-1.745a10.029 10.029 0 003.3-4.38 1.651 1.651 0 000-1.185A10.004 10.004 0 009.999 3a9.956 9.956 0 00-4.744 1.194L3.28 2.22zM7.752 6.69l1.092 1.092a2.5 2.5 0 013.374 3.373l1.091 1.092a4 4 0 00-5.557-5.557z","clip-rule":"evenodd"},null,-1),e("path",{d:"M10.748 13.93l2.523 2.523a9.987 9.987 0 01-3.27.547c-4.258 0-7.894-2.66-9.337-6.41a1.651 1.651 0 010-1.186A10.007 10.007 0 012.839 6.02L6.07 9.252a4 4 0 004.678 4.678z"},null,-1)])])):s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?(o(),r("svg",te,[...t[6]||(t[6]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.99 5.99 0 00-4.793 2.39A6.483 6.483 0 0010 16.5a6.483 6.483 0 004.793-2.11A5.99 5.99 0 0010 12z","clip-rule":"evenodd"},null,-1)])])):(o(),r(c,{key:2},[B(i(((z=(S=(n=s.sender)==null?void 0:n.name)==null?void 0:S.charAt(0))==null?void 0:z.toUpperCase())||"U"),1)],64))],2),e("div",se,[e("span",{class:k(["text-sm font-medium",s.is_internal?"text-yellow-400":s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"text-purple-400":"text-white"])},i(s.is_internal?"Note interne":s.sender_type==="admin"||s.sender_type==="App\\Models\\AdminSession"?"Admin":((V=s.sender)==null?void 0:V.name)||"Utilisateur"),3),e("span",le,i(m(s.created_at)),1)])]),e("div",ie,i(s.content),1),s.attachments&&s.attachments.length>0?(o(),r("div",re,[(o(!0),r(c,null,v(s.attachments,x=>(o(),r("div",{key:x.id,class:"inline-flex items-center gap-2 rounded-lg bg-slate-700 px-3 py-1.5 text-sm"},[t[7]||(t[7]=e("svg",{class:"h-4 w-4 text-slate-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M15.621 4.379a3 3 0 00-4.242 0l-7 7a3 3 0 004.241 4.243h.001l.497-.5a.75.75 0 011.064 1.057l-.498.501-.002.002a4.5 4.5 0 01-6.364-6.364l7-7a4.5 4.5 0 016.368 6.36l-3.455 3.553A2.625 2.625 0 119.52 9.52l3.45-3.451a.75.75 0 111.061 1.06l-3.45 3.451a1.125 1.125 0 001.587 1.595l3.454-3.553a3 3 0 000-4.242z","clip-rule":"evenodd"})],-1)),e("a",{href:x.url,target:"_blank",class:"text-purple-400 hover:text-purple-300"},i(x.filename),9,oe),e("span",de,i(x.size_formatted),1)]))),128))])):b("",!0)],2)}),128))]),e("div",ne,[t[9]||(t[9]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Répondre",-1)),e("form",{onSubmit:L(N,["prevent"])},[f(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=s=>a(d).message=s),rows:"4",class:"block w-full rounded-lg border-0 bg-slate-700 py-2 px-3 text-white placeholder:text-slate-400 focus:ring-2 focus:ring-purple-500 sm:text-sm",placeholder:"Votre réponse...",required:""},null,512),[[O,a(d).message]]),e("div",ae,[e("label",ue,[f(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=s=>a(d).is_internal=s),class:"rounded border-slate-600 bg-slate-700 text-yellow-600 focus:ring-yellow-500"},null,512),[[E,a(d).is_internal]]),t[8]||(t[8]=e("span",null,"Note interne (invisible pour l'utilisateur)",-1))]),e("div",ce,[D.value?(o(),r("button",{key:0,type:"button",onClick:q,disabled:a(d).processing,class:"inline-flex items-center rounded-lg bg-emerald-600 px-4 py-2 text-sm font-medium text-white hover:bg-emerald-500 disabled:opacity-50"}," Marquer résolu ",8,pe)):b("",!0),e("button",{type:"submit",disabled:a(d).processing,class:"inline-flex items-center rounded-lg bg-purple-600 px-4 py-2 text-sm font-medium text-white hover:bg-purple-500 disabled:opacity-50"}," Envoyer ",8,me)])])],32)])]),e("div",xe,[e("div",ve,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Utilisateur",-1)),e("div",be,[e("div",null,[t[10]||(t[10]=e("div",{class:"text-sm text-slate-400"},"Nom",-1)),e("div",fe,i(((M=l.ticket.user)==null?void 0:M.name)||"-"),1)]),e("div",null,[t[11]||(t[11]=e("div",{class:"text-sm text-slate-400"},"Email",-1)),e("div",he,i(((C=l.ticket.user)==null?void 0:C.email)||"-"),1)])])]),e("div",ye,[t[19]||(t[19]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Détails",-1)),e("div",ge,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm text-slate-400 mb-1"},"Statut",-1)),f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),onChange:A,class:"block w-full rounded-lg border-0 bg-slate-700 py-2 pl-3 pr-10 text-white focus:ring-2 focus:ring-purple-500 sm:text-sm"},[(o(!0),r(c,null,v(l.statuses,(s,n)=>(o(),r("option",{key:n,value:n},i(s),9,we))),128))],544),[[U,p.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm text-slate-400 mb-1"},"Priorité",-1)),f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),onChange:A,class:"block w-full rounded-lg border-0 bg-slate-700 py-2 pl-3 pr-10 text-white focus:ring-2 focus:ring-purple-500 sm:text-sm"},[(o(!0),r(c,null,v(l.priorities,(s,n)=>(o(),r("option",{key:n,value:n},i(s),9,ke))),128))],544),[[U,h.value]])]),e("div",null,[t[15]||(t[15]=e("div",{class:"text-sm text-slate-400"},"Catégorie",-1)),e("div",_e,i(l.categories[l.ticket.category]),1)]),e("div",null,[t[16]||(t[16]=e("div",{class:"text-sm text-slate-400"},"Créé le",-1)),e("div",Ae,i(m(l.ticket.created_at)),1)]),l.ticket.first_response_at?(o(),r("div",Me,[t[17]||(t[17]=e("div",{class:"text-sm text-slate-400"},"1ère réponse",-1)),e("div",Ce,i(m(l.ticket.first_response_at)),1)])):b("",!0),l.ticket.resolved_at?(o(),r("div",Se,[t[18]||(t[18]=e("div",{class:"text-sm text-slate-400"},"Résolu le",-1)),e("div",ze,i(m(l.ticket.resolved_at)),1)])):b("",!0)])]),e("div",{class:"rounded-xl bg-slate-800 p-6 border border-slate-700"},[t[21]||(t[21]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Zone de danger",-1)),e("button",{type:"button",onClick:T,class:"w-full inline-flex items-center justify-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-500"},[...t[20]||(t[20]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5zM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4zM8.58 7.72a.75.75 0 00-1.5.06l.3 7.5a.75.75 0 101.5-.06l-.3-7.5zm4.34.06a.75.75 0 10-1.5-.06l-.3 7.5a.75.75 0 101.5.06l.3-7.5z","clip-rule":"evenodd"})],-1),B(" Supprimer ce ticket ",-1)])])])])])]}),_:1})],64))}};export{Be as default};
