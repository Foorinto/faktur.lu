import{o as s,c,d as o,n as $,m as k,i as r,a as i,e as d,x as S,t as a,L as M,M as H,N as I,r as h,u as R,z as U,b as n,g as f,F as W,j as Q,B as G,p as K,D as J}from"./app-BIJCKN2g.js";import{_ as O}from"./Modal-BwK5CuBI.js";import{a as D,_ as X}from"./InputError-D3UJYEOZ.js";import{P as V}from"./PrimaryButton-D-K_GS1T.js";import{_ as B,D as Y}from"./SecondaryButton-HKYPFUew.js";import{_ as N}from"./TextInput-CSMO_j_y.js";import{u as Z}from"./useTranslations-ti9iItLu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"md:grid md:grid-cols-3 md:gap-6"},te={class:"md:col-span-1 flex justify-between"},se={class:"px-4 sm:px-0"},oe={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ae={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},re={class:"mt-5 md:mt-0 md:col-span-2"},ne={class:"px-4 py-5 sm:p-6 bg-white dark:bg-gray-800 shadow sm:rounded-lg"},le={__name:"ActionSection",props:{title:String,description:String},setup(_){return(e,x)=>(s(),c("div",ee,[o("div",te,[o("div",se,[o("h3",oe,[$(e.$slots,"title")]),o("p",ae,[$(e.$slots,"description")])])]),o("div",re,[o("div",ne,[$(e.$slots,"content")])])]))}},ce={class:"px-6 py-4"},ie={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},de={class:"mt-4 text-sm text-gray-600 dark:text-gray-400"},ue={class:"flex flex-row justify-end px-6 py-4 bg-gray-100 dark:bg-gray-800 text-end"},me={__name:"DialogModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(_,{emit:e}){const x=e,w=()=>{x("close")};return(t,l)=>(s(),k(O,{show:_.show,"max-width":_.maxWidth,closeable:_.closeable,onClose:w},{default:r(()=>[o("div",ce,[o("div",ie,[$(t.$slots,"title")]),o("div",de,[$(t.$slots,"content")])]),o("div",ue,[$(t.$slots,"footer")])]),_:3},8,["show","max-width","closeable"]))}},_e={class:"mt-4"},C={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirmer le mot de passe"},content:{type:String,default:"Pour votre sécurité, veuillez confirmer votre mot de passe pour continuer."},button:{type:String,default:"Confirmer"}},emits:["confirmed"],setup(_,{emit:e}){const x=e,w=h(!1),t=I({password:"",error:"",processing:!1}),l=h(null),v=()=>{axios.get(route("password.confirmation")).then(u=>{u.data.confirmed?x("confirmed"):(w.value=!0,setTimeout(()=>l.value.focus(),250))})},b=()=>{t.processing=!0,axios.post(route("password.confirm"),{password:t.password}).then(()=>{t.processing=!1,g(),H().then(()=>x("confirmed"))}).catch(u=>{t.processing=!1,t.error=u.response.data.errors.password[0],l.value.focus()})},g=()=>{w.value=!1,t.password="",t.error=""};return(u,m)=>(s(),c("span",null,[o("span",{onClick:v},[$(u.$slots,"default")]),i(me,{show:w.value,onClose:g},{title:r(()=>[d(a(_.title),1)]),content:r(()=>[d(a(_.content)+" ",1),o("div",_e,[i(N,{ref_key:"passwordInput",ref:l,modelValue:t.password,"onUpdate:modelValue":m[0]||(m[0]=y=>t.password=y),type:"password",class:"mt-1 block w-3/4",placeholder:"Mot de passe",autocomplete:"current-password",onKeyup:M(b,["enter"])},null,8,["modelValue"]),i(D,{message:t.error,class:"mt-2"},null,8,["message"])])]),footer:r(()=>[i(B,{onClick:g},{default:r(()=>[...m[1]||(m[1]=[d(" Annuler ",-1)])]),_:1}),i(V,{class:S(["ms-3",{"opacity-25":t.processing}]),disabled:t.processing,onClick:b},{default:r(()=>[d(a(_.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},fe={key:0,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},pe={key:1,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ve={key:2,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ge={class:"mt-3 max-w-xl text-sm text-gray-600 dark:text-gray-400"},ye={key:3},he={key:0},xe={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},we={key:0,class:"font-semibold"},be={key:1},ke=["innerHTML"],$e={key:0,class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},Ce={class:"font-semibold"},Se={class:"font-mono text-base select-all"},Fe={key:1,class:"mt-4"},Be={key:1},Te={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},Ve={class:"font-semibold"},Pe={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 dark:bg-gray-900 rounded-lg"},Ae={class:"mt-5"},qe={key:0},Ke={key:1},Ie={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(_){const{t:e}=Z(),x=_,w=J(),t=h(!1),l=h(!1),v=h(!1),b=h(null),g=h(null),u=h([]),m=R({code:""}),y=G(()=>{var p;return!t.value&&((p=w.props.auth.user)==null?void 0:p.two_factor_enabled)});U(y,()=>{y.value||(m.reset(),m.clearErrors())});const L=()=>{t.value=!0,K.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([j(),z(),T()]),onFinish:()=>{t.value=!1,l.value=x.requiresConfirmation}})},j=()=>axios.get(route("two-factor.qr-code")).then(p=>{b.value=p.data.svg}),z=()=>axios.get(route("two-factor.secret-key")).then(p=>{g.value=p.data.secretKey}),T=()=>axios.get(route("two-factor.recovery-codes")).then(p=>{u.value=p.data}),P=()=>{m.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{l.value=!1,b.value=null,g.value=null}})},E=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>T())},A=()=>{v.value=!0,K.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{v.value=!1,l.value=!1}})};return(p,q)=>(s(),k(le,null,{title:r(()=>[d(a(n(e)("two_factor_authentication")),1)]),description:r(()=>[d(a(n(e)("two_factor_description")),1)]),content:r(()=>[y.value&&!l.value?(s(),c("h3",fe,a(n(e)("two_factor_enabled")),1)):y.value&&l.value?(s(),c("h3",pe,a(n(e)("two_factor_finish_enabling")),1)):(s(),c("h3",ve,a(n(e)("two_factor_not_enabled")),1)),o("div",ge,[o("p",null,a(n(e)("two_factor_explanation")),1)]),y.value?(s(),c("div",ye,[b.value?(s(),c("div",he,[o("div",xe,[l.value?(s(),c("p",we,a(n(e)("two_factor_scan_qr_confirming")),1)):(s(),c("p",be,a(n(e)("two_factor_scan_qr_enabled")),1))]),o("div",{class:"mt-4 p-4 bg-white inline-block rounded-lg",innerHTML:b.value},null,8,ke),g.value?(s(),c("div",$e,[o("p",Ce,[d(a(n(e)("setup_key"))+" ",1),o("span",Se,a(g.value),1)])])):f("",!0),l.value?(s(),c("div",Fe,[i(X,{for:"code",value:n(e)("code")},null,8,["value"]),i(N,{id:"code",modelValue:n(m).code,"onUpdate:modelValue":q[0]||(q[0]=F=>n(m).code=F),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:M(P,["enter"])},null,8,["modelValue"]),i(D,{message:n(m).errors.code,class:"mt-2"},null,8,["message"])])):f("",!0)])):f("",!0),u.value.length>0&&!l.value?(s(),c("div",Be,[o("div",Te,[o("p",Ve,a(n(e)("recovery_codes_info")),1)]),o("div",Pe,[(s(!0),c(W,null,Q(u.value,F=>(s(),c("div",{key:F},a(F),1))),128))])])):f("",!0)])):f("",!0),o("div",Ae,[y.value?(s(),c("div",Ke,[i(C,{onConfirmed:P},{default:r(()=>[l.value?(s(),k(V,{key:0,type:"button",class:S(["me-3",{"opacity-25":t.value}]),disabled:t.value},{default:r(()=>[d(a(n(e)("confirm")),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),i(C,{onConfirmed:E},{default:r(()=>[u.value.length>0&&!l.value?(s(),k(B,{key:0,class:"me-3"},{default:r(()=>[d(a(n(e)("regenerate_recovery_codes")),1)]),_:1})):f("",!0)]),_:1}),i(C,{onConfirmed:T},{default:r(()=>[u.value.length===0&&!l.value?(s(),k(B,{key:0,class:"me-3"},{default:r(()=>[d(a(n(e)("show_recovery_codes")),1)]),_:1})):f("",!0)]),_:1}),i(C,{onConfirmed:A},{default:r(()=>[l.value?(s(),k(B,{key:0,class:S({"opacity-25":v.value}),disabled:v.value},{default:r(()=>[d(a(n(e)("cancel")),1)]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),i(C,{onConfirmed:A},{default:r(()=>[l.value?f("",!0):(s(),k(Y,{key:0,class:S({"opacity-25":v.value}),disabled:v.value},{default:r(()=>[d(a(n(e)("disable")),1)]),_:1},8,["class","disabled"]))]),_:1})])):(s(),c("div",qe,[i(C,{onConfirmed:L},{default:r(()=>[i(V,{type:"button",class:S({"opacity-25":t.value}),disabled:t.value},{default:r(()=>[d(a(n(e)("enable")),1)]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Ie as default};
