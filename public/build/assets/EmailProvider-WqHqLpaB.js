import{u as P,y as D,c as o,a as b,b as r,h as L,i as v,d as e,l as w,e as p,t as i,w as N,o as a,F as g,j as _,x as V,f as h,J as T,g as c,k as H,ak as F,v as E,B as z,r as S,p as $}from"./app-Cw-UdvnB.js";import{_ as I}from"./AppLayout-BPXH3yDG.js";import{u as R}from"./useTranslations-CG1TRj3c.js";import"./DropdownLink-DfZnvZxO.js";const G={class:"text-xl font-semibold text-slate-900 dark:text-white"},J={class:"mb-6 border-b border-slate-200 dark:border-slate-700"},K={class:"flex space-x-8","aria-label":"Settings tabs"},Q={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},W={class:"px-6 py-4 space-y-4"},X=["onClick"],Y={class:"flex items-center h-5"},Z=["id","value"],ee={class:"ml-3"},te=["for"],re={key:0,class:"ml-2 inline-flex items-center rounded-xl bg-emerald-100 px-2 py-0.5 text-xs font-medium text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200"},se={class:"text-sm text-slate-500 dark:text-slate-400"},oe={key:0,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},ae={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},le={class:"text-lg font-medium text-slate-900 dark:text-white"},de={class:"px-6 py-4 space-y-4"},ie=["for"],ne={key:0,class:"text-pink-500"},ue=["id","onUpdate:modelValue"],me=["value"],ce={key:1,class:"relative mt-1"},pe=["id","type","onUpdate:modelValue","required"],xe=["onClick"],be={key:0,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ve={key:1,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},he=["id","type","onUpdate:modelValue","required"],ke={key:3,class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},fe={key:0,class:"text-sm text-pink-600"},we={key:1,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},ye={class:"px-6 py-4 space-y-4"},ge={key:2,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},_e={class:"px-6 py-4"},Ce={class:"flex items-center justify-between"},je={class:"flex items-center space-x-3"},Me={key:0,class:"w-6 h-6 text-emerald-600 dark:text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ve={key:1,class:"w-6 h-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Fe={class:"font-medium text-slate-900 dark:text-white"},Ee={key:0,class:"text-sm text-slate-500 dark:text-slate-400"},ze=["disabled"],Se={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},Ue={class:"mt-2 text-sm text-slate-500 dark:text-slate-400"},Be={class:"flex justify-end space-x-3"},Ae=["disabled"],Oe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Ne={__name:"EmailProvider",props:{settings:Object,providers:Object,smtpFields:Object,brevoFields:Object,postmarkFields:Object,resendFields:Object,userEmail:String},setup(m){const{t:k}=R(),x=m,s=P({provider:x.settings.provider||"faktur",from_address:x.settings.from_address||"",from_name:x.settings.from_name||"",config:{}}),f=S(!1),y=S({}),C=z(()=>{switch(s.provider){case"smtp":return x.smtpFields;case"brevo":return x.brevoFields;case"postmark":return x.postmarkFields;case"resend":return x.resendFields;default:return{}}});D(()=>s.provider,n=>{s.config={};const t=C.value;Object.keys(t).forEach(d=>{t[d].default!==void 0&&(s.config[d]=t[d].default)})},{immediate:!0});const j=z(()=>["smtp","brevo","postmark","resend"].includes(s.provider)),U={faktur:"Envoi via les serveurs de faktur.lu. Aucune configuration requise.",smtp:"Utilisez votre propre serveur SMTP (Gmail, Office 365, OVH, etc.).",brevo:"Service d'email marketing et transactionnel (anciennement Sendinblue).",postmark:"Service d'email transactionnel premium avec excellent taux de délivrabilité.",resend:"API email moderne et simple à configurer."},B=()=>{s.put(route("settings.email.provider.update"),{preserveScroll:!0})},A=()=>{f.value=!0,$.post(route("settings.email.provider.test"),{},{preserveScroll:!0,onFinish:()=>{f.value=!1}})},O=n=>{y.value[n]=!y.value[n]},q=(n,t)=>t.type==="password"?y.value[n]?"text":"password":t.type||"text";return(n,t)=>(a(),o(g,null,[b(r(L),{title:"Configuration Email"}),b(I,null,{header:v(()=>[e("h1",G,i(r(k)("settings")),1)]),default:v(()=>[e("div",J,[e("nav",K,[b(r(w),{href:n.route("settings.business.edit"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[p(i(r(k)("business_settings")),1)]),_:1},8,["href"]),b(r(w),{href:n.route("settings.email"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[p(i(r(k)("email_settings")),1)]),_:1},8,["href"]),b(r(w),{href:n.route("settings.email.provider"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-primary-500 text-primary-600 dark:text-primary-400"},{default:v(()=>[...t[3]||(t[3]=[p(" Fournisseur Email ",-1)])]),_:1},8,["href"]),b(r(w),{href:n.route("settings.accountant"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[...t[4]||(t[4]=[p(" Accès Comptable ",-1)])]),_:1},8,["href"]),b(r(w),{href:n.route("subscription.index"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[...t[5]||(t[5]=[p(" Abonnement ",-1)])]),_:1},8,["href"])])]),e("form",{onSubmit:N(B,["prevent"]),class:"space-y-6"},[e("div",Q,[t[6]||(t[6]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Provider d'envoi"),e("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Choisissez comment envoyer vos factures par email. ")],-1)),e("div",W,[(a(!0),o(g,null,_(m.providers,(d,l)=>(a(),o("div",{key:l,class:V(["relative flex items-start p-4 border rounded-xl cursor-pointer transition-colors",r(s).provider===l?"border-primary-500 bg-primary-50 dark:bg-primary-900/20 dark:border-primary-400":"border-slate-200 dark:border-slate-600 hover:border-slate-300 dark:hover:border-slate-500"]),onClick:u=>r(s).provider=l},[e("div",Y,[h(e("input",{id:"provider-"+l,type:"radio",value:l,"onUpdate:modelValue":t[0]||(t[0]=u=>r(s).provider=u),class:"h-4 w-4 text-primary-600 border-slate-300 focus:ring-primary-500"},null,8,Z),[[T,r(s).provider]])]),e("div",ee,[e("label",{for:"provider-"+l,class:"font-medium text-slate-900 dark:text-white cursor-pointer"},[p(i(d)+" ",1),l==="faktur"?(a(),o("span",re," Recommandé ")):c("",!0)],8,te),e("p",se,i(U[l]),1)])],10,X))),128))])]),j.value?(a(),o("div",oe,[e("div",ae,[e("h2",le," Configuration "+i(m.providers[r(s).provider]),1)]),e("div",de,[(a(!0),o(g,null,_(C.value,(d,l)=>(a(),o("div",{key:l},[e("label",{for:l,class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},[p(i(d.label)+" ",1),d.required?(a(),o("span",ne,"*")):c("",!0)],8,ie),d.type==="select"?h((a(),o("select",{key:0,id:l,"onUpdate:modelValue":u=>r(s).config[l]=u,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(a(!0),o(g,null,_(d.options,(u,M)=>(a(),o("option",{key:M,value:M},i(u),9,me))),128))],8,ue)),[[H,r(s).config[l]]]):d.type==="password"?(a(),o("div",ce,[h(e("input",{id:l,type:q(l,d),"onUpdate:modelValue":u=>r(s).config[l]=u,required:d.required,class:"block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white pr-10"},null,8,pe),[[F,r(s).config[l]]]),e("button",{type:"button",onClick:u=>O(l),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400 hover:text-slate-500"},[y.value[l]?(a(),o("svg",be,[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(a(),o("svg",ve,[...t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))],8,xe)])):h((a(),o("input",{key:2,id:l,type:d.type||"text","onUpdate:modelValue":u=>r(s).config[l]=u,required:d.required,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,8,he)),[[F,r(s).config[l]]]),d.help?(a(),o("p",ke,i(d.help),1)):c("",!0)]))),128)),r(s).errors.config?(a(),o("p",fe,i(r(s).errors.config),1)):c("",!0)])])):c("",!0),j.value?(a(),o("div",we,[t[11]||(t[11]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Expéditeur"),e("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Personnalisez l'adresse et le nom de l'expéditeur. ")],-1)),e("div",ye,[e("div",null,[t[9]||(t[9]=e("label",{for:"from_address",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Adresse email ",-1)),h(e("input",{id:"from_address",type:"email","onUpdate:modelValue":t[1]||(t[1]=d=>r(s).from_address=d),placeholder:"contact@votreentreprise.lu",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[E,r(s).from_address]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"from_name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Nom de l'expéditeur ",-1)),h(e("input",{id:"from_name",type:"text","onUpdate:modelValue":t[2]||(t[2]=d=>r(s).from_name=d),placeholder:"Votre Entreprise",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[E,r(s).from_name]])])])])):c("",!0),m.settings.provider!=="faktur"?(a(),o("div",ge,[e("div",_e,[e("div",Ce,[e("div",je,[e("div",{class:V(["flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center",m.settings.provider_verified?"bg-emerald-100 dark:bg-emerald-900":"bg-amber-100 dark:bg-amber-900"])},[m.settings.provider_verified?(a(),o("svg",Me,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(a(),o("svg",Ve,[...t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])]))],2),e("div",null,[e("p",Fe,i(m.settings.provider_verified?"Configuration vérifiée":"Configuration non vérifiée"),1),m.settings.last_test_at?(a(),o("p",Ee," Dernier test : "+i(m.settings.last_test_at),1)):c("",!0)])]),e("button",{type:"button",onClick:A,disabled:f.value||r(s).processing,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[f.value?(a(),o("svg",Se,[...t[14]||(t[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),p(" "+i(f.value?"Envoi en cours...":"Envoyer un email de test"),1)],8,ze)]),e("p",Ue," Un email de test sera envoyé à "+i(m.userEmail)+". ",1)])])):c("",!0),e("div",Be,[e("button",{type:"submit",disabled:r(s).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[r(s).processing?(a(),o("svg",Oe,[...t[15]||(t[15]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):c("",!0),p(" "+i(r(s).processing?r(k)("saving"):r(k)("save")),1)],8,Ae)])],32)]),_:1})],64))}};export{Ne as default};
