import{r as v,y as J,c as r,a as g,b as s,h as q,i as I,d as t,t as e,f as p,o as i,F as h,j as y,k as L,v as w,e as $,x as z,g as c,w as G,p as H}from"./app-DiyhQPs-.js";import{_ as K}from"./AuthenticatedLayout-7QL331Ph.js";import{_ as Q}from"./Pagination-Dp6JhzoP.js";import{u as R}from"./useTranslations-C2jvNljI.js";import"./ApplicationLogo-CalWiLed.js";import"./DropdownLink-DfW2eLhf.js";const W={class:"flex items-center justify-between"},X={class:"text-xl font-semibold leading-tight text-slate-800 dark:text-slate-200"},Y={class:"py-12"},Z={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},tt={class:"mb-6 rounded-2xl bg-white p-4 shadow dark:bg-slate-800"},et={class:"grid grid-cols-1 gap-4 md:grid-cols-5"},st={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},at={value:""},lt=["value"],dt={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},ot={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},rt={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},it={value:""},nt={value:"success"},ct={value:"failed"},ut={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},xt=["placeholder"],mt={class:"mt-4 flex justify-end"},pt={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},_t={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},ht={class:"bg-slate-50 dark:bg-slate-700"},kt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},ft={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},bt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},vt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},gt={class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},yt={class:"divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800"},wt={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-900 dark:text-slate-200"},Ct={class:"text-xs text-slate-500 dark:text-slate-400"},jt={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-900 dark:text-slate-200"},Vt={class:"mr-2"},Mt={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400"},Bt={key:0},St={key:1},Tt={class:"whitespace-nowrap px-6 py-4 text-sm"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400"},Nt={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},Ot=["onClick"],Ut={key:0},Dt={colspan:"6",class:"px-6 py-12 text-center text-sm text-slate-500 dark:text-slate-400"},It={key:0,class:"border-t border-slate-200 px-4 py-3 dark:border-slate-700"},Lt={class:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0"},$t={class:"inline-block transform overflow-hidden rounded-2xl bg-white text-left align-bottom shadow-xl transition-all dark:bg-slate-800 sm:my-8 sm:w-full sm:max-w-2xl sm:align-middle"},zt={class:"bg-white px-4 pb-4 pt-5 dark:bg-slate-800 sm:p-6 sm:pb-4"},Pt={class:"flex items-start justify-between"},At={class:"text-lg font-medium leading-6 text-slate-900 dark:text-slate-100"},Et={class:"mt-4 space-y-4"},Jt={class:"grid grid-cols-2 gap-4 text-sm"},qt={class:"font-medium text-slate-500 dark:text-slate-400"},Gt={class:"ml-2 text-slate-900 dark:text-slate-100"},Ht={class:"font-medium text-slate-500 dark:text-slate-400"},Kt={key:0},Qt={class:"font-medium text-slate-500 dark:text-slate-400"},Rt={class:"ml-2 text-slate-900 dark:text-slate-100"},Wt={class:"ml-2 text-slate-900 dark:text-slate-100"},Xt={key:0},Yt={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},Zt={class:"overflow-hidden rounded-2xl border border-slate-200 dark:border-slate-600"},te={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-600"},ee={class:"bg-slate-50 dark:bg-slate-700"},se={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},ae={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},le={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},de={class:"divide-y divide-slate-200 dark:divide-slate-600"},oe={class:"px-4 py-2 text-sm font-medium text-slate-900 dark:text-slate-100"},re={class:"px-4 py-2 text-sm text-red-600 dark:text-red-400"},ie={class:"px-4 py-2 text-sm text-green-600 dark:text-green-400"},ne={key:1},ce={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},ue={class:"overflow-auto rounded-2xl bg-slate-100 p-3 text-xs dark:bg-slate-700"},xe={key:2},me={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},pe={class:"break-all text-sm text-slate-600 dark:text-slate-400"},_e={class:"bg-slate-50 px-4 py-3 dark:bg-slate-700 sm:flex sm:flex-row-reverse sm:px-6"},ye={__name:"Index",props:{logs:Object,filters:Object,categories:Array},setup(u){const{t:a}=R(),m=u,n=v({category:m.filters.category||"",from:m.filters.from||"",to:m.filters.to||"",status:m.filters.status||"",search:m.filters.search||""}),o=v(null),k=v(!1),x=()=>{H.get(route("audit-logs.index"),{...n.value},{preserveState:!0,preserveScroll:!0})},P=()=>{n.value={category:"",from:"",to:"",status:"",search:""},x()},A=_=>{o.value=_,k.value=!0},f=()=>{k.value=!1,o.value=null},E=()=>{window.location.href=route("audit-logs.export",n.value)},C=_=>_==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";let j;return J(()=>n.value.search,()=>{clearTimeout(j),j=setTimeout(x,500)}),(_,d)=>(i(),r(h,null,[g(s(q),{title:s(a)("audit_logs")},null,8,["title"]),g(K,null,{header:I(()=>[t("div",W,[t("h2",X,e(s(a)("audit_logs")),1),t("button",{onClick:E,class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-700 dark:text-slate-200 dark:ring-slate-600 dark:hover:bg-slate-600"},[d[5]||(d[5]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),$(" "+e(s(a)("export_csv")),1)])])]),default:I(()=>{var V,M,B,S,T,F,N,O,U,D;return[t("div",Y,[t("div",Z,[t("div",tt,[t("div",et,[t("div",null,[t("label",st,e(s(a)("category")),1),p(t("select",{"onUpdate:modelValue":d[0]||(d[0]=l=>n.value.category=l),onChange:x,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},[t("option",at,e(s(a)("all")),1),(i(!0),r(h,null,y(u.categories,l=>(i(),r("option",{key:l.value,value:l.value},e(l.label),9,lt))),128))],544),[[L,n.value.category]])]),t("div",null,[t("label",dt,e(s(a)("from_date")),1),p(t("input",{type:"date","onUpdate:modelValue":d[1]||(d[1]=l=>n.value.from=l),onChange:x,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,544),[[w,n.value.from]])]),t("div",null,[t("label",ot,e(s(a)("to_date")),1),p(t("input",{type:"date","onUpdate:modelValue":d[2]||(d[2]=l=>n.value.to=l),onChange:x,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,544),[[w,n.value.to]])]),t("div",null,[t("label",rt,e(s(a)("status")),1),p(t("select",{"onUpdate:modelValue":d[3]||(d[3]=l=>n.value.status=l),onChange:x,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},[t("option",it,e(s(a)("all")),1),t("option",nt,e(s(a)("success")),1),t("option",ct,e(s(a)("failed")),1)],544),[[L,n.value.status]])]),t("div",null,[t("label",ut,e(s(a)("search")),1),p(t("input",{type:"text","onUpdate:modelValue":d[4]||(d[4]=l=>n.value.search=l),placeholder:s(a)("search_placeholder"),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,8,xt),[[w,n.value.search]])])]),t("div",mt,[t("button",{onClick:P,class:"text-sm text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-200"},e(s(a)("reset_filters")),1)])]),t("div",pt,[t("table",_t,[t("thead",ht,[t("tr",null,[t("th",kt,e(s(a)("date_time")),1),t("th",ft,e(s(a)("action")),1),t("th",bt,e(s(a)("resource")),1),t("th",vt,e(s(a)("status")),1),d[6]||(d[6]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"}," IP ",-1)),t("th",gt,e(s(a)("actions")),1)])]),t("tbody",yt,[(i(!0),r(h,null,y(u.logs.data,l=>(i(),r("tr",{key:l.id,class:"hover:bg-slate-50 dark:hover:bg-slate-700"},[t("td",wt,[t("div",null,e(l.created_at),1),t("div",Ct,e(l.created_at_human),1)]),t("td",jt,[t("span",Vt,e(l.action_emoji),1),$(" "+e(l.action_label),1)]),t("td",Mt,[l.auditable_type?(i(),r("span",Bt,e(l.auditable_type)+" #"+e(l.auditable_id),1)):(i(),r("span",St,"-"))]),t("td",Tt,[t("span",{class:z([C(l.status),"inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(l.status==="success"?s(a)("success"):s(a)("failed")),3)]),t("td",Ft,e(l.ip_address||"-"),1),t("td",Nt,[t("button",{onClick:b=>A(l),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},e(s(a)("details")),9,Ot)])]))),128)),u.logs.data.length===0?(i(),r("tr",Ut,[t("td",Dt,e(s(a)("no_audit_entries")),1)])):c("",!0)])]),u.logs.data.length>0?(i(),r("div",It,[g(Q,{links:u.logs.links},null,8,["links"])])):c("",!0)])])]),k.value?(i(),r("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:G(f,["self"])},[t("div",Lt,[d[9]||(d[9]=t("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[t("div",{class:"absolute inset-0 bg-slate-500 opacity-75 dark:bg-slate-900"})],-1)),d[10]||(d[10]=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"â€‹",-1)),t("div",$t,[t("div",zt,[t("div",Pt,[t("h3",At,e((V=o.value)==null?void 0:V.action_emoji)+" "+e((M=o.value)==null?void 0:M.action_label),1),t("button",{onClick:f,class:"text-slate-400 hover:text-slate-500"},[...d[7]||(d[7]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Et,[t("div",Jt,[t("div",null,[t("span",qt,e(s(a)("date"))+" :",1),t("span",Gt,e((B=o.value)==null?void 0:B.created_at),1)]),t("div",null,[t("span",Ht,e(s(a)("status"))+" :",1),t("span",{class:z([C((S=o.value)==null?void 0:S.status),"ml-2 inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(((T=o.value)==null?void 0:T.status)==="success"?s(a)("success"):s(a)("failed")),3)]),(F=o.value)!=null&&F.auditable_type?(i(),r("div",Kt,[t("span",Qt,e(s(a)("resource"))+" :",1),t("span",Rt,e(o.value.auditable_type)+" #"+e(o.value.auditable_id),1)])):c("",!0),t("div",null,[d[8]||(d[8]=t("span",{class:"font-medium text-slate-500 dark:text-slate-400"},"IP :",-1)),t("span",Wt,e(((N=o.value)==null?void 0:N.ip_address)||"-"),1)])]),(O=o.value)!=null&&O.changed_fields&&Object.keys(o.value.changed_fields).length>0?(i(),r("div",Xt,[t("h4",Yt,e(s(a)("changes"))+" :",1),t("div",Zt,[t("table",te,[t("thead",ee,[t("tr",null,[t("th",se,e(s(a)("field")),1),t("th",ae,e(s(a)("before")),1),t("th",le,e(s(a)("after")),1)])]),t("tbody",de,[(i(!0),r(h,null,y(o.value.changed_fields,(l,b)=>(i(),r("tr",{key:b},[t("td",oe,e(b),1),t("td",re,e(l.old??"-"),1),t("td",ie,e(l.new??"-"),1)]))),128))])])])])):c("",!0),(U=o.value)!=null&&U.metadata&&Object.keys(o.value.metadata).length>0?(i(),r("div",ne,[t("h4",ce,e(s(a)("metadata"))+" :",1),t("pre",ue,e(JSON.stringify(o.value.metadata,null,2)),1)])):c("",!0),(D=o.value)!=null&&D.user_agent?(i(),r("div",xe,[t("h4",me,e(s(a)("browser"))+" :",1),t("p",pe,e(o.value.user_agent),1)])):c("",!0)])]),t("div",_e,[t("button",{onClick:f,class:"mt-3 inline-flex w-full justify-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-base font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus:outline-none dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-600 sm:ml-3 sm:mt-0 sm:w-auto sm:text-sm"},e(s(a)("close")),1)])])])])):c("",!0)]}),_:1})],64))}};export{ye as default};
