import{r as c,z as I,c as n,a as m,b as a,h as O,i as x,d as e,f as F,t as r,o as i,F as u,j as y,k as B,l as f,e as v,g as j,x as V,m as q,p as Q,B as G,H as J}from"./app-B97I2Oxk.js";import{_ as K}from"./AppLayout-BV7HVWRJ.js";import{u as W}from"./useTranslations-C4Y-NByF.js";import"./ApplicationLogo-DwcnZXn5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-C30LA8Zs.js";const X={class:"flex items-center justify-between"},Y={class:"text-xl font-semibold text-gray-900 dark:text-white"},Z={class:"mb-6 flex flex-wrap gap-4"},ee={value:""},te=["value"],re={value:""},se=["value"],ae={value:""},oe=["value"],le={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ie={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ne={class:"bg-gray-50 dark:bg-gray-700"},de={class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white sm:pl-6"},ce={class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"},ue={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white md:table-cell"},ge={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white lg:table-cell"},he={class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"},xe={class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"},ye={class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},fe={class:"sr-only"},ve={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},pe={key:0},me={colspan:"7",class:"py-10 text-center text-sm text-gray-500 dark:text-gray-400"},be={class:"mt-2"},ke={class:"whitespace-nowrap py-4 pl-4 pr-3 sm:pl-6"},we={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400"},_e={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 md:table-cell"},Ce={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 lg:table-cell"},je={class:"whitespace-nowrap px-3 py-4 text-right text-sm font-medium text-gray-900 dark:text-white"},Le={class:"whitespace-nowrap px-3 py-4 text-sm"},Me={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ze={class:"flex items-center justify-end gap-3"},Fe=["onClick","title"],Be={key:0,class:"mt-6 flex items-center justify-between"},Ve={class:"text-sm text-gray-700 dark:text-gray-400"},qe={class:"isolate inline-flex -space-x-px rounded-md shadow-sm"},He={key:1,class:"fixed inset-0 z-50 overflow-hidden"},De={class:"flex items-center justify-center min-h-screen p-4"},Pe={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Ue={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},$e={class:"text-lg font-medium text-gray-900 dark:text-white"},Se={class:"flex items-center space-x-2"},Te={class:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden"},Ae=["onClick","title"],Ee=["href"],Ne={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},Re={key:0,class:"flex items-center justify-center h-96"},Ie=["innerHTML"],Oe={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},et={__name:"Index",props:{quotes:Object,filters:Object,statuses:Array,years:Array,clients:Array},setup(d){const{t:s}=W(),L=d,b=c(L.filters.status||""),k=c(L.filters.year||""),w=c(L.filters.client_id||""),_=c(!1),C=c(""),M=c(!1),g=c(null),p=c("fr"),$=[{value:"fr",label:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{value:"de",label:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{value:"en",label:"English",flag:"ðŸ‡¬ðŸ‡§"},{value:"lb",label:"LÃ«tzebuergesch",flag:"ðŸ‡±ðŸ‡º"}],S=G(()=>g.value?`${route("quotes.pdf.stream",g.value.id)}?locale=${p.value}`:""),H=async()=>{if(g.value){M.value=!0;try{const l=route("quotes.preview-html",g.value.id)+`?locale=${p.value}`,o=await J.get(l);C.value=o.data.html}catch(l){console.error("Error loading preview:",l),C.value=`<p style="color: red; padding: 20px;">${s("error_loading_preview")}</p>`}finally{M.value=!1}}},T=l=>{p.value=l,_.value&&H()},A=async l=>{var o;g.value=l,p.value=((o=l.client)==null?void 0:o.locale)||"fr",_.value=!0,H()},z=()=>{_.value=!1,C.value="",g.value=null};I([b,k,w],()=>{Q.get(route("quotes.index"),{status:b.value||void 0,year:k.value||void 0,client_id:w.value||void 0},{preserveState:!0,replace:!0})});const E=l=>{const o={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return o[l]||o.draft},N=l=>({draft:s("draft"),sent:s("sent"),accepted:s("accepted"),declined:s("rejected"),expired:s("expired"),converted:s("converted")})[l]||l,R=(l,o="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:o}).format(l),D=l=>l?new Date(l).toLocaleDateString("fr-FR"):"-",P=l=>["draft","sent"].includes(l.status);return(l,o)=>(i(),n(u,null,[m(a(O),{title:a(s)("quotes")},null,8,["title"]),m(K,null,{header:x(()=>[e("div",X,[e("h1",Y,r(a(s)("quotes")),1),m(a(f),{href:l.route("quotes.create"),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},{default:x(()=>[o[3]||(o[3]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),v(" "+r(a(s)("new_quote")),1)]),_:1},8,["href"])])]),default:x(()=>{var U;return[e("div",Z,[F(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>b.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",ee,r(a(s)("all_statuses")),1),(i(!0),n(u,null,y(d.statuses,t=>(i(),n("option",{key:t.value,value:t.value},r(t.label),9,te))),128))],512),[[B,b.value]]),F(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>k.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",re,r(a(s)("all_years")),1),(i(!0),n(u,null,y(d.years,t=>(i(),n("option",{key:t,value:t},r(t),9,se))),128))],512),[[B,k.value]]),F(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>w.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",ae,r(a(s)("all_clients")),1),(i(!0),n(u,null,y(d.clients,t=>(i(),n("option",{key:t.id,value:t.id},r(t.name),9,oe))),128))],512),[[B,w.value]])]),e("div",le,[e("table",ie,[e("thead",ne,[e("tr",null,[e("th",de,r(a(s)("reference")),1),e("th",ce,r(a(s)("client")),1),e("th",ue,r(a(s)("created_at")),1),e("th",ge,r(a(s)("due_date")),1),e("th",he,r(a(s)("total"))+" "+r(a(s)("ttc")),1),e("th",xe,r(a(s)("status")),1),e("th",ye,[e("span",fe,r(a(s)("actions")),1)])])]),e("tbody",ve,[d.quotes.data.length===0?(i(),n("tr",pe,[e("td",me,[o[4]||(o[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("p",be,r(a(s)("no_quotes")),1),m(a(f),{href:l.route("quotes.create"),class:"mt-4 inline-flex items-center text-indigo-600 hover:text-indigo-500 dark:text-indigo-400"},{default:x(()=>[v(r(a(s)("create_first_quote")),1)]),_:1},8,["href"])])])):j("",!0),(i(!0),n(u,null,y(d.quotes.data,t=>{var h;return i(),n("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",ke,[m(a(f),{href:P(t)?l.route("quotes.edit",t.id):l.route("quotes.show",t.id),class:"font-medium text-gray-900 hover:text-indigo-600 dark:text-white dark:hover:text-indigo-400"},{default:x(()=>[v(r(t.reference),1)]),_:2},1032,["href"])]),e("td",we,r((h=t.client)==null?void 0:h.name),1),e("td",_e,r(D(t.created_at)),1),e("td",Ce,r(D(t.valid_until)),1),e("td",je,r(R(t.total_ttc,t.currency)),1),e("td",Le,[e("span",{class:V([E(t.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},r(N(t.status)),3)]),e("td",Me,[e("div",ze,[e("button",{type:"button",onClick:Ge=>A(t),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",title:a(s)("preview")},[...o[5]||(o[5]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.573-3.007-9.963-7.178z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,Fe),P(t)?(i(),q(a(f),{key:0,href:l.route("quotes.edit",t.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},{default:x(()=>[v(r(a(s)("edit")),1)]),_:1},8,["href"])):(i(),q(a(f),{key:1,href:l.route("quotes.show",t.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},{default:x(()=>[v(r(a(s)("view")),1)]),_:1},8,["href"]))])])])}),128))])])]),d.quotes.links&&d.quotes.links.length>3?(i(),n("div",Be,[e("div",Ve,r(a(s)("showing"))+" "+r(d.quotes.from)+" "+r(a(s)("to"))+" "+r(d.quotes.to)+" "+r(a(s)("of"))+" "+r(d.quotes.total)+" "+r(a(s)("quotes").toLowerCase()),1),e("nav",qe,[(i(!0),n(u,null,y(d.quotes.links,(t,h)=>(i(),n(u,{key:h},[t.url?(i(),q(a(f),{key:0,href:t.url,class:V([t.active?"z-10 bg-indigo-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:text-gray-300 dark:ring-gray-600 dark:hover:bg-gray-700","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20",h===0?"rounded-l-md":"",h===d.quotes.links.length-1?"rounded-r-md":""]),innerHTML:t.label,"preserve-scroll":""},null,8,["href","class","innerHTML"])):j("",!0)],64))),128))])])):j("",!0),_.value?(i(),n("div",He,[e("div",De,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:z}),e("div",Pe,[e("div",Ue,[e("h3",$e,r((U=g.value)==null?void 0:U.reference),1),e("div",Se,[e("div",Te,[(i(),n(u,null,y($,t=>e("button",{key:t.value,type:"button",onClick:h=>T(t.value),title:t.label,class:V(["px-2 py-1.5 text-base transition-colors",p.value===t.value?"bg-indigo-100 dark:bg-indigo-900":"bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},r(t.flag),11,Ae)),64))]),e("a",{href:S.value,target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...o[6]||(o[6]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),v(" PDF ",-1)])],8,Ee),e("button",{type:"button",onClick:z,class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...o[7]||(o[7]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Ne,[M.value?(i(),n("div",Re,[...o[8]||(o[8]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(i(),n("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:C.value},null,8,Ie))]),e("div",Oe,[e("button",{type:"button",onClick:z,class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"},r(a(s)("close")),1)])])])])):j("",!0)]}),_:1})],64))}};export{et as default};
