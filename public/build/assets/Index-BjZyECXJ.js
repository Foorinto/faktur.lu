import{c as n,d as t,m as C,i as _,e as f,b as s,l as j,g as x,F as h,j as b,x as v,o as d,r as M,z as q,a as T,h as G,t as e,f as k,k as I,v as V,w as K,p as Q}from"./app-BvkLQeeV.js";import{_ as R}from"./AuthenticatedLayout-DeBsJtZ8.js";import{u as W}from"./useTranslations-C_3tG1vC.js";import"./ApplicationLogo-DamM7rHy.js";import"./DropdownLink-BnJSHsP6.js";const X={key:0,class:"flex items-center justify-between"},Y={class:"flex flex-1 justify-between sm:hidden"},Z={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-center"},tt={class:"isolate inline-flex -space-x-px rounded-xl shadow-sm","aria-label":"Pagination"},et=["innerHTML"],st={__name:"Pagination",props:{links:Array},setup(c){return(a,u)=>c.links.length>3?(d(),n("nav",X,[t("div",Y,[c.links[0].url?(d(),C(s(j),{key:0,href:c.links[0].url,class:"relative inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700"},{default:_(()=>[...u[0]||(u[0]=[f(" Précédent ",-1)])]),_:1},8,["href"])):x("",!0),c.links[c.links.length-1].url?(d(),C(s(j),{key:1,href:c.links[c.links.length-1].url,class:"relative ml-3 inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700"},{default:_(()=>[...u[1]||(u[1]=[f(" Suivant ",-1)])]),_:1},8,["href"])):x("",!0)]),t("div",Z,[t("div",null,[t("nav",tt,[(d(!0),n(h,null,b(c.links,(i,r)=>(d(),n(h,{key:r},[i.url?(d(),C(s(j),{key:0,href:i.url,innerHTML:i.label,class:v(["relative inline-flex items-center border px-4 py-2 text-sm font-medium focus:z-20",[i.active?"z-10 border-primary-500 bg-primary-50 text-primary-600 dark:border-primary-400 dark:bg-primary-900/50 dark:text-primary-400":"border-slate-300 bg-white text-slate-500 hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-400 dark:hover:bg-slate-700",r===0?"rounded-l-xl":"",r===c.links.length-1?"rounded-r-xl":""]])},null,8,["href","innerHTML","class"])):(d(),n("span",{key:1,innerHTML:i.label,class:v(["relative inline-flex items-center border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-400 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-500",[r===0?"rounded-l-xl":"",r===c.links.length-1?"rounded-r-xl":""]])},null,10,et))],64))),128))])])])])):x("",!0)}},at={class:"flex items-center justify-between"},lt={class:"text-xl font-semibold leading-tight text-slate-800 dark:text-slate-200"},rt={class:"py-12"},dt={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},ot={class:"mb-6 rounded-2xl bg-white p-4 shadow dark:bg-slate-800"},it={class:"grid grid-cols-1 gap-4 md:grid-cols-5"},nt={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},ct={value:""},ut=["value"],xt={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},mt={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},ht={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},kt={value:""},pt={value:"success"},bt={value:"failed"},_t={class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},ft=["placeholder"],vt={class:"mt-4 flex justify-end"},gt={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},yt={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},wt={class:"bg-slate-50 dark:bg-slate-700"},Ct={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},jt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},Mt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},Tt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},Vt={class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"},$t={class:"divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800"},Bt={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-900 dark:text-slate-200"},Lt={class:"text-xs text-slate-500 dark:text-slate-400"},St={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-900 dark:text-slate-200"},zt={class:"mr-2"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400"},Nt={key:0},Ot={key:1},Pt={class:"whitespace-nowrap px-6 py-4 text-sm"},Ut={class:"whitespace-nowrap px-6 py-4 text-sm text-slate-500 dark:text-slate-400"},Ht={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},Dt=["onClick"],It={key:0},At={colspan:"6",class:"px-6 py-12 text-center text-sm text-slate-500 dark:text-slate-400"},Et={key:0,class:"border-t border-slate-200 px-4 py-3 dark:border-slate-700"},Jt={class:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0"},qt={class:"inline-block transform overflow-hidden rounded-2xl bg-white text-left align-bottom shadow-xl transition-all dark:bg-slate-800 sm:my-8 sm:w-full sm:max-w-2xl sm:align-middle"},Gt={class:"bg-white px-4 pb-4 pt-5 dark:bg-slate-800 sm:p-6 sm:pb-4"},Kt={class:"flex items-start justify-between"},Qt={class:"text-lg font-medium leading-6 text-slate-900 dark:text-slate-100"},Rt={class:"mt-4 space-y-4"},Wt={class:"grid grid-cols-2 gap-4 text-sm"},Xt={class:"font-medium text-slate-500 dark:text-slate-400"},Yt={class:"ml-2 text-slate-900 dark:text-slate-100"},Zt={class:"font-medium text-slate-500 dark:text-slate-400"},te={key:0},ee={class:"font-medium text-slate-500 dark:text-slate-400"},se={class:"ml-2 text-slate-900 dark:text-slate-100"},ae={class:"ml-2 text-slate-900 dark:text-slate-100"},le={key:0},re={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},de={class:"overflow-hidden rounded-2xl border border-slate-200 dark:border-slate-600"},oe={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-600"},ie={class:"bg-slate-50 dark:bg-slate-700"},ne={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},ce={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},ue={class:"px-4 py-2 text-left text-xs font-medium text-slate-500 dark:text-slate-300"},xe={class:"divide-y divide-slate-200 dark:divide-slate-600"},me={class:"px-4 py-2 text-sm font-medium text-slate-900 dark:text-slate-100"},he={class:"px-4 py-2 text-sm text-red-600 dark:text-red-400"},ke={class:"px-4 py-2 text-sm text-green-600 dark:text-green-400"},pe={key:1},be={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},_e={class:"overflow-auto rounded-2xl bg-slate-100 p-3 text-xs dark:bg-slate-700"},fe={key:2},ve={class:"mb-2 font-medium text-slate-900 dark:text-slate-100"},ge={class:"break-all text-sm text-slate-600 dark:text-slate-400"},ye={class:"bg-slate-50 px-4 py-3 dark:bg-slate-700 sm:flex sm:flex-row-reverse sm:px-6"},Ve={__name:"Index",props:{logs:Object,filters:Object,categories:Array},setup(c){const{t:a}=W(),u=c,i=M({category:u.filters.category||"",from:u.filters.from||"",to:u.filters.to||"",status:u.filters.status||"",search:u.filters.search||""}),r=M(null),g=M(!1),m=()=>{Q.get(route("audit-logs.index"),{...i.value},{preserveState:!0,preserveScroll:!0})},A=()=>{i.value={category:"",from:"",to:"",status:"",search:""},m()},E=p=>{r.value=p,g.value=!0},y=()=>{g.value=!1,r.value=null},J=()=>{window.location.href=route("audit-logs.export",i.value)},$=p=>p==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";let B;return q(()=>i.value.search,()=>{clearTimeout(B),B=setTimeout(m,500)}),(p,o)=>(d(),n(h,null,[T(s(G),{title:s(a)("audit_logs")},null,8,["title"]),T(R,null,{header:_(()=>[t("div",at,[t("h2",lt,e(s(a)("audit_logs")),1),t("button",{onClick:J,class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-700 dark:text-slate-200 dark:ring-slate-600 dark:hover:bg-slate-600"},[o[5]||(o[5]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),f(" "+e(s(a)("export_csv")),1)])])]),default:_(()=>{var L,S,z,F,N,O,P,U,H,D;return[t("div",rt,[t("div",dt,[t("div",ot,[t("div",it,[t("div",null,[t("label",nt,e(s(a)("category")),1),k(t("select",{"onUpdate:modelValue":o[0]||(o[0]=l=>i.value.category=l),onChange:m,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},[t("option",ct,e(s(a)("all")),1),(d(!0),n(h,null,b(c.categories,l=>(d(),n("option",{key:l.value,value:l.value},e(l.label),9,ut))),128))],544),[[I,i.value.category]])]),t("div",null,[t("label",xt,e(s(a)("from_date")),1),k(t("input",{type:"date","onUpdate:modelValue":o[1]||(o[1]=l=>i.value.from=l),onChange:m,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,544),[[V,i.value.from]])]),t("div",null,[t("label",mt,e(s(a)("to_date")),1),k(t("input",{type:"date","onUpdate:modelValue":o[2]||(o[2]=l=>i.value.to=l),onChange:m,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,544),[[V,i.value.to]])]),t("div",null,[t("label",ht,e(s(a)("status")),1),k(t("select",{"onUpdate:modelValue":o[3]||(o[3]=l=>i.value.status=l),onChange:m,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},[t("option",kt,e(s(a)("all")),1),t("option",pt,e(s(a)("success")),1),t("option",bt,e(s(a)("failed")),1)],544),[[I,i.value.status]])]),t("div",null,[t("label",_t,e(s(a)("search")),1),k(t("input",{type:"text","onUpdate:modelValue":o[4]||(o[4]=l=>i.value.search=l),placeholder:s(a)("search_placeholder"),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-200"},null,8,ft),[[V,i.value.search]])])]),t("div",vt,[t("button",{onClick:A,class:"text-sm text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-200"},e(s(a)("reset_filters")),1)])]),t("div",gt,[t("table",yt,[t("thead",wt,[t("tr",null,[t("th",Ct,e(s(a)("date_time")),1),t("th",jt,e(s(a)("action")),1),t("th",Mt,e(s(a)("resource")),1),t("th",Tt,e(s(a)("status")),1),o[6]||(o[6]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-slate-500 dark:text-slate-300"}," IP ",-1)),t("th",Vt,e(s(a)("actions")),1)])]),t("tbody",$t,[(d(!0),n(h,null,b(c.logs.data,l=>(d(),n("tr",{key:l.id,class:"hover:bg-slate-50 dark:hover:bg-slate-700"},[t("td",Bt,[t("div",null,e(l.created_at),1),t("div",Lt,e(l.created_at_human),1)]),t("td",St,[t("span",zt,e(l.action_emoji),1),f(" "+e(l.action_label),1)]),t("td",Ft,[l.auditable_type?(d(),n("span",Nt,e(l.auditable_type)+" #"+e(l.auditable_id),1)):(d(),n("span",Ot,"-"))]),t("td",Pt,[t("span",{class:v([$(l.status),"inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(l.status==="success"?s(a)("success"):s(a)("failed")),3)]),t("td",Ut,e(l.ip_address||"-"),1),t("td",Ht,[t("button",{onClick:w=>E(l),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},e(s(a)("details")),9,Dt)])]))),128)),c.logs.data.length===0?(d(),n("tr",It,[t("td",At,e(s(a)("no_audit_entries")),1)])):x("",!0)])]),c.logs.data.length>0?(d(),n("div",Et,[T(st,{links:c.logs.links},null,8,["links"])])):x("",!0)])])]),g.value?(d(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:K(y,["self"])},[t("div",Jt,[o[9]||(o[9]=t("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[t("div",{class:"absolute inset-0 bg-slate-500 opacity-75 dark:bg-slate-900"})],-1)),o[10]||(o[10]=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"​",-1)),t("div",qt,[t("div",Gt,[t("div",Kt,[t("h3",Qt,e((L=r.value)==null?void 0:L.action_emoji)+" "+e((S=r.value)==null?void 0:S.action_label),1),t("button",{onClick:y,class:"text-slate-400 hover:text-slate-500"},[...o[7]||(o[7]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Rt,[t("div",Wt,[t("div",null,[t("span",Xt,e(s(a)("date"))+" :",1),t("span",Yt,e((z=r.value)==null?void 0:z.created_at),1)]),t("div",null,[t("span",Zt,e(s(a)("status"))+" :",1),t("span",{class:v([$((F=r.value)==null?void 0:F.status),"ml-2 inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(((N=r.value)==null?void 0:N.status)==="success"?s(a)("success"):s(a)("failed")),3)]),(O=r.value)!=null&&O.auditable_type?(d(),n("div",te,[t("span",ee,e(s(a)("resource"))+" :",1),t("span",se,e(r.value.auditable_type)+" #"+e(r.value.auditable_id),1)])):x("",!0),t("div",null,[o[8]||(o[8]=t("span",{class:"font-medium text-slate-500 dark:text-slate-400"},"IP :",-1)),t("span",ae,e(((P=r.value)==null?void 0:P.ip_address)||"-"),1)])]),(U=r.value)!=null&&U.changed_fields&&Object.keys(r.value.changed_fields).length>0?(d(),n("div",le,[t("h4",re,e(s(a)("changes"))+" :",1),t("div",de,[t("table",oe,[t("thead",ie,[t("tr",null,[t("th",ne,e(s(a)("field")),1),t("th",ce,e(s(a)("before")),1),t("th",ue,e(s(a)("after")),1)])]),t("tbody",xe,[(d(!0),n(h,null,b(r.value.changed_fields,(l,w)=>(d(),n("tr",{key:w},[t("td",me,e(w),1),t("td",he,e(l.old??"-"),1),t("td",ke,e(l.new??"-"),1)]))),128))])])])])):x("",!0),(H=r.value)!=null&&H.metadata&&Object.keys(r.value.metadata).length>0?(d(),n("div",pe,[t("h4",be,e(s(a)("metadata"))+" :",1),t("pre",_e,e(JSON.stringify(r.value.metadata,null,2)),1)])):x("",!0),(D=r.value)!=null&&D.user_agent?(d(),n("div",fe,[t("h4",ve,e(s(a)("browser"))+" :",1),t("p",ge,e(r.value.user_agent),1)])):x("",!0)])]),t("div",ye,[t("button",{onClick:y,class:"mt-3 inline-flex w-full justify-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-base font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus:outline-none dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-600 sm:ml-3 sm:mt-0 sm:w-auto sm:text-sm"},e(s(a)("close")),1)])])])])):x("",!0)]}),_:1})],64))}};export{Ve as default};
