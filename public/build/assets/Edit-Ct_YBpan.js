import{r as V,u as j,c as a,a as m,b as o,h as ne,i as E,d as e,f as b,o as l,F as p,j as f,t as c,k as A,v as y,g as k,w as ue,e as w,x as I,l as ge,p as h,B as P,H as ce}from"./app-Bw40qWnz.js";import{_ as be}from"./AppLayout-DY_rKOab.js";import{_ as D,a as C}from"./InputError-Ds8nJv-q.js";import"./ApplicationLogo-oNrlBF6v.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DHpUyQjj.js";import"./useTranslations-BmhVlpgi.js";const me={class:"flex items-center justify-between"},ye={class:"flex items-center space-x-4"},ve={class:"text-xl font-semibold text-gray-900 dark:text-white"},xe={class:"flex items-center space-x-3"},pe=["disabled"],fe={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},ke={class:"lg:col-span-2 space-y-6"},we={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},he={class:"px-6 py-4"},qe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Ce=["value"],_e={class:"mt-4"},Me={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ve={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ae={key:0,class:"space-y-3"},ze={class:"grid grid-cols-1 gap-3"},Le={class:"flex flex-wrap gap-3 items-end"},Se={class:"w-20"},Be={class:"w-28"},Ue=["value"],Te={class:"w-28"},Fe={class:"w-28"},$e=["value"],je={key:1,class:"block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 text-sm"},Ee={class:"flex space-x-2"},Ie=["onClick","disabled"],De={key:1,class:"flex items-center justify-between"},He={key:0,class:"flex flex-col mr-3"},Re=["onClick","disabled"],Ne=["onClick","disabled"],Pe=["onClick"],Qe={class:"text-sm font-medium text-gray-900 dark:text-white"},Oe={key:0,class:"text-sm text-gray-500 dark:text-gray-400 whitespace-pre-line"},Ge={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},Je={class:"flex items-center space-x-2"},Ke={class:"text-sm font-medium text-gray-900 dark:text-white mr-2"},We=["onClick"],Xe=["onClick"],Ye={class:"space-y-3"},Ze={class:"grid grid-cols-1 gap-3"},et={class:"flex flex-wrap gap-3 items-end"},tt={class:"w-20"},rt={class:"w-28"},st=["value"],ot={class:"w-28"},at={class:"w-28"},lt=["value"],dt={key:1,class:"block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 text-sm"},it=["disabled"],nt={class:"space-y-6"},ut={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 sticky top-20"},gt={class:"px-6 py-4 space-y-3"},ct={class:"flex justify-between text-sm"},bt={class:"font-medium text-gray-900 dark:text-white"},mt={class:"flex justify-between text-sm"},yt={class:"font-medium text-gray-900 dark:text-white"},vt={class:"border-t border-gray-200 dark:border-gray-700 pt-3"},xt={class:"flex justify-between"},pt={class:"text-lg font-bold text-gray-900 dark:text-white"},ft={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50"},kt={class:"text-xs text-gray-500 dark:text-gray-400"},wt={key:0,class:"fixed inset-0 z-50 overflow-hidden"},ht={class:"flex items-center justify-center min-h-screen p-4"},qt={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Ct={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},_t={class:"flex items-center space-x-2"},Mt={class:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden"},Vt=["onClick","title"],At=["href"],zt=["disabled"],Lt={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},St={key:0,class:"flex items-center justify-center h-96"},Bt=["innerHTML"],Ut={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},Ht={__name:"Edit",props:{quote:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean},setup(n){var N;const g=n,S=g.isVatExempt?0:17,Q=s=>{if(!s)return"";const t=new Date(s);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]},q=V(!1),B=V(""),_=V(!1),z=V(null),L=V(((N=g.quote.client)==null?void 0:N.locale)||"fr"),O=[{value:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{value:"de",label:"Deutsch",flag:"üá©üá™"},{value:"en",label:"English",flag:"üá¨üáß"},{value:"lb",label:"L√´tzebuergesch",flag:"üá±üá∫"}],G=P(()=>`${route("quotes.pdf.stream",g.quote.id)}?locale=${L.value}`),i=j({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:S}),v=j({client_id:g.quote.client_id,valid_until:Q(g.quote.valid_until),notes:g.quote.notes||"",currency:g.quote.currency}),u=j({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:S}),U=P(()=>{let s=0,t=0;for(const x of g.quote.items||[])s+=parseFloat(x.total_ht)||0,t+=parseFloat(x.total_vat)||0;return{ht:s,vat:t,ttc:s+t}}),M=s=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:g.quote.currency||"EUR"}).format(s),T=()=>{v.put(route("quotes.update",g.quote.id),{preserveScroll:!0})},J=()=>{u.post(route("quotes.items.store",g.quote.id),{preserveScroll:!0,onSuccess:()=>{u.reset(),u.title="",u.description="",u.quantity=1,u.unit="hour",u.vat_rate=S}})},K=(s,t)=>{const x={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unit√©",plural:"unit√©s"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!s||!x[s]?"":t<=1?x[s].singular:x[s].plural},W=s=>{const t=parseFloat(s);return t===Math.floor(t)?Math.floor(t).toString():t.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},H=(s,t)=>{h.patch(route("quotes.items.move",[g.quote.id,s]),{direction:t},{preserveScroll:!0})},X=s=>{confirm("Supprimer cette ligne ?")&&h.delete(route("quotes.items.destroy",[g.quote.id,s]),{preserveScroll:!0})},R=s=>{z.value=s.id,i.title=s.title,i.description=s.description||"",i.quantity=parseFloat(s.quantity),i.unit=s.unit||"",i.unit_price=parseFloat(s.unit_price),i.vat_rate=parseFloat(s.vat_rate)},Y=()=>{z.value=null,i.reset()},Z=s=>{i.put(route("quotes.items.update",[g.quote.id,s]),{preserveScroll:!0,onSuccess:()=>{z.value=null,i.reset()}})},ee=()=>{confirm("Supprimer ce devis ?")&&h.delete(route("quotes.destroy",g.quote.id))},te=()=>{h.post(route("quotes.mark-sent",g.quote.id),{},{preserveScroll:!0})},re=()=>{h.post(route("quotes.mark-accepted",g.quote.id),{},{preserveScroll:!0})},se=()=>{h.post(route("quotes.mark-declined",g.quote.id),{},{preserveScroll:!0})},oe=()=>{confirm("Convertir ce devis en facture ? Une nouvelle facture brouillon sera cr√©√©e avec les m√™mes lignes.")&&h.post(route("quotes.convert",g.quote.id),{},{preserveScroll:!0})},F=async()=>{_.value=!0;try{const s=route("quotes.preview-html",g.quote.id)+`?locale=${L.value}`,t=await ce.get(s);B.value=t.data.html}catch(s){console.error("Error loading preview:",s),B.value=`<p style="color: red; padding: 20px;">Erreur lors du chargement de l'aper√ßu</p>`}finally{_.value=!1}},ae=s=>{L.value=s,q.value&&F()},le=()=>{q.value=!0,F()},de=s=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return t[s]||t.draft},ie=s=>({draft:"Brouillon",sent:"Envoy√©",accepted:"Accept√©",declined:"Refus√©",expired:"Expir√©",converted:"Converti"})[s]||s;return(s,t)=>(l(),a(p,null,[m(o(ne),{title:`Devis ${n.quote.reference}`},null,8,["title"]),m(be,null,{header:E(()=>[e("div",me,[e("div",ye,[m(o(ge),{href:s.route("quotes.index"),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},{default:E(()=>[...t[18]||(t[18]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",ve," Devis "+c(n.quote.reference),1),e("span",{class:I([de(n.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},c(ie(n.quote.status)),3)]),e("div",xe,[e("button",{type:"button",onClick:le,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[...t[19]||(t[19]=[e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1),w(" Aper√ßu ",-1)])]),e("button",{type:"button",onClick:ee,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"}," Supprimer "),n.quote.status==="draft"?(l(),a("button",{key:0,type:"button",onClick:te,disabled:!n.quote.items||n.quote.items.length===0,class:"inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Marquer envoy√© ",8,pe)):k("",!0),n.quote.status==="sent"?(l(),a("button",{key:1,type:"button",onClick:re,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"},[...t[20]||(t[20]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1),w(" Accepter ",-1)])])):k("",!0),n.quote.status==="sent"?(l(),a("button",{key:2,type:"button",onClick:se,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"},[...t[21]||(t[21]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1),w(" Refuser ",-1)])])):k("",!0),n.quote.status==="accepted"?(l(),a("button",{key:3,type:"button",onClick:oe,class:"inline-flex items-center rounded-md bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500"},[...t[22]||(t[22]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M1 4a1 1 0 011-1h16a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4zm12 4a3 3 0 11-6 0 3 3 0 016 0zM4 9a1 1 0 100-2 1 1 0 000 2zm13-1a1 1 0 11-2 0 1 1 0 012 0zM1.75 14.5a.75.75 0 000 1.5c4.417 0 8.693.603 12.749 1.73 1.111.309 2.251-.512 2.251-1.696v-.784a.75.75 0 00-1.5 0v.784a.272.272 0 01-.35.25A49.043 49.043 0 001.75 14.5z","clip-rule":"evenodd"})],-1),w(" Convertir en facture ",-1)])])):k("",!0)])])]),default:E(()=>{var x;return[e("div",fe,[e("div",ke,[e("div",we,[t[23]||(t[23]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Informations")],-1)),e("div",he,[e("div",qe,[e("div",null,[m(D,{for:"client_id",value:"Client"}),b(e("select",{id:"client_id","onUpdate:modelValue":t[0]||(t[0]=r=>o(v).client_id=r),onChange:T,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[(l(!0),a(p,null,f(n.clients,r=>(l(),a("option",{key:r.id,value:r.id},c(r.name),9,Ce))),128))],544),[[A,o(v).client_id]]),m(C,{message:o(v).errors.client_id,class:"mt-2"},null,8,["message"])]),e("div",null,[m(D,{for:"valid_until",value:"Valide jusqu'au"}),b(e("input",{id:"valid_until","onUpdate:modelValue":t[1]||(t[1]=r=>o(v).valid_until=r),onChange:T,type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,544),[[y,o(v).valid_until]]),m(C,{message:o(v).errors.valid_until,class:"mt-2"},null,8,["message"])])]),e("div",_e,[m(D,{for:"notes",value:"Notes / Conditions"}),b(e("textarea",{id:"notes","onUpdate:modelValue":t[2]||(t[2]=r=>o(v).notes=r),onBlur:T,rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Conditions particuli√®res..."},null,544),[[y,o(v).notes]])])])]),e("div",Me,[t[44]||(t[44]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Lignes du devis")],-1)),e("div",Ve,[(l(!0),a(p,null,f(n.quote.items,(r,$)=>(l(),a("div",{key:r.id,class:"px-6 py-4"},[z.value===r.id?(l(),a("div",Ae,[e("div",ze,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Titre",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>o(i).title=d),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[y,o(i).title]]),m(C,{message:o(i).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Description (optionnel)",-1)),b(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=d=>o(i).description=d),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e"},null,512),[[y,o(i).description]]),m(C,{message:o(i).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Le,[e("div",Se,[t[26]||(t[26]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Quantit√©",-1)),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>o(i).quantity=d),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,o(i).quantity,void 0,{number:!0}]])]),e("div",Be,[t[28]||(t[28]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Unit√©",-1)),b(e("select",{"onUpdate:modelValue":t[6]||(t[6]=d=>o(i).unit=d),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[t[27]||(t[27]=e("option",{value:""},"Sans unit√©",-1)),(l(!0),a(p,null,f(n.units,d=>(l(),a("option",{key:d.value,value:d.value},c(d.label),9,Ue))),128))],512),[[A,o(i).unit]])]),e("div",Te,[t[29]||(t[29]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=d=>o(i).unit_price=d),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,o(i).unit_price,void 0,{number:!0}]])]),e("div",Fe,[t[30]||(t[30]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"TVA",-1)),n.isVatExempt?(l(),a("div",je," 0% ")):b((l(),a("select",{key:0,"onUpdate:modelValue":t[8]||(t[8]=d=>o(i).vat_rate=d),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(l(!0),a(p,null,f(n.vatRates,d=>(l(),a("option",{key:d.value,value:d.value},c(d.value)+"% ",9,$e))),128))],512)),[[A,o(i).vat_rate,void 0,{number:!0}]])]),e("div",Ee,[e("button",{type:"button",onClick:d=>Z(r.id),disabled:o(i).processing,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...t[31]||(t[31]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,Ie),e("button",{type:"button",onClick:Y,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...t[32]||(t[32]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(l(),a("div",De,[n.quote.items.length>1?(l(),a("div",He,[e("button",{type:"button",onClick:d=>H(r.id,"up"),disabled:$===0,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Monter"},[...t[33]||(t[33]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,Re),e("button",{type:"button",onClick:d=>H(r.id,"down"),disabled:$===n.quote.items.length-1,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Descendre"},[...t[34]||(t[34]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Ne)])):k("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:d=>R(r)},[e("p",Qe,c(r.title),1),r.description?(l(),a("p",Oe,c(r.description),1)):k("",!0),e("p",Ge,c(W(r.quantity))+" "+c(K(r.unit,r.quantity))+" x "+c(M(r.unit_price))+" (TVA "+c(r.vat_rate)+"%) ",1)],8,Pe),e("div",Je,[e("span",Ke,c(M(r.total_ht)),1),e("button",{type:"button",onClick:d=>R(r),class:"p-1 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400",title:"Modifier"},[...t[35]||(t[35]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,We),e("button",{type:"button",onClick:d=>X(r.id),class:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400",title:"Supprimer"},[...t[36]||(t[36]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,Xe)])]))]))),128)),e("form",{onSubmit:ue(J,["prevent"]),class:"px-6 py-4"},[t[43]||(t[43]=e("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"Ajouter une ligne",-1)),e("div",Ye,[e("div",Ze,[e("div",null,[b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=r=>o(u).title=r),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[y,o(u).title]]),m(C,{message:o(u).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[b(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=r=>o(u).description=r),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e (optionnel)"},null,512),[[y,o(u).description]]),m(C,{message:o(u).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",et,[e("div",tt,[t[37]||(t[37]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Quantit√©",-1)),b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=r=>o(u).quantity=r),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,o(u).quantity,void 0,{number:!0}]])]),e("div",rt,[t[39]||(t[39]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Unit√©",-1)),b(e("select",{"onUpdate:modelValue":t[12]||(t[12]=r=>o(u).unit=r),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[t[38]||(t[38]=e("option",{value:""},"Sans unit√©",-1)),(l(!0),a(p,null,f(n.units,r=>(l(),a("option",{key:r.value,value:r.value},c(r.label),9,st))),128))],512),[[A,o(u).unit]])]),e("div",ot,[t[40]||(t[40]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[13]||(t[13]=r=>o(u).unit_price=r),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,o(u).unit_price,void 0,{number:!0}]])]),e("div",at,[t[41]||(t[41]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"TVA",-1)),n.isVatExempt?(l(),a("div",dt," 0% ")):b((l(),a("select",{key:0,"onUpdate:modelValue":t[14]||(t[14]=r=>o(u).vat_rate=r),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(l(!0),a(p,null,f(n.vatRates,r=>(l(),a("option",{key:r.value,value:r.value},c(r.value)+"% ",9,lt))),128))],512)),[[A,o(u).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:o(u).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},[...t[42]||(t[42]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),w(" Ajouter ",-1)])],8,it)])])],32)])])]),e("div",nt,[e("div",ut,[t[48]||(t[48]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"R√©sum√©")],-1)),e("div",gt,[e("div",ct,[t[45]||(t[45]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Total HT",-1)),e("span",bt,c(M(U.value.ht)),1)]),e("div",mt,[t[46]||(t[46]=e("span",{class:"text-gray-500 dark:text-gray-400"},"TVA",-1)),e("span",yt,c(M(U.value.vat)),1)]),e("div",vt,[e("div",xt,[t[47]||(t[47]=e("span",{class:"text-base font-medium text-gray-900 dark:text-white"},"Total TTC",-1)),e("span",pt,c(M(U.value.ttc)),1)])])]),e("div",ft,[e("p",kt,c(((x=n.quote.items)==null?void 0:x.length)||0)+" ligne(s) ",1)])])])]),q.value?(l(),a("div",wt,[e("div",ht,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[15]||(t[15]=r=>q.value=!1)}),e("div",qt,[e("div",Ct,[t[53]||(t[53]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Aper√ßu du devis ",-1)),e("div",_t,[e("div",Mt,[(l(),a(p,null,f(O,r=>e("button",{key:r.value,type:"button",onClick:$=>ae(r.value),title:r.label,class:I(["px-2 py-1.5 text-base transition-colors",L.value===r.value?"bg-indigo-100 dark:bg-indigo-900":"bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},c(r.flag),11,Vt)),64))]),e("a",{href:G.value,target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...t[49]||(t[49]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),w(" PDF ",-1)])],8,At),e("button",{type:"button",onClick:F,disabled:_.value,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 disabled:opacity-50"},[(l(),a("svg",{class:I(["h-4 w-4 mr-1",{"animate-spin":_.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...t[50]||(t[50]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),t[51]||(t[51]=w(" Actualiser ",-1))],8,zt),e("button",{type:"button",onClick:t[16]||(t[16]=r=>q.value=!1),class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...t[52]||(t[52]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Lt,[_.value?(l(),a("div",St,[...t[54]||(t[54]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(l(),a("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:B.value},null,8,Bt))]),e("div",Ut,[e("button",{type:"button",onClick:t[17]||(t[17]=r=>q.value=!1),class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"}," Fermer ")])])])])):k("",!0)]}),_:1})],64))}};export{Ht as default};
