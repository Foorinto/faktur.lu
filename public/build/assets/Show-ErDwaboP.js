import{_ as U}from"./AppLayout-FFQD-yXd.js";import{r as v,c as d,a as _,b as r,h as R,i as f,d as t,t as e,o as l,g as c,e as g,l as z,F as w,j as B,x as j,B as F,p as q,H as I}from"./app-BIJCKN2g.js";import{u as O}from"./useTranslations-ti9iItLu.js";import"./ApplicationLogo-B-F8Zccb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-AHxS1BRo.js";const G={class:"flex items-center justify-between"},J={class:"flex items-center space-x-4"},K={class:"text-xl font-semibold text-gray-900 dark:text-white"},Q={class:"flex items-center space-x-3"},W=["disabled"],X=["disabled"],Y=["disabled"],Z={class:"space-y-6"},tt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},et={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},st={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},at={class:"text-lg font-medium text-gray-900 dark:text-white"},rt={class:"px-6 py-4"},ot={key:0,class:"text-sm text-gray-700 dark:text-gray-300 space-y-1"},dt={class:"font-semibold"},lt={key:0},nt={key:1,class:"pt-2"},it={class:"text-gray-500"},ct={key:2},ut={class:"text-gray-500"},gt={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},ht={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},yt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},xt={class:"text-lg font-medium text-gray-900 dark:text-white"},mt={class:"px-6 py-4"},vt={key:0,class:"text-sm text-gray-700 dark:text-gray-300 space-y-1"},bt={class:"font-semibold"},_t={key:0},ft={key:1,class:"pt-2"},kt={class:"text-gray-500"},pt={key:1,class:"text-sm text-gray-700 dark:text-gray-300 space-y-1"},wt={class:"font-semibold"},qt={key:0},Ct={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Lt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Mt={class:"text-lg font-medium text-gray-900 dark:text-white"},zt={class:"px-6 py-4"},Bt={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},jt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ft={class:"mt-1 text-sm text-gray-900 dark:text-white"},$t={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},At={class:"mt-1 text-sm text-gray-900 dark:text-white"},Dt={key:0},Ht={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},St={class:"mt-1 text-sm text-gray-900 dark:text-white"},Vt={key:1},Pt={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Nt={class:"mt-1 text-sm text-gray-900 dark:text-white"},Tt={key:2},Et={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ut={class:"mt-1 text-sm text-gray-900 dark:text-white"},Rt={key:3},It={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ot={class:"mt-1 text-sm"},Gt={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Jt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Kt={class:"text-lg font-medium text-gray-900 dark:text-white"},Qt={class:"overflow-x-auto"},Wt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Xt={class:"bg-gray-50 dark:bg-gray-700"},Yt={class:"py-3.5 pl-6 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white"},Zt={class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"},te={class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"},ee={class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"},se={class:"py-3.5 pl-3 pr-6 text-right text-sm font-semibold text-gray-900 dark:text-white"},ae={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},re={class:"py-4 pl-6 pr-3 text-sm"},oe={class:"font-medium text-gray-900 dark:text-white"},de={key:0,class:"text-gray-500 dark:text-gray-400 whitespace-pre-line"},le={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},ne={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},ie={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-gray-500 dark:text-gray-400"},ce={class:"whitespace-nowrap py-4 pl-3 pr-6 text-right text-sm font-medium text-gray-900 dark:text-white"},ue={class:"bg-gray-50 dark:bg-gray-700"},ge={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400"},he={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-medium text-gray-900 dark:text-white"},ye={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-medium text-gray-500 dark:text-gray-400"},xe={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-medium text-gray-900 dark:text-white"},me={class:"border-t-2 border-gray-300 dark:border-gray-600"},ve={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-bold text-gray-900 dark:text-white"},be={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-bold text-gray-900 dark:text-white"},_e={key:0,class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},fe={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},ke={class:"text-lg font-medium text-gray-900 dark:text-white"},pe={class:"px-6 py-4"},we={class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},qe={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ce={class:"flex items-center justify-center min-h-screen p-4"},Le={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Me={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},ze={class:"text-lg font-medium text-gray-900 dark:text-white"},Be={class:"flex items-center space-x-2"},je={class:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden"},Fe=["onClick","title"],$e=["href"],Ae={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},De={key:0,class:"flex items-center justify-center h-96"},He=["innerHTML"],Se={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},Ie={__name:"Show",props:{quote:Object},setup(s){var L,M;const{t:a}=O(),h=s,u=v(!1),y=v(!1),k=v(""),p=v(!1),b=v(((L=h.quote.buyer_snapshot)==null?void 0:L.locale)||((M=h.quote.client)==null?void 0:M.locale)||"fr"),$=[{value:"fr",label:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{value:"de",label:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{value:"en",label:"English",flag:"ðŸ‡¬ðŸ‡§"},{value:"lb",label:"LÃ«tzebuergesch",flag:"ðŸ‡±ðŸ‡º"}],A=F(()=>`${route("quotes.pdf.stream",h.quote.id)}?locale=${b.value}`),C=async()=>{p.value=!0;try{const n=route("quotes.preview-html",h.quote.id)+`?locale=${b.value}`,o=await I.get(n);k.value=o.data.html}catch(n){console.error("Error loading preview:",n),k.value=`<p style="color: red; padding: 20px;">${a("error_loading_preview")}</p>`}finally{p.value=!1}},D=n=>{b.value=n,y.value&&C()},H=()=>{y.value=!0,C()},S=n=>{const o={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return o[n]||o.draft},V=F(()=>({draft:a("draft"),sent:a("sent"),accepted:a("accepted"),declined:a("rejected"),expired:a("expired"),converted:a("converted")})),P=n=>V.value[n]||n,x=(n,o="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:o}).format(n),m=n=>n?new Date(n).toLocaleDateString("fr-FR"):"-",N=()=>{u.value||(u.value=!0,q.post(route("quotes.mark-accepted",h.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))},T=()=>{u.value||(u.value=!0,q.post(route("quotes.mark-declined",h.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))},E=()=>{u.value||confirm(a("convert_quote_confirm"))&&(u.value=!0,q.post(route("quotes.convert",h.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))};return(n,o)=>(l(),d(w,null,[_(r(R),{title:`Devis ${s.quote.reference}`},null,8,["title"]),_(U,null,{header:f(()=>[t("div",G,[t("div",J,[_(r(z),{href:n.route("quotes.index"),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},{default:f(()=>[...o[3]||(o[3]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),t("h1",K,e(s.quote.reference),1),t("span",{class:j([S(s.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},e(P(s.quote.status)),3)]),t("div",Q,[t("button",{type:"button",onClick:H,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[o[4]||(o[4]=t("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),t("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),g(" "+e(r(a)("preview")),1)]),s.quote.status==="sent"?(l(),d("button",{key:0,onClick:N,disabled:u.value,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[o[5]||(o[5]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1)),g(" "+e(r(a)("accept")),1)],8,W)):c("",!0),s.quote.status==="sent"?(l(),d("button",{key:1,onClick:T,disabled:u.value,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"},[o[6]||(o[6]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1)),g(" "+e(r(a)("reject")),1)],8,X)):c("",!0),s.quote.status==="accepted"?(l(),d("button",{key:2,onClick:E,disabled:u.value,class:"inline-flex items-center rounded-md bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500 disabled:opacity-50"},[o[7]||(o[7]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"}),t("path",{d:"M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"})],-1)),g(" "+e(r(a)("convert_to_invoice")),1)],8,Y)):c("",!0)])])]),default:f(()=>[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("h2",at,e(r(a)("issuer")),1)]),t("div",rt,[s.quote.seller_snapshot?(l(),d("div",ot,[t("p",dt,e(s.quote.seller_snapshot.company_name),1),s.quote.seller_snapshot.legal_name?(l(),d("p",lt,e(s.quote.seller_snapshot.legal_name),1)):c("",!0),t("p",null,e(s.quote.seller_snapshot.address),1),t("p",null,e(s.quote.seller_snapshot.postal_code)+" "+e(s.quote.seller_snapshot.city),1),t("p",null,e(s.quote.seller_snapshot.country),1),s.quote.seller_snapshot.matricule?(l(),d("p",nt,[t("span",it,e(r(a)("matricule"))+":",1),g(" "+e(s.quote.seller_snapshot.matricule),1)])):c("",!0),s.quote.seller_snapshot.vat_number?(l(),d("p",ct,[t("span",ut,e(r(a)("vat_number_short"))+":",1),g(" "+e(s.quote.seller_snapshot.vat_number),1)])):c("",!0)])):(l(),d("div",gt,e(r(a)("seller_info_not_recorded")),1))])]),t("div",ht,[t("div",yt,[t("h2",xt,e(r(a)("client")),1)]),t("div",mt,[s.quote.buyer_snapshot?(l(),d("div",vt,[t("p",bt,e(s.quote.buyer_snapshot.company_name||s.quote.buyer_snapshot.name),1),s.quote.buyer_snapshot.contact_name?(l(),d("p",_t,e(s.quote.buyer_snapshot.contact_name),1)):c("",!0),t("p",null,e(s.quote.buyer_snapshot.address),1),t("p",null,e(s.quote.buyer_snapshot.postal_code)+" "+e(s.quote.buyer_snapshot.city),1),t("p",null,e(s.quote.buyer_snapshot.country),1),s.quote.buyer_snapshot.vat_number?(l(),d("p",ft,[t("span",kt,e(r(a)("vat_number_short"))+":",1),g(" "+e(s.quote.buyer_snapshot.vat_number),1)])):c("",!0)])):s.quote.client?(l(),d("div",pt,[t("p",wt,e(s.quote.client.name),1),s.quote.client.contact_name?(l(),d("p",qt,e(s.quote.client.contact_name),1)):c("",!0),t("p",null,e(s.quote.client.address),1),t("p",null,e(s.quote.client.postal_code)+" "+e(s.quote.client.city),1),t("p",null,e(s.quote.client.country),1)])):c("",!0)])])]),t("div",Ct,[t("div",Lt,[t("h2",Mt,e(r(a)("details")),1)]),t("div",zt,[t("dl",Bt,[t("div",null,[t("dt",jt,e(r(a)("created_at")),1),t("dd",Ft,e(m(s.quote.created_at)),1)]),t("div",null,[t("dt",$t,e(r(a)("valid_until")),1),t("dd",At,e(m(s.quote.valid_until)),1)]),s.quote.sent_at?(l(),d("div",Dt,[t("dt",Ht,e(r(a)("sent_on")),1),t("dd",St,e(m(s.quote.sent_at)),1)])):c("",!0),s.quote.accepted_at?(l(),d("div",Vt,[t("dt",Pt,e(r(a)("accepted_on")),1),t("dd",Nt,e(m(s.quote.accepted_at)),1)])):c("",!0),s.quote.declined_at?(l(),d("div",Tt,[t("dt",Et,e(r(a)("rejected_on")),1),t("dd",Ut,e(m(s.quote.declined_at)),1)])):c("",!0),s.quote.converted_to_invoice_id?(l(),d("div",Rt,[t("dt",It,e(r(a)("converted_to_invoice")),1),t("dd",Ot,[_(r(z),{href:n.route("invoices.show",s.quote.converted_to_invoice_id),class:"text-indigo-600 hover:text-indigo-500 dark:text-indigo-400"},{default:f(()=>[g(e(r(a)("see_invoice")),1)]),_:1},8,["href"])])])):c("",!0)])])]),t("div",Gt,[t("div",Jt,[t("h2",Kt,e(r(a)("quote_lines")),1)]),t("div",Qt,[t("table",Wt,[t("thead",Xt,[t("tr",null,[t("th",Yt,e(r(a)("description")),1),t("th",Zt,e(r(a)("qty")),1),t("th",te,e(r(a)("price_ht")),1),t("th",ee,e(r(a)("vat")),1),t("th",se,e(r(a)("total_ht")),1)])]),t("tbody",ae,[(l(!0),d(w,null,B(s.quote.items,i=>(l(),d("tr",{key:i.id},[t("td",re,[t("div",oe,e(i.title),1),i.description?(l(),d("div",de,e(i.description),1)):c("",!0)]),t("td",le,e(i.quantity),1),t("td",ne,e(x(i.unit_price,s.quote.currency)),1),t("td",ie,e(i.vat_rate)+"% ",1),t("td",ce,e(x(i.total_ht,s.quote.currency)),1)]))),128))]),t("tfoot",ue,[t("tr",null,[t("td",ge,e(r(a)("total_ht")),1),t("td",he,e(x(s.quote.total_ht,s.quote.currency)),1)]),t("tr",null,[t("td",ye,e(r(a)("total_vat")),1),t("td",xe,e(x(s.quote.total_vat,s.quote.currency)),1)]),t("tr",me,[t("td",ve,e(r(a)("total_ttc")),1),t("td",be,e(x(s.quote.total_ttc,s.quote.currency)),1)])])])])]),s.quote.notes?(l(),d("div",_e,[t("div",fe,[t("h2",ke,e(r(a)("notes")),1)]),t("div",pe,[t("p",we,e(s.quote.notes),1)])])):c("",!0)]),y.value?(l(),d("div",qe,[t("div",Ce,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:o[0]||(o[0]=i=>y.value=!1)}),t("div",Le,[t("div",Me,[t("h3",ze,e(s.quote.reference),1),t("div",Be,[t("div",je,[(l(),d(w,null,B($,i=>t("button",{key:i.value,type:"button",onClick:Ve=>D(i.value),title:i.label,class:j(["px-2 py-1.5 text-base transition-colors",b.value===i.value?"bg-indigo-100 dark:bg-indigo-900":"bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},e(i.flag),11,Fe)),64))]),t("a",{href:A.value,target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...o[8]||(o[8]=[t("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),t("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),g(" PDF ",-1)])],8,$e),t("button",{type:"button",onClick:o[1]||(o[1]=i=>y.value=!1),class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...o[9]||(o[9]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",Ae,[p.value?(l(),d("div",De,[...o[10]||(o[10]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(l(),d("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:k.value},null,8,He))]),t("div",Se,[t("button",{type:"button",onClick:o[2]||(o[2]=i=>y.value=!1),class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"},e(r(a)("close")),1)])])])])):c("",!0)]),_:1})],64))}};export{Ie as default};
