import{u as M,y as N,c as u,a as n,b as t,h as S,i as b,d as e,w as z,f as p,t as m,o as c,F as k,j as g,k as C,v as f,g as $,e as U,l as R,r as D,B as A}from"./app-WPm1OF2O.js";import{_ as T}from"./AppLayout-BTmNPb5-.js";import{_ as y}from"./InputError-CsMzV-Dp.js";import{_}from"./InputLabel-FNZ_SNkA.js";import{_ as j}from"./PrimaryButton-CN5TWnQp.js";import{u as H}from"./useTranslations-1apgeaO4.js";import"./DropdownLink-BLl5iJ8c.js";const L={class:"flex items-center space-x-4"},G={class:"text-xl font-semibold text-slate-900 dark:text-white"},J={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},K={class:"px-6 py-4"},O={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},P={value:""},Q=["value"],W={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},X={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Y={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Z={class:"text-lg font-medium text-slate-900 dark:text-white"},ee={class:"px-6 py-4"},te={class:"space-y-4"},ae={class:"space-y-3"},se={class:"flex-1"},le=["id","onUpdate:modelValue","placeholder"],re={class:"flex-1"},oe=["id","onUpdate:modelValue","placeholder"],de={class:"flex flex-wrap gap-4 items-end"},ie={class:"w-24"},ne=["id","onUpdate:modelValue"],ue={class:"w-32"},ce=["id","onUpdate:modelValue"],me=["value"],_e={class:"w-32"},pe=["id","onUpdate:modelValue"],ve={class:"w-32"},fe=["id","value","onChange"],he=["value"],be={key:1,class:"mt-1 block w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-slate-500 dark:border-slate-600 dark:bg-slate-600 dark:text-slate-400"},ke={key:0,class:"w-24"},xe=["id","value","onInput"],ge=["onClick"],we={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},ye={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Ve={class:"text-lg font-medium text-slate-900 dark:text-white"},qe={class:"px-6 py-4"},Ce=["placeholder"],$e={class:"flex justify-end space-x-3"},Ue={key:0},Re={key:1},Se={__name:"Create",props:{clients:Array,vatRates:Array,units:Array,defaultClientId:[String,Number],isVatExempt:Boolean,defaultVatRate:{type:Number,default:17}},setup(v){const{t:i}=H(),h=v,w=A(()=>{var r;return(r=h.clients)==null?void 0:r.find(a=>a.id===l.client_id)}),V=A(()=>{var r,a;return h.isVatExempt?0:((r=w.value)==null?void 0:r.default_vat_rate)!==null&&((a=w.value)==null?void 0:a.default_vat_rate)!==void 0?parseFloat(w.value.default_vat_rate):h.defaultVatRate}),l=M({client_id:h.defaultClientId||"",valid_until:"",notes:"",currency:"EUR",items:[]}),x=D({}),q=()=>{const r=l.items.length;l.items.push({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:V.value,vat_rate_select:V.value}),x.value[r]=""},B=(r,a)=>{a==="custom"?(l.items[r].vat_rate_select="custom",l.items[r].vat_rate=x.value[r]||0):(l.items[r].vat_rate_select=a,l.items[r].vat_rate=a)},E=(r,a)=>{x.value[r]=a,l.items[r].vat_rate_select==="custom"&&(l.items[r].vat_rate=parseFloat(a)||0)};N(()=>l.client_id,r=>{if(r){const a=h.clients.find(s=>s.id===r);(a==null?void 0:a.default_vat_rate)!==null&&(a==null?void 0:a.default_vat_rate)!==void 0&&l.items.forEach(s=>{if(s.vat_rate_select!=="custom"){const d=parseFloat(a.default_vat_rate);s.vat_rate=d,s.vat_rate_select=d}})}});const F=r=>{l.items.splice(r,1)},I=()=>{l.post(route("quotes.store"))};return l.items.length===0&&q(),(r,a)=>(c(),u(k,null,[n(t(S),{title:t(i)("new_quote")},null,8,["title"]),n(T,null,{header:b(()=>[e("div",L,[n(t(R),{href:r.route("quotes.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:b(()=>[...a[3]||(a[3]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",G,m(t(i)("new_quote")),1)])]),default:b(()=>[e("form",{onSubmit:z(I,["prevent"]),class:"space-y-6"},[e("div",J,[a[4]||(a[4]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Client")],-1)),e("div",K,[e("div",O,[e("div",null,[n(_,{for:"client_id",value:"Client"}),p(e("select",{id:"client_id","onUpdate:modelValue":a[0]||(a[0]=s=>t(l).client_id=s),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[e("option",P,m(t(i)("select_client")),1),(c(!0),u(k,null,g(v.clients,s=>(c(),u("option",{key:s.id,value:s.id},m(s.name),9,Q))),128))],512),[[C,t(l).client_id]]),n(y,{message:t(l).errors.client_id,class:"mt-2"},null,8,["message"])]),e("div",null,[n(_,{for:"valid_until",value:t(i)("valid_until_optional")},null,8,["value"]),p(e("input",{id:"valid_until","onUpdate:modelValue":a[1]||(a[1]=s=>t(l).valid_until=s),type:"date",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[f,t(l).valid_until]]),e("p",W,m(t(i)("default_30_days")),1),n(y,{message:t(l).errors.valid_until,class:"mt-2"},null,8,["message"])])])])]),e("div",X,[e("div",Y,[e("h2",Z,m(t(i)("quote_lines")),1)]),e("div",ee,[e("div",te,[(c(!0),u(k,null,g(t(l).items,(s,d)=>(c(),u("div",{key:d,class:"p-4 rounded-2xl border border-slate-200 dark:border-slate-700"},[e("div",ae,[e("div",se,[n(_,{for:`item-${d}-title`,value:t(i)("title")},null,8,["for","value"]),p(e("input",{id:`item-${d}-title`,"onUpdate:modelValue":o=>s.title=o,type:"text",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(i)("service_title_placeholder"),required:""},null,8,le),[[f,s.title]])]),e("div",re,[n(_,{for:`item-${d}-description`,value:t(i)("description_optional")},null,8,["for","value"]),p(e("textarea",{id:`item-${d}-description`,"onUpdate:modelValue":o=>s.description=o,rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(i)("detailed_description_placeholder")},null,8,oe),[[f,s.description]])]),e("div",de,[e("div",ie,[n(_,{for:`item-${d}-quantity`,value:t(i)("qty")},null,8,["for","value"]),p(e("input",{id:`item-${d}-quantity`,"onUpdate:modelValue":o=>s.quantity=o,type:"number",step:"0.01",min:"0.01",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,ne),[[f,s.quantity,void 0,{number:!0}]])]),e("div",ue,[n(_,{for:`item-${d}-unit`,value:t(i)("unit")},null,8,["for","value"]),p(e("select",{id:`item-${d}-unit`,"onUpdate:modelValue":o=>s.unit=o,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[a[5]||(a[5]=e("option",{value:""},"-",-1)),(c(!0),u(k,null,g(v.units,o=>(c(),u("option",{key:o.value,value:o.value},m(o.label),9,me))),128))],8,ce),[[C,s.unit]])]),e("div",_e,[n(_,{for:`item-${d}-unit_price`,value:t(i)("price_ht")},null,8,["for","value"]),p(e("input",{id:`item-${d}-unit_price`,"onUpdate:modelValue":o=>s.unit_price=o,type:"number",step:"0.01",min:"0",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,pe),[[f,s.unit_price,void 0,{number:!0}]])]),e("div",ve,[n(_,{for:`item-${d}-vat_rate`,value:t(i)("vat")},null,8,["for","value"]),v.isVatExempt?(c(),u("div",be,m(t(i)("vat_rates.exempt")),1)):(c(),u("select",{key:0,id:`item-${d}-vat_rate`,value:s.vat_rate_select??s.vat_rate,onChange:o=>B(d,o.target.value==="custom"?"custom":parseFloat(o.target.value)),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(c(!0),u(k,null,g(v.vatRates,o=>(c(),u("option",{key:o.value,value:o.value},m(o.label),9,he))),128))],40,fe))]),s.vat_rate_select==="custom"&&!v.isVatExempt?(c(),u("div",ke,[n(_,{for:`item-${d}-custom_vat_rate`,value:"%"},null,8,["for"]),e("input",{id:`item-${d}-custom_vat_rate`,type:"number",step:"0.01",min:"0",max:"100",value:x.value[d],onInput:o=>E(d,o.target.value),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Ex: 12"},null,40,xe)])):$("",!0),t(l).items.length>1?(c(),u("button",{key:1,type:"button",onClick:o=>F(d),class:"p-2 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"},[...a[6]||(a[6]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,ge)):$("",!0)])])]))),128)),e("button",{type:"button",onClick:q,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[a[7]||(a[7]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),U(" "+m(t(i)("add_line")),1)])])])]),e("div",we,[e("div",ye,[e("h2",Ve,m(t(i)("notes_optional")),1)]),e("div",qe,[p(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=s=>t(l).notes=s),rows:"3",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(i)("special_conditions")},null,8,Ce),[[f,t(l).notes]]),n(y,{message:t(l).errors.notes,class:"mt-2"},null,8,["message"])])]),e("div",$e,[n(t(R),{href:r.route("quotes.index"),class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},{default:b(()=>[U(m(t(i)("cancel")),1)]),_:1},8,["href"]),n(j,{disabled:t(l).processing},{default:b(()=>[t(l).processing?(c(),u("span",Ue,m(t(i)("creating")),1)):(c(),u("span",Re,m(t(i)("create_quote")),1))]),_:1},8,["disabled"])])],32)]),_:1})],64))}};export{Se as default};
