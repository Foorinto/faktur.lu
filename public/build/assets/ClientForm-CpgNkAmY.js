import{r as $,y as S,c as n,d as t,t as d,b as o,F as y,j as k,x as _,f as g,J as z,a as r,g as h,v as T,k as w,i as L,e as B,o as u,l as D,w as O,B as p,I as H}from"./app-BXBDbs8N.js";import{_ as m}from"./InputError-C3QYgL8_.js";import{_ as c}from"./InputLabel-Cdd5Urqi.js";import{_ as G}from"./PrimaryButton-DYVYQpEz.js";import{_ as v}from"./TextInput-BLkdnlQP.js";import{_ as K}from"./VatScenarioIndicator-VnaMaMt-.js";import{u as J}from"./useTranslations-ByQu4tzF.js";const W={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},X={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Y={class:"text-lg font-medium text-slate-900 dark:text-white"},Z={class:"px-6 py-4"},Q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ee=["value"],te={class:"ml-3"},le={class:"block text-sm font-medium text-slate-900 dark:text-white"},ae={class:"block text-sm text-slate-500 dark:text-slate-400"},se={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},re={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},oe={class:"text-lg font-medium text-slate-900 dark:text-white"},de={class:"px-6 py-4 space-y-4"},ne={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ue={key:0},ie={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},me=["value"],ce={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},fe={key:0,class:"text-amber-600 text-xs font-medium"},ve={key:1,class:"text-slate-400 text-xs"},be={key:2,class:"text-slate-400 text-xs"},ge={class:"flex items-center justify-between"},pe={class:"text-sm font-medium text-slate-900 dark:text-white"},xe={class:"text-right"},ye={class:"text-xs text-slate-500 dark:text-slate-400"},ke={key:0,class:"mt-3 text-sm text-amber-600 dark:text-amber-400"},he={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},_e={key:1,class:"border-t border-slate-200 dark:border-slate-700 pt-4 mt-4"},we={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Ve=["value"],Ue={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},Re={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Le={class:"text-lg font-medium text-slate-900 dark:text-white"},Be={class:"px-6 py-4 space-y-4"},Se={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Ee=["value"],Ce=["value"],Ae={class:"mt-1 text-sm text-slate-500 dark:text-slate-400"},$e={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Te={class:"text-slate-400 text-xs"},qe=["value"],Fe={key:0},Ie=["placeholder"],Ne={class:"mt-1 text-sm text-slate-500 dark:text-slate-400"},Pe={class:"flex justify-end space-x-3"},Me={key:0},je={key:1},We={__name:"ClientForm",props:{form:{type:Object,required:!0},clientTypes:{type:Array,required:!0},currencies:{type:Array,required:!0},countries:{type:Array,required:!0},peppolSchemes:{type:Array,default:()=>[]},vatRates:{type:Array,default:()=>[]},isVatExempt:{type:Boolean,default:!0},submitLabel:{type:String,default:null},cancelRoute:{type:String,default:"clients.index"},cancelRouteParams:{type:[Object,Number,String],default:null},sellerVatRegime:{type:String,default:"franchise"}},emits:["submit"],setup(e,{emit:q}){const{t:s}=J(),F=H(),i=e,I=q,b=p(()=>i.form.type==="b2b"),x=$(i.form.default_vat_rate!==null&&i.form.default_vat_rate!==void 0&&i.form.default_vat_rate!==""?i.vatRates.some(f=>f.value===parseFloat(i.form.default_vat_rate))?parseFloat(i.form.default_vat_rate):"custom":""),V=$(x.value==="custom"?i.form.default_vat_rate:"");S(x,f=>{f===""?i.form.default_vat_rate=null:f==="custom"?i.form.default_vat_rate=V.value||null:i.form.default_vat_rate=f}),S(V,f=>{x.value==="custom"&&(i.form.default_vat_rate=f!==""?parseFloat(f):null)});const E=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK"],N=p(()=>E.includes(i.form.country_code)),P=p(()=>i.form.country_code==="LU"),C=p(()=>N.value&&!P.value),A=p(()=>i.form.vat_number&&i.form.vat_number.trim()!==""),U=p(()=>{if(i.sellerVatRegime==="franchise")return{key:"FRANCHISE",label:s("vat_scenario_franchise"),description:s("vat_scenario_franchise_desc"),rate:0,mention:"franchise",color:"gray"};const f=i.form.country_code||"LU",a=i.form.type||"b2b";return f==="LU"?{key:a==="b2b"?"B2B_LU":"B2C_LU",label:s(a==="b2b"?"vat_scenario_b2b_lu":"vat_scenario_b2c_lu"),description:s("vat_scenario_lu_desc"),rate:17,mention:null,color:"green"}:E.includes(f)?a==="b2b"&&A.value?{key:"B2B_INTRA_EU",label:s("vat_scenario_b2b_intra"),description:s("vat_scenario_b2b_intra_desc"),rate:0,mention:"reverse_charge",color:"blue"}:{key:a==="b2b"?"B2B_LU":"B2C_LU",label:s(a==="b2b"?"vat_scenario_b2b_eu_no_vat":"vat_scenario_b2c_eu"),description:s("vat_scenario_eu_desc"),rate:17,mention:null,color:"yellow"}:{key:"EXPORT",label:s("vat_scenario_export"),description:s("vat_scenario_export_desc"),rate:0,mention:"export",color:"purple"}}),M=p(()=>b.value&&C.value&&!A.value);S(()=>i.form.type,f=>{f==="b2c"&&(i.form.vat_number="")});const j=()=>{I("submit")};return(f,a)=>(u(),n("form",{onSubmit:O(j,["prevent"]),class:"space-y-8"},[t("div",W,[t("div",X,[t("h2",Y,d(o(s)("client_type")),1)]),t("div",Z,[t("div",Q,[(u(!0),n(y,null,k(e.clientTypes,l=>(u(),n("label",{key:l.value,class:_(["flex items-start p-4 rounded-xl border cursor-pointer transition-colors",[e.form.type===l.value?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-slate-200 dark:border-slate-600 hover:border-slate-300 dark:hover:border-slate-500"]])},[g(t("input",{type:"radio","onUpdate:modelValue":a[0]||(a[0]=R=>e.form.type=R),value:l.value,class:"mt-0.5 h-4 w-4 border-slate-300 text-primary-500 focus:ring-primary-500"},null,8,ee),[[z,e.form.type]]),t("div",te,[t("span",le,d(l.label),1),t("span",ae,d(l.description),1)])],2))),128))]),r(m,{message:e.form.errors.type,class:"mt-2"},null,8,["message"])])]),t("div",se,[t("div",re,[t("h2",oe,d(o(s)("client_info")),1)]),t("div",de,[t("div",ne,[t("div",null,[r(c,{for:"name",value:b.value?o(s)("company_name"):o(s)("full_name")},null,8,["value"]),r(v,{id:"name",modelValue:e.form.name,"onUpdate:modelValue":a[1]||(a[1]=l=>e.form.name=l),type:"text",class:"mt-1 block w-full",required:"",placeholder:b.value?"Société Exemple SARL":"Marie Durand"},null,8,["modelValue","placeholder"]),r(m,{message:e.form.errors.name,class:"mt-2"},null,8,["message"])]),b.value?(u(),n("div",ue,[r(c,{for:"contact_name",value:`${o(s)("director_contact")} (${o(s)("optional")})`},null,8,["value"]),r(v,{id:"contact_name",modelValue:e.form.contact_name,"onUpdate:modelValue":a[2]||(a[2]=l=>e.form.contact_name=l),type:"text",class:"mt-1 block w-full",placeholder:"Pierre Exemple"},null,8,["modelValue"]),r(m,{message:e.form.errors.contact_name,class:"mt-2"},null,8,["message"])])):h("",!0),t("div",null,[r(c,{for:"email",value:o(s)("email")},null,8,["value"]),r(v,{id:"email",modelValue:e.form.email,"onUpdate:modelValue":a[3]||(a[3]=l=>e.form.email=l),type:"email",class:"mt-1 block w-full",required:"",placeholder:"contact@example.com"},null,8,["modelValue"]),r(m,{message:e.form.errors.email,class:"mt-2"},null,8,["message"])])]),t("div",null,[r(c,{for:"address",value:o(s)("address")},null,8,["value"]),g(t("textarea",{id:"address","onUpdate:modelValue":a[4]||(a[4]=l=>e.form.address=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",rows:"2",placeholder:"10 Rue Fictive"},null,512),[[T,e.form.address]]),r(m,{message:e.form.errors.address,class:"mt-2"},null,8,["message"])]),t("div",ie,[t("div",null,[r(c,{for:"postal_code",value:o(s)("postal_code")},null,8,["value"]),r(v,{id:"postal_code",modelValue:e.form.postal_code,"onUpdate:modelValue":a[5]||(a[5]=l=>e.form.postal_code=l),type:"text",class:"mt-1 block w-full",placeholder:"L-2000"},null,8,["modelValue"]),r(m,{message:e.form.errors.postal_code,class:"mt-2"},null,8,["message"])]),t("div",null,[r(c,{for:"city",value:o(s)("city")},null,8,["value"]),r(v,{id:"city",modelValue:e.form.city,"onUpdate:modelValue":a[6]||(a[6]=l=>e.form.city=l),type:"text",class:"mt-1 block w-full",placeholder:"Luxembourg"},null,8,["modelValue"]),r(m,{message:e.form.errors.city,class:"mt-2"},null,8,["message"])]),t("div",null,[r(c,{for:"country_code",value:o(s)("country")},null,8,["value"]),g(t("select",{id:"country_code","onUpdate:modelValue":a[7]||(a[7]=l=>e.form.country_code=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(u(!0),n(y,null,k(e.countries,l=>(u(),n("option",{key:l.code,value:l.code},d(l.name),9,me))),128))],512),[[w,e.form.country_code]]),r(m,{message:e.form.errors.country_code,class:"mt-2"},null,8,["message"])])]),t("div",ce,[t("div",null,[r(c,{for:"phone",value:`${o(s)("phone")} (${o(s)("optional")})`},null,8,["value"]),r(v,{id:"phone",modelValue:e.form.phone,"onUpdate:modelValue":a[8]||(a[8]=l=>e.form.phone=l),type:"tel",class:"mt-1 block w-full",placeholder:"+352 000 000 000"},null,8,["modelValue"]),r(m,{message:e.form.errors.phone,class:"mt-2"},null,8,["message"])]),t("div",null,[r(c,{for:"vat_number"},{default:L(()=>[B(d(o(s)("vat_number"))+" ",1),b.value&&C.value?(u(),n("span",fe,"("+d(o(s)("vat_required_for_reverse_charge"))+")",1)):b.value?(u(),n("span",ve,"("+d(o(s)("vat_recommended_b2b"))+")",1)):(u(),n("span",be,"("+d(o(s)("optional"))+")",1))]),_:1}),r(v,{id:"vat_number",modelValue:e.form.vat_number,"onUpdate:modelValue":a[9]||(a[9]=l=>e.form.vat_number=l),type:"text",class:_(["mt-1 block w-full font-mono uppercase",{"bg-slate-100 dark:bg-slate-600":!b.value}]),placeholder:"LU00000000"},null,8,["modelValue","class"]),r(m,{message:e.form.errors.vat_number,class:"mt-2"},null,8,["message"])])]),t("div",{class:_(["rounded-xl border p-4",[U.value.rate===0?"border-sky-200 bg-sky-50 dark:border-sky-800 dark:bg-sky-900/20":"border-slate-200 bg-slate-50 dark:border-slate-700 dark:bg-slate-800"]])},[t("div",ge,[t("div",null,[t("h4",pe,d(o(s)("vat_scenario_detected")),1),r(K,{scenario:U.value,size:"sm",class:"mt-2"},null,8,["scenario"])]),t("div",xe,[t("span",{class:_(["text-2xl font-bold",[U.value.rate===0?"text-sky-600 dark:text-sky-400":"text-slate-900 dark:text-white"]])},d(U.value.rate)+"% ",3),t("p",ye,d(o(s)("vat_rate")),1)])]),M.value?(u(),n("p",ke,[a[18]||(a[18]=t("svg",{class:"inline h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),B(" "+d(o(s)("vat_warning_no_number")),1)])):h("",!0)],2),b.value?(u(),n("div",he,[t("div",null,[r(c,{for:"registration_number",value:`${o(s)("registration_number")} (${o(s)("optional")})`},null,8,["value"]),r(v,{id:"registration_number",modelValue:e.form.registration_number,"onUpdate:modelValue":a[10]||(a[10]=l=>e.form.registration_number=l),type:"text",class:"mt-1 block w-full font-mono",placeholder:"B000000"},null,8,["modelValue"]),r(m,{message:e.form.errors.registration_number,class:"mt-2"},null,8,["message"])])])):h("",!0),b.value&&e.peppolSchemes.length>0?(u(),n("div",_e,[a[20]||(a[20]=t("h3",{class:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3"}," Identifiant Peppol (optionnel) ",-1)),a[21]||(a[21]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400 mb-3"}," Nécessaire pour l'envoi de factures électroniques via le réseau Peppol. ",-1)),t("div",we,[t("div",null,[r(c,{for:"peppol_endpoint_scheme",value:"Schéma"}),g(t("select",{id:"peppol_endpoint_scheme","onUpdate:modelValue":a[11]||(a[11]=l=>e.form.peppol_endpoint_scheme=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[a[19]||(a[19]=t("option",{value:""},"Aucun",-1)),(u(!0),n(y,null,k(e.peppolSchemes,l=>(u(),n("option",{key:l.value,value:l.value},d(l.label),9,Ve))),128))],512),[[w,e.form.peppol_endpoint_scheme]]),r(m,{message:e.form.errors.peppol_endpoint_scheme,class:"mt-2"},null,8,["message"])]),t("div",null,[r(c,{for:"peppol_endpoint_id",value:"Identifiant"}),r(v,{id:"peppol_endpoint_id",modelValue:e.form.peppol_endpoint_id,"onUpdate:modelValue":a[12]||(a[12]=l=>e.form.peppol_endpoint_id=l),type:"text",class:"mt-1 block w-full font-mono",placeholder:"12345678",disabled:!e.form.peppol_endpoint_scheme},null,8,["modelValue","disabled"]),r(m,{message:e.form.errors.peppol_endpoint_id,class:"mt-2"},null,8,["message"])])])])):h("",!0)])]),t("div",Ue,[t("div",Re,[t("h2",Le,d(o(s)("billing_settings")),1)]),t("div",Be,[t("div",Se,[t("div",null,[r(c,{for:"currency",value:o(s)("default_currency")},null,8,["value"]),g(t("select",{id:"currency","onUpdate:modelValue":a[13]||(a[13]=l=>e.form.currency=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(u(!0),n(y,null,k(e.currencies,l=>(u(),n("option",{key:l.value,value:l.value},d(l.label),9,Ee))),128))],512),[[w,e.form.currency]]),r(m,{message:e.form.errors.currency,class:"mt-2"},null,8,["message"])]),t("div",null,[r(c,{for:"locale",value:o(s)("document_language")},null,8,["value"]),g(t("select",{id:"locale","onUpdate:modelValue":a[14]||(a[14]=l=>e.form.locale=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(u(!0),n(y,null,k(o(F).props.availableLocales,(l,R)=>(u(),n("option",{key:R,value:R},d(l),9,Ce))),128))],512),[[w,e.form.locale]]),t("p",Ae,d(o(s)("document_language_help")),1),r(m,{message:e.form.errors.locale,class:"mt-2"},null,8,["message"])])]),!e.isVatExempt&&e.vatRates.length>0?(u(),n("div",$e,[t("div",null,[r(c,{for:"default_vat_rate"},{default:L(()=>[B(d(o(s)("default_vat_rate")||"Taux de TVA par défaut")+" ",1),t("span",Te,"("+d(o(s)("optional"))+")",1)]),_:1}),g(t("select",{id:"default_vat_rate","onUpdate:modelValue":a[15]||(a[15]=l=>x.value=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[a[22]||(a[22]=t("option",{value:""},"Automatique (selon scénario TVA)",-1)),(u(!0),n(y,null,k(e.vatRates,l=>(u(),n("option",{key:l.value,value:l.value},d(l.label),9,qe))),128))],512),[[w,x.value]]),a[23]||(a[23]=t("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Ce taux sera utilisé par défaut pour les factures de ce client. ",-1)),r(m,{message:e.form.errors.default_vat_rate,class:"mt-2"},null,8,["message"])]),x.value==="custom"?(u(),n("div",Fe,[r(c,{for:"custom_vat_rate",value:"Taux personnalisé (%)"}),r(v,{id:"custom_vat_rate",modelValue:V.value,"onUpdate:modelValue":a[16]||(a[16]=l=>V.value=l),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full",placeholder:"Ex: 12.5"},null,8,["modelValue"])])):h("",!0)])):h("",!0),t("div",null,[r(c,{for:"notes",value:`${o(s)("internal_notes")} (${o(s)("optional")})`},null,8,["value"]),g(t("textarea",{id:"notes","onUpdate:modelValue":a[17]||(a[17]=l=>e.form.notes=l),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",rows:"3",placeholder:o(s)("internal_notes")},null,8,Ie),[[T,e.form.notes]]),t("p",Ne,d(o(s)("notes_not_visible")),1),r(m,{message:e.form.errors.notes,class:"mt-2"},null,8,["message"])])])]),t("div",Pe,[r(o(D),{href:e.cancelRouteParams?f.route(e.cancelRoute,e.cancelRouteParams):f.route(e.cancelRoute),class:"inline-flex items-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},{default:L(()=>[B(d(o(s)("cancel")),1)]),_:1},8,["href"]),r(G,{disabled:e.form.processing,class:_({"opacity-25":e.form.processing})},{default:L(()=>[e.form.processing?(u(),n("span",Me,d(o(s)("saving")),1)):(u(),n("span",je,d(e.submitLabel||o(s)("save")),1))]),_:1},8,["disabled","class"])])],32))}};export{We as _};
