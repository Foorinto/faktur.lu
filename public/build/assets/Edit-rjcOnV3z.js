import{e as T,c as a,a as m,u as s,h as re,w as j,b as e,q as b,o as d,F as p,r as h,t as c,v as V,B as y,d as k,f as se,g as f,n as D,s as oe,k as z,j as w,A as ae,H as de}from"./app-BNdkYu5R.js";import{_ as le}from"./AppLayout-CQ5EpIy-.js";import{_ as F,a as q}from"./InputError-j9SVREoo.js";import"./ApplicationLogo-Btd2wIUd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-7-ZIUky-.js";const ie={class:"flex items-center justify-between"},ne={class:"flex items-center space-x-4"},ue={class:"text-xl font-semibold text-gray-900 dark:text-white"},ge={class:"flex items-center space-x-3"},ce=["disabled"],be={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},me={class:"lg:col-span-2 space-y-6"},ye={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},xe={class:"px-6 py-4"},ve={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},pe=["value"],ke={class:"mt-4"},fe={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},we={class:"divide-y divide-gray-200 dark:divide-gray-700"},he={key:0,class:"space-y-3"},qe={class:"grid grid-cols-1 gap-3"},Ce={class:"flex flex-wrap gap-3 items-end"},_e={class:"w-20"},Me={class:"w-28"},Ve=["value"],Ae={class:"w-28"},ze={class:"w-28"},Se=["value"],Be={key:1,class:"block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 text-sm"},Le={class:"flex space-x-2"},Ue=["onClick","disabled"],Te={key:1,class:"flex items-center justify-between"},je={key:0,class:"flex flex-col mr-3"},Fe=["onClick","disabled"],Ee=["onClick","disabled"],$e=["onClick"],He={class:"text-sm font-medium text-gray-900 dark:text-white"},Ie={key:0,class:"text-sm text-gray-500 dark:text-gray-400 whitespace-pre-line"},De={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},Re={class:"flex items-center space-x-2"},Pe={class:"text-sm font-medium text-gray-900 dark:text-white mr-2"},Ne=["onClick"],Qe=["onClick"],Oe={class:"space-y-3"},Ge={class:"grid grid-cols-1 gap-3"},Je={class:"flex flex-wrap gap-3 items-end"},Ke={class:"w-20"},We={class:"w-28"},Xe=["value"],Ye={class:"w-28"},Ze={class:"w-28"},et=["value"],tt={key:1,class:"block w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-gray-500 dark:border-gray-600 dark:bg-gray-600 dark:text-gray-400 text-sm"},rt=["disabled"],st={class:"space-y-6"},ot={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 sticky top-20"},at={class:"px-6 py-4 space-y-3"},dt={class:"flex justify-between text-sm"},lt={class:"font-medium text-gray-900 dark:text-white"},it={class:"flex justify-between text-sm"},nt={class:"font-medium text-gray-900 dark:text-white"},ut={class:"border-t border-gray-200 dark:border-gray-700 pt-3"},gt={class:"flex justify-between"},ct={class:"text-lg font-bold text-gray-900 dark:text-white"},bt={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50"},mt={class:"text-xs text-gray-500 dark:text-gray-400"},yt={key:0,class:"fixed inset-0 z-50 overflow-hidden"},xt={class:"flex items-center justify-center min-h-screen p-4"},vt={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},pt={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},kt={class:"flex items-center space-x-2"},ft=["href"],wt=["disabled"],ht={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},qt={key:0,class:"flex items-center justify-center h-96"},Ct=["innerHTML"],_t={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},Lt={__name:"Edit",props:{quote:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean},setup(n){const g=n,S=g.isVatExempt?0:17,C=z(!1),B=z(""),_=z(!1),A=z(null),i=T({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:S}),x=T({client_id:g.quote.client_id,valid_until:g.quote.valid_until||"",notes:g.quote.notes||"",currency:g.quote.currency}),u=T({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:S}),L=ae(()=>{let o=0,t=0;for(const v of g.quote.items||[])o+=parseFloat(v.total_ht)||0,t+=parseFloat(v.total_vat)||0;return{ht:o,vat:t,ttc:o+t}}),M=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:g.quote.currency||"EUR"}).format(o),U=()=>{x.put(route("quotes.update",g.quote.id),{preserveScroll:!0})},R=()=>{u.post(route("quotes.items.store",g.quote.id),{preserveScroll:!0,onSuccess:()=>{u.reset(),u.title="",u.description="",u.quantity=1,u.unit="hour",u.vat_rate=S}})},P=(o,t)=>{const v={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unité",plural:"unités"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!o||!v[o]?"":t<=1?v[o].singular:v[o].plural},N=o=>{const t=parseFloat(o);return t===Math.floor(t)?Math.floor(t).toString():t.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},E=(o,t)=>{w.patch(route("quotes.items.move",[g.quote.id,o]),{direction:t},{preserveScroll:!0})},Q=o=>{confirm("Supprimer cette ligne ?")&&w.delete(route("quotes.items.destroy",[g.quote.id,o]),{preserveScroll:!0})},$=o=>{A.value=o.id,i.title=o.title,i.description=o.description||"",i.quantity=parseFloat(o.quantity),i.unit=o.unit||"",i.unit_price=parseFloat(o.unit_price),i.vat_rate=parseFloat(o.vat_rate)},O=()=>{A.value=null,i.reset()},G=o=>{i.put(route("quotes.items.update",[g.quote.id,o]),{preserveScroll:!0,onSuccess:()=>{A.value=null,i.reset()}})},J=()=>{confirm("Supprimer ce devis ?")&&w.delete(route("quotes.destroy",g.quote.id))},K=()=>{w.post(route("quotes.mark-sent",g.quote.id),{},{preserveScroll:!0})},W=()=>{w.post(route("quotes.mark-accepted",g.quote.id),{},{preserveScroll:!0})},X=()=>{w.post(route("quotes.mark-declined",g.quote.id),{},{preserveScroll:!0})},Y=()=>{confirm("Convertir ce devis en facture ? Une nouvelle facture brouillon sera créée avec les mêmes lignes.")&&w.post(route("quotes.convert",g.quote.id),{},{preserveScroll:!0})},H=async()=>{_.value=!0;try{const o=await de.get(route("quotes.preview-html",g.quote.id));B.value=o.data.html}catch(o){console.error("Error loading preview:",o),B.value=`<p style="color: red; padding: 20px;">Erreur lors du chargement de l'aperçu</p>`}finally{_.value=!1}},Z=()=>{C.value=!0,H()},ee=o=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return t[o]||t.draft},te=o=>({draft:"Brouillon",sent:"Envoyé",accepted:"Accepté",declined:"Refusé",expired:"Expiré",converted:"Converti"})[o]||o;return(o,t)=>(d(),a(p,null,[m(s(re),{title:`Devis ${n.quote.reference}`},null,8,["title"]),m(le,null,{header:j(()=>[e("div",ie,[e("div",ne,[m(s(oe),{href:o.route("quotes.index"),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},{default:j(()=>[...t[18]||(t[18]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",ue," Devis "+c(n.quote.reference),1),e("span",{class:D([ee(n.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},c(te(n.quote.status)),3)]),e("div",ge,[e("button",{type:"button",onClick:Z,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[...t[19]||(t[19]=[e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1),f(" Aperçu ",-1)])]),e("button",{type:"button",onClick:J,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"}," Supprimer "),n.quote.status==="draft"?(d(),a("button",{key:0,type:"button",onClick:K,disabled:!n.quote.items||n.quote.items.length===0,class:"inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Marquer envoyé ",8,ce)):k("",!0),n.quote.status==="sent"?(d(),a("button",{key:1,type:"button",onClick:W,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"},[...t[20]||(t[20]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1),f(" Accepter ",-1)])])):k("",!0),n.quote.status==="sent"?(d(),a("button",{key:2,type:"button",onClick:X,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"},[...t[21]||(t[21]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1),f(" Refuser ",-1)])])):k("",!0),n.quote.status==="accepted"?(d(),a("button",{key:3,type:"button",onClick:Y,class:"inline-flex items-center rounded-md bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500"},[...t[22]||(t[22]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M1 4a1 1 0 011-1h16a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4zm12 4a3 3 0 11-6 0 3 3 0 016 0zM4 9a1 1 0 100-2 1 1 0 000 2zm13-1a1 1 0 11-2 0 1 1 0 012 0zM1.75 14.5a.75.75 0 000 1.5c4.417 0 8.693.603 12.749 1.73 1.111.309 2.251-.512 2.251-1.696v-.784a.75.75 0 00-1.5 0v.784a.272.272 0 01-.35.25A49.043 49.043 0 001.75 14.5z","clip-rule":"evenodd"})],-1),f(" Convertir en facture ",-1)])])):k("",!0)])])]),default:j(()=>{var v;return[e("div",be,[e("div",me,[e("div",ye,[t[23]||(t[23]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Informations")],-1)),e("div",xe,[e("div",ve,[e("div",null,[m(F,{for:"client_id",value:"Client"}),b(e("select",{id:"client_id","onUpdate:modelValue":t[0]||(t[0]=r=>s(x).client_id=r),onChange:U,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[(d(!0),a(p,null,h(n.clients,r=>(d(),a("option",{key:r.id,value:r.id},c(r.name),9,pe))),128))],544),[[V,s(x).client_id]]),m(q,{message:s(x).errors.client_id,class:"mt-2"},null,8,["message"])]),e("div",null,[m(F,{for:"valid_until",value:"Valide jusqu'au"}),b(e("input",{id:"valid_until","onUpdate:modelValue":t[1]||(t[1]=r=>s(x).valid_until=r),onChange:U,type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,544),[[y,s(x).valid_until]]),m(q,{message:s(x).errors.valid_until,class:"mt-2"},null,8,["message"])])]),e("div",ke,[m(F,{for:"notes",value:"Notes / Conditions"}),b(e("textarea",{id:"notes","onUpdate:modelValue":t[2]||(t[2]=r=>s(x).notes=r),onBlur:U,rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Conditions particulières..."},null,544),[[y,s(x).notes]])])])]),e("div",fe,[t[44]||(t[44]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Lignes du devis")],-1)),e("div",we,[(d(!0),a(p,null,h(n.quote.items,(r,I)=>(d(),a("div",{key:r.id,class:"px-6 py-4"},[A.value===r.id?(d(),a("div",he,[e("div",qe,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Titre",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s(i).title=l),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[y,s(i).title]]),m(q,{message:s(i).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Description (optionnel)",-1)),b(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(i).description=l),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Description détaillée"},null,512),[[y,s(i).description]]),m(q,{message:s(i).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Ce,[e("div",_e,[t[26]||(t[26]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Quantité",-1)),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(i).quantity=l),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,s(i).quantity,void 0,{number:!0}]])]),e("div",Me,[t[28]||(t[28]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Unité",-1)),b(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>s(i).unit=l),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[t[27]||(t[27]=e("option",{value:""},"Sans unité",-1)),(d(!0),a(p,null,h(n.units,l=>(d(),a("option",{key:l.value,value:l.value},c(l.label),9,Ve))),128))],512),[[V,s(i).unit]])]),e("div",Ae,[t[29]||(t[29]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s(i).unit_price=l),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,s(i).unit_price,void 0,{number:!0}]])]),e("div",ze,[t[30]||(t[30]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"TVA",-1)),n.isVatExempt?(d(),a("div",Be," 0% ")):b((d(),a("select",{key:0,"onUpdate:modelValue":t[8]||(t[8]=l=>s(i).vat_rate=l),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(d(!0),a(p,null,h(n.vatRates,l=>(d(),a("option",{key:l.value,value:l.value},c(l.value)+"% ",9,Se))),128))],512)),[[V,s(i).vat_rate,void 0,{number:!0}]])]),e("div",Le,[e("button",{type:"button",onClick:l=>G(r.id),disabled:s(i).processing,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...t[31]||(t[31]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,Ue),e("button",{type:"button",onClick:O,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...t[32]||(t[32]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(d(),a("div",Te,[n.quote.items.length>1?(d(),a("div",je,[e("button",{type:"button",onClick:l=>E(r.id,"up"),disabled:I===0,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Monter"},[...t[33]||(t[33]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,Fe),e("button",{type:"button",onClick:l=>E(r.id,"down"),disabled:I===n.quote.items.length-1,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Descendre"},[...t[34]||(t[34]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Ee)])):k("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:l=>$(r)},[e("p",He,c(r.title),1),r.description?(d(),a("p",Ie,c(r.description),1)):k("",!0),e("p",De,c(N(r.quantity))+" "+c(P(r.unit,r.quantity))+" x "+c(M(r.unit_price))+" (TVA "+c(r.vat_rate)+"%) ",1)],8,$e),e("div",Re,[e("span",Pe,c(M(r.total_ht)),1),e("button",{type:"button",onClick:l=>$(r),class:"p-1 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400",title:"Modifier"},[...t[35]||(t[35]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,Ne),e("button",{type:"button",onClick:l=>Q(r.id),class:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400",title:"Supprimer"},[...t[36]||(t[36]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,Qe)])]))]))),128)),e("form",{onSubmit:se(R,["prevent"]),class:"px-6 py-4"},[t[43]||(t[43]=e("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"Ajouter une ligne",-1)),e("div",Oe,[e("div",Ge,[e("div",null,[b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=r=>s(u).title=r),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[y,s(u).title]]),m(q,{message:s(u).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[b(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=r=>s(u).description=r),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:"Description détaillée (optionnel)"},null,512),[[y,s(u).description]]),m(q,{message:s(u).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Je,[e("div",Ke,[t[37]||(t[37]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Quantité",-1)),b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=r=>s(u).quantity=r),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,s(u).quantity,void 0,{number:!0}]])]),e("div",We,[t[39]||(t[39]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Unité",-1)),b(e("select",{"onUpdate:modelValue":t[12]||(t[12]=r=>s(u).unit=r),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[t[38]||(t[38]=e("option",{value:""},"Sans unité",-1)),(d(!0),a(p,null,h(n.units,r=>(d(),a("option",{key:r.value,value:r.value},c(r.label),9,Xe))),128))],512),[[V,s(u).unit]])]),e("div",Ye,[t[40]||(t[40]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[13]||(t[13]=r=>s(u).unit_price=r),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[y,s(u).unit_price,void 0,{number:!0}]])]),e("div",Ze,[t[41]||(t[41]=e("label",{class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},"TVA",-1)),n.isVatExempt?(d(),a("div",tt," 0% ")):b((d(),a("select",{key:0,"onUpdate:modelValue":t[14]||(t[14]=r=>s(u).vat_rate=r),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(d(!0),a(p,null,h(n.vatRates,r=>(d(),a("option",{key:r.value,value:r.value},c(r.value)+"% ",9,et))),128))],512)),[[V,s(u).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:s(u).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},[...t[42]||(t[42]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),f(" Ajouter ",-1)])],8,rt)])])],32)])])]),e("div",st,[e("div",ot,[t[48]||(t[48]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Résumé")],-1)),e("div",at,[e("div",dt,[t[45]||(t[45]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Total HT",-1)),e("span",lt,c(M(L.value.ht)),1)]),e("div",it,[t[46]||(t[46]=e("span",{class:"text-gray-500 dark:text-gray-400"},"TVA",-1)),e("span",nt,c(M(L.value.vat)),1)]),e("div",ut,[e("div",gt,[t[47]||(t[47]=e("span",{class:"text-base font-medium text-gray-900 dark:text-white"},"Total TTC",-1)),e("span",ct,c(M(L.value.ttc)),1)])])]),e("div",bt,[e("p",mt,c(((v=n.quote.items)==null?void 0:v.length)||0)+" ligne(s) ",1)])])])]),C.value?(d(),a("div",yt,[e("div",xt,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[15]||(t[15]=r=>C.value=!1)}),e("div",vt,[e("div",pt,[t[53]||(t[53]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Aperçu du devis ",-1)),e("div",kt,[e("a",{href:o.route("quotes.pdf.stream",n.quote.id),target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...t[49]||(t[49]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),f(" PDF ",-1)])],8,ft),e("button",{type:"button",onClick:H,disabled:_.value,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 disabled:opacity-50"},[(d(),a("svg",{class:D(["h-4 w-4 mr-1",{"animate-spin":_.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...t[50]||(t[50]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),t[51]||(t[51]=f(" Actualiser ",-1))],8,wt),e("button",{type:"button",onClick:t[16]||(t[16]=r=>C.value=!1),class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...t[52]||(t[52]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",ht,[_.value?(d(),a("div",qt,[...t[54]||(t[54]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(d(),a("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:B.value},null,8,Ct))]),e("div",_t,[e("button",{type:"button",onClick:t[17]||(t[17]=r=>C.value=!1),class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"}," Fermer ")])])])])):k("",!0)]}),_:1})],64))}};export{Lt as default};
