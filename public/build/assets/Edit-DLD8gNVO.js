import{r as g,u as N,m as J,c as d,a as b,b as t,h as me,i as D,d as e,t as a,f as x,o as n,F as _,j as k,k as z,g as w,v as h,e as L,w as ve,y as W,l as xe,p as B,q as A,K as pe}from"./app-zFpXp4fG.js";import{_ as be}from"./AppLayout-BD3btj02.js";import{_ as C}from"./InputError-DftglpBt.js";import{_ as V}from"./InputLabel-Cp7hTEpk.js";import{_ as fe}from"./VatScenarioIndicator-BlCMHcUL.js";import{u as he}from"./useTranslations-C21gh8T9.js";import"./DropdownLink-DnElioyO.js";const _e={class:"flex items-center justify-between"},ge={class:"flex items-center space-x-4"},ke={class:"text-xl font-semibold text-slate-900 dark:text-white"},we={class:"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-0.5 text-xs font-medium text-slate-800 dark:bg-slate-700 dark:text-slate-300"},ye={class:"flex items-center space-x-3"},Ce=["disabled"],Ve={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},Me={class:"lg:col-span-2 space-y-6"},ze={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Ue={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},$e={class:"text-lg font-medium text-slate-900 dark:text-white"},je={class:"px-6 py-4"},Le={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Se=["value"],qe={key:0,class:"mt-2"},Fe=["placeholder"],Be={class:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},Ae={class:"mt-4"},Ie=["placeholder"],Ee={class:"mt-4"},He={value:""},Te=["value"],Ne={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},De={key:0,class:"mt-4"},Oe=["placeholder"],Pe={class:"mt-4"},Re=["placeholder"],Ke={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},Qe={class:"mt-4 flex items-center justify-end gap-3"},Ge={key:0,class:"text-sm text-green-600 dark:text-green-400"},Je=["disabled"],We={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Xe={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Ye={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Ze={class:"text-lg font-medium text-slate-900 dark:text-white"},et={class:"divide-y divide-slate-200 dark:divide-slate-700"},tt={key:0,class:"space-y-3"},st={class:"grid grid-cols-1 gap-3"},lt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},ot=["placeholder"],at={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},rt=["placeholder"],it={class:"flex flex-wrap gap-3 items-end"},dt={class:"w-20"},nt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},ct={class:"w-28"},ut={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},mt={value:""},vt=["value"],xt={class:"w-28"},pt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},bt={class:"w-28"},ft={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},ht=["value"],_t={class:"flex space-x-2"},gt=["onClick","disabled"],kt={key:1,class:"flex items-center justify-between"},wt={key:0,class:"flex flex-col mr-3"},yt=["onClick","disabled","title"],Ct=["onClick","disabled","title"],Vt=["onClick"],Mt={class:"text-sm font-medium text-slate-900 dark:text-white"},zt={key:0,class:"text-sm text-slate-500 dark:text-slate-400 whitespace-pre-line"},Ut={class:"text-xs text-slate-400 dark:text-slate-500 mt-1"},$t={class:"flex items-center space-x-2"},jt={class:"text-sm font-medium text-slate-900 dark:text-white mr-2"},Lt=["onClick","title"],St=["onClick","title"],qt={class:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3"},Ft={class:"space-y-3"},Bt={class:"grid grid-cols-1 gap-3"},At=["placeholder"],It=["placeholder"],Et={class:"flex flex-wrap gap-3 items-end"},Ht={class:"w-20"},Tt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},Nt={class:"w-28"},Dt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},Ot={value:""},Pt=["value"],Rt={class:"w-28"},Kt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},Qt={class:"w-28"},Gt={class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},Jt=["value"],Wt=["disabled"],Xt={class:"space-y-6"},Yt={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800 sticky top-20"},Zt={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},es={class:"text-lg font-medium text-slate-900 dark:text-white"},ts={class:"px-6 py-4 space-y-3"},ss={class:"flex justify-between text-sm"},ls={class:"text-slate-500 dark:text-slate-400"},os={class:"font-medium text-slate-900 dark:text-white"},as={class:"flex justify-between text-sm"},rs={class:"text-slate-500 dark:text-slate-400"},is={class:"font-medium text-slate-900 dark:text-white"},ds={class:"border-t border-slate-200 dark:border-slate-700 pt-3"},ns={class:"flex justify-between"},cs={class:"text-base font-medium text-slate-900 dark:text-white"},us={class:"text-lg font-bold text-slate-900 dark:text-white"},ms={class:"px-6 py-4 bg-slate-50 dark:bg-slate-700/50"},vs={class:"text-xs text-slate-500 dark:text-slate-400"},xs={key:0,class:"fixed inset-0 z-50 overflow-hidden"},ps={class:"flex items-center justify-center min-h-screen p-4"},bs={class:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},fs={class:"flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700"},hs={class:"text-lg font-medium text-slate-900 dark:text-white"},_s={class:"flex items-center space-x-2"},gs={class:"flex items-center border border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden"},ks=["onClick","title"],ws=["href"],ys=["disabled"],Cs={class:"flex-1 overflow-auto p-6 bg-slate-100 dark:bg-slate-900"},Vs={key:0,class:"flex items-center justify-center h-96"},Ms=["innerHTML"],zs={class:"flex items-center justify-end px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/50"},Us={class:"text-sm text-slate-500 dark:text-slate-400 mr-auto"},$s={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},js={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Ls={class:"inline-block transform overflow-hidden rounded-2xl bg-white text-left align-bottom shadow-xl transition-all dark:bg-slate-800 sm:my-8 sm:w-full sm:max-w-lg sm:align-middle"},Ss={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},qs={class:"sm:flex sm:items-start"},Fs={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},Bs={class:"text-lg font-medium leading-6 text-slate-900 dark:text-white"},As={class:"mt-2"},Is={class:"text-sm text-slate-500 dark:text-slate-400"},Es={class:"bg-slate-50 px-4 py-3 dark:bg-slate-700 sm:flex sm:flex-row-reverse sm:px-6"},Ks={__name:"Edit",props:{invoice:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean,defaultInvoiceFooter:String,vatMentionOptions:Array,defaultVatMention:String,defaultCustomVatMention:String,clientVatScenario:Object,suggestedVatMention:String,vatScenarios:Object},setup(p){var G;const{t:o}=he(),m=p,O=m.isVatExempt?0:17,X=r=>{if(!r)return"";const s=new Date(r);return isNaN(s.getTime())?"":s.toISOString().split("T")[0]},Y=B(()=>{var r;return(r=m.clients)==null?void 0:r.find(s=>s.id===i.client_id)}),P=B(()=>{var r;return((r=Y.value)==null?void 0:r.vat_scenario)||null}),U=g(!1),M=g(!1),I=g(""),$=g(!1),S=g(null),q=g(((G=m.invoice.client)==null?void 0:G.locale)||"fr"),Z=[{value:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{value:"de",label:"Deutsch",flag:"üá©üá™"},{value:"en",label:"English",flag:"üá¨üáß"},{value:"lb",label:"L√´tzebuergesch",flag:"üá±üá∫"}],ee=B(()=>`${route("invoices.draft-pdf",m.invoice.id)}?locale=${q.value}`),u=N({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:17}),i=N({client_id:m.invoice.client_id,title:m.invoice.title||"",due_at:X(m.invoice.due_at),notes:m.invoice.notes||"",footer_message:m.invoice.footer_message||"",vat_mention:m.invoice.vat_mention||"",custom_vat_mention:m.invoice.custom_vat_mention||"",currency:m.invoice.currency}),v=N({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:O}),E=B(()=>{let r=0,s=0;for(const f of m.invoice.items||[])r+=parseFloat(f.total_ht)||0,s+=parseFloat(f.total_vat)||0;return{ht:r,vat:s,ttc:r+s}}),j=r=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:m.invoice.currency||"EUR"}).format(r),R=g(!1),F=g(!1);J(()=>[i.client_id,i.title,i.due_at,i.notes,i.footer_message,i.vat_mention,i.custom_vat_mention],()=>{R.value=!0,F.value=!1},{deep:!0}),J(()=>i.client_id,r=>{var s,f;if(r){const y=(s=m.clients)==null?void 0:s.find(l=>l.id===r);(f=y==null?void 0:y.vat_scenario)!=null&&f.mention&&!i.vat_mention&&(i.vat_mention=y.vat_scenario.mention)}});const te=()=>{i.put(route("invoices.update",m.invoice.id),{preserveScroll:!0,onSuccess:()=>{R.value=!1,F.value=!0,setTimeout(()=>{F.value=!1},2e3)}})},se=()=>{v.post(route("invoices.items.store",m.invoice.id),{preserveScroll:!0,onSuccess:()=>{v.reset(),v.title="",v.description="",v.quantity=1,v.unit="hour",v.vat_rate=O}})},le=(r,s)=>{const f={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unit√©",plural:"unit√©s"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!r||!f[r]?"":s<=1?f[r].singular:f[r].plural},oe=r=>{const s=parseFloat(r);return s===Math.floor(s)?Math.floor(s).toString():s.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},K=(r,s)=>{A.patch(route("invoices.items.move",[m.invoice.id,r]),{direction:s},{preserveScroll:!0})},ae=r=>{confirm(o("delete_line_confirm"))&&A.delete(route("invoices.items.destroy",[m.invoice.id,r]),{preserveScroll:!0})},Q=r=>{S.value=r.id,u.title=r.title,u.description=r.description||"",u.quantity=parseFloat(r.quantity),u.unit=r.unit||"",u.unit_price=parseFloat(r.unit_price),u.vat_rate=parseFloat(r.vat_rate)},re=()=>{S.value=null,u.reset()},ie=r=>{u.put(route("invoices.items.update",[m.invoice.id,r]),{preserveScroll:!0,onSuccess:()=>{S.value=null,u.reset()}})},de=()=>{confirm(o("delete_draft_confirm"))&&A.delete(route("invoices.destroy",m.invoice.id))},ne=()=>{A.post(route("invoices.finalize",m.invoice.id),{},{onSuccess:()=>{U.value=!1}})},H=async()=>{$.value=!0;try{const r=route("invoices.preview-draft",m.invoice.id)+`?locale=${q.value}`,s=await pe.get(r);I.value=s.data.html}catch(r){console.error("Error loading preview:",r),I.value=`<p style="color: red; padding: 20px;">${o("error_loading_preview")}</p>`}finally{$.value=!1}},ce=r=>{q.value=r,M.value&&H()},ue=()=>{M.value=!0,H()};return(r,s)=>(n(),d(_,null,[b(t(me),{title:`${t(o)("invoice")} ${p.invoice.display_number}`},null,8,["title"]),b(be,null,{header:D(()=>[e("div",_e,[e("div",ge,[b(t(xe),{href:r.route("invoices.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:D(()=>[...s[25]||(s[25]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",ke,a(p.invoice.title||t(o)("draft_invoice")),1),e("span",we,a(t(o)("draft")),1)]),e("div",ye,[e("button",{type:"button",onClick:ue,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[s[26]||(s[26]=e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),L(" "+a(t(o)("preview")),1)]),e("button",{type:"button",onClick:de,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"},a(t(o)("delete")),1),e("button",{type:"button",onClick:s[0]||(s[0]=f=>U.value=!0),disabled:!p.invoice.items||p.invoice.items.length===0,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed"},a(t(o)("finalize")),9,Ce)])])]),default:D(()=>{var f,y;return[e("div",Ve,[e("div",Me,[e("div",ze,[e("div",Ue,[e("h2",$e,a(t(o)("information")),1)]),e("div",je,[e("div",Le,[e("div",null,[b(V,{for:"client_id",value:t(o)("client")},null,8,["value"]),x(e("select",{id:"client_id","onUpdate:modelValue":s[1]||(s[1]=l=>t(i).client_id=l),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(n(!0),d(_,null,k(p.clients,l=>(n(),d("option",{key:l.id,value:l.id},a(l.name),9,Se))),128))],512),[[z,t(i).client_id]]),b(C,{message:t(i).errors.client_id,class:"mt-2"},null,8,["message"]),P.value?(n(),d("div",qe,[b(fe,{scenario:P.value,size:"sm"},null,8,["scenario"])])):w("",!0)]),e("div",null,[b(V,{for:"title",value:t(o)("title_optional")},null,8,["value"]),x(e("input",{id:"title","onUpdate:modelValue":s[2]||(s[2]=l=>t(i).title=l),type:"text",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(o)("example_placeholder")},null,8,Fe),[[h,t(i).title]]),b(C,{message:t(i).errors.title,class:"mt-2"},null,8,["message"])])]),e("div",Be,[e("div",null,[b(V,{for:"due_at",value:t(o)("due_date")},null,8,["value"]),x(e("input",{id:"due_at","onUpdate:modelValue":s[3]||(s[3]=l=>t(i).due_at=l),type:"date",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[h,t(i).due_at]]),b(C,{message:t(i).errors.due_at,class:"mt-2"},null,8,["message"])])]),e("div",Ae,[b(V,{for:"notes",value:t(o)("notes")},null,8,["value"]),x(e("textarea",{id:"notes","onUpdate:modelValue":s[4]||(s[4]=l=>t(i).notes=l),rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(o)("notes_placeholder")},null,8,Ie),[[h,t(i).notes]])]),e("div",Ee,[b(V,{for:"vat_mention",value:t(o)("vat_mention_optional")},null,8,["value"]),x(e("select",{id:"vat_mention","onUpdate:modelValue":s[5]||(s[5]=l=>t(i).vat_mention=l),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[e("option",He,a(t(o)("use_default_mention")),1),(n(!0),d(_,null,k(p.vatMentionOptions,l=>(n(),d("option",{key:l.value,value:l.value},a(l.label),9,Te))),128))],512),[[z,t(i).vat_mention]]),e("p",Ne,a(t(o)("default_mention_note")),1)]),t(i).vat_mention==="other"?(n(),d("div",De,[b(V,{for:"custom_vat_mention",value:t(o)("custom_vat_mention_label")},null,8,["value"]),x(e("textarea",{id:"custom_vat_mention","onUpdate:modelValue":s[6]||(s[6]=l=>t(i).custom_vat_mention=l),rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(o)("custom_vat_mention_placeholder")},null,8,Oe),[[h,t(i).custom_vat_mention]])])):w("",!0),e("div",Pe,[b(V,{for:"footer_message",value:t(o)("footer_message_optional")},null,8,["value"]),x(e("textarea",{id:"footer_message","onUpdate:modelValue":s[7]||(s[7]=l=>t(i).footer_message=l),rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:p.defaultInvoiceFooter},null,8,Re),[[h,t(i).footer_message]]),e("p",Ke,a(t(o)("empty_default_message"))+' "'+a(p.defaultInvoiceFooter)+'" ',1)]),e("div",Qe,[F.value?(n(),d("span",Ge,a(t(o)("saved")),1)):w("",!0),e("button",{type:"button",onClick:te,disabled:t(i).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[t(i).processing?(n(),d("svg",We,[...s[27]||(s[27]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):w("",!0),L(" "+a(t(i).processing?t(o)("saving"):t(o)("save")),1)],8,Je)])])]),e("div",Xe,[e("div",Ye,[e("h2",Ze,a(t(o)("invoice_lines")),1)]),e("div",et,[(n(!0),d(_,null,k(p.invoice.items,(l,T)=>(n(),d("div",{key:l.id,class:"px-6 py-4"},[S.value===l.id?(n(),d("div",tt,[e("div",st,[e("div",null,[e("label",lt,a(t(o)("title")),1),x(e("input",{"onUpdate:modelValue":s[8]||(s[8]=c=>t(u).title=c),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:t(o)("service_title"),required:""},null,8,ot),[[h,t(u).title]]),b(C,{message:t(u).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[e("label",at,a(t(o)("description"))+" ("+a(t(o)("optional"))+")",1),x(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=c=>t(u).description=c),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:t(o)("detailed_description")},null,8,rt),[[h,t(u).description]]),b(C,{message:t(u).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",it,[e("div",dt,[e("label",nt,a(t(o)("quantity")),1),x(e("input",{"onUpdate:modelValue":s[10]||(s[10]=c=>t(u).quantity=c),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[h,t(u).quantity,void 0,{number:!0}]])]),e("div",ct,[e("label",ut,a(t(o)("unit")),1),x(e("select",{"onUpdate:modelValue":s[11]||(s[11]=c=>t(u).unit=c),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[e("option",mt,a(t(o)("without_unit")),1),(n(!0),d(_,null,k(p.units,c=>(n(),d("option",{key:c.value,value:c.value},a(c.label),9,vt))),128))],512),[[z,t(u).unit]])]),e("div",xt,[e("label",pt,a(t(o)("price_ht")),1),x(e("input",{"onUpdate:modelValue":s[12]||(s[12]=c=>t(u).unit_price=c),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[h,t(u).unit_price,void 0,{number:!0}]])]),e("div",bt,[e("label",ft,a(t(o)("vat")),1),x(e("select",{"onUpdate:modelValue":s[13]||(s[13]=c=>t(u).vat_rate=c),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(n(!0),d(_,null,k(p.vatRates,c=>(n(),d("option",{key:c.value,value:c.value},a(c.value)+"% ",9,ht))),128))],512),[[z,t(u).vat_rate,void 0,{number:!0}]])]),e("div",_t,[e("button",{type:"button",onClick:c=>ie(l.id),disabled:t(u).processing,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...s[28]||(s[28]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,gt),e("button",{type:"button",onClick:re,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...s[29]||(s[29]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(n(),d("div",kt,[p.invoice.items.length>1?(n(),d("div",wt,[e("button",{type:"button",onClick:c=>K(l.id,"up"),disabled:T===0,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:t(o)("move_up")},[...s[30]||(s[30]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,yt),e("button",{type:"button",onClick:c=>K(l.id,"down"),disabled:T===p.invoice.items.length-1,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:t(o)("move_down")},[...s[31]||(s[31]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Ct)])):w("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:c=>Q(l)},[e("p",Mt,a(l.title),1),l.description?(n(),d("p",zt,a(l.description),1)):w("",!0),e("p",Ut,a(oe(l.quantity))+" "+a(le(l.unit,l.quantity))+" x "+a(j(l.unit_price))+" (TVA "+a(l.vat_rate)+"%) ",1)],8,Vt),e("div",$t,[e("span",jt,a(j(l.total_ht)),1),e("button",{type:"button",onClick:c=>Q(l),class:"p-1 text-slate-400 hover:text-primary-600 dark:hover:text-primary-400",title:t(o)("edit")},[...s[32]||(s[32]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,Lt),e("button",{type:"button",onClick:c=>ae(l.id),class:"p-1 text-slate-400 hover:text-red-600 dark:hover:text-red-400",title:t(o)("delete")},[...s[33]||(s[33]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,St)])]))]))),128)),e("form",{onSubmit:ve(se,["prevent"]),class:"px-6 py-4"},[e("p",qt,a(t(o)("add_line")),1),e("div",Ft,[e("div",Bt,[e("div",null,[x(e("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>t(v).title=l),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:t(o)("service_title"),required:""},null,8,At),[[h,t(v).title]]),b(C,{message:t(v).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[x(e("textarea",{"onUpdate:modelValue":s[15]||(s[15]=l=>t(v).description=l),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:t(o)("detailed_description_optional")},null,8,It),[[h,t(v).description]]),b(C,{message:t(v).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Et,[e("div",Ht,[e("label",Tt,a(t(o)("quantity")),1),x(e("input",{"onUpdate:modelValue":s[16]||(s[16]=l=>t(v).quantity=l),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[h,t(v).quantity,void 0,{number:!0}]])]),e("div",Nt,[e("label",Dt,a(t(o)("unit")),1),x(e("select",{"onUpdate:modelValue":s[17]||(s[17]=l=>t(v).unit=l),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[e("option",Ot,a(t(o)("without_unit")),1),(n(!0),d(_,null,k(p.units,l=>(n(),d("option",{key:l.value,value:l.value},a(l.label),9,Pt))),128))],512),[[z,t(v).unit]])]),e("div",Rt,[e("label",Kt,a(t(o)("price_ht")),1),x(e("input",{"onUpdate:modelValue":s[18]||(s[18]=l=>t(v).unit_price=l),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[h,t(v).unit_price,void 0,{number:!0}]])]),e("div",Qt,[e("label",Gt,a(t(o)("vat")),1),x(e("select",{"onUpdate:modelValue":s[19]||(s[19]=l=>t(v).vat_rate=l),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(n(!0),d(_,null,k(p.vatRates,l=>(n(),d("option",{key:l.value,value:l.value},a(l.value)+"% ",9,Jt))),128))],512),[[z,t(v).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:t(v).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[s[34]||(s[34]=e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),L(" "+a(t(o)("add")),1)],8,Wt)])])],32)])])]),e("div",Xt,[e("div",Yt,[e("div",Zt,[e("h2",es,a(t(o)("summary")),1)]),e("div",ts,[e("div",ss,[e("span",ls,a(t(o)("total_ht")),1),e("span",os,a(j(E.value.ht)),1)]),e("div",as,[e("span",rs,a(t(o)("vat")),1),e("span",is,a(j(E.value.vat)),1)]),e("div",ds,[e("div",ns,[e("span",cs,a(t(o)("total_ttc")),1),e("span",us,a(j(E.value.ttc)),1)])])]),e("div",ms,[e("p",vs,a(((f=p.invoice.items)==null?void 0:f.length)||0)+" "+a((((y=p.invoice.items)==null?void 0:y.length)||0)<=1?t(o)("line"):t(o)("lines")),1)])])])]),M.value?(n(),d("div",xs,[e("div",ps,[e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:s[20]||(s[20]=l=>M.value=!1)}),e("div",bs,[e("div",fs,[e("h3",hs,a(t(o)("invoice_preview")),1),e("div",_s,[e("div",gs,[(n(),d(_,null,k(Z,l=>e("button",{key:l.value,type:"button",onClick:T=>ce(l.value),title:l.label,class:W(["px-2 py-1.5 text-base transition-colors",q.value===l.value?"bg-primary-100 dark:bg-primary-900":"bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"])},a(l.flag),11,ks)),64))]),e("a",{href:ee.value,target:"_blank",class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...s[35]||(s[35]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),L(" PDF ",-1)])],8,ws),e("button",{type:"button",onClick:H,disabled:$.value,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 disabled:opacity-50"},[(n(),d("svg",{class:W(["h-4 w-4 mr-1",{"animate-spin":$.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...s[36]||(s[36]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),L(" "+a(t(o)("refresh")),1)],8,ys),e("button",{type:"button",onClick:s[21]||(s[21]=l=>M.value=!1),class:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"},[...s[37]||(s[37]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Cs,[$.value?(n(),d("div",Vs,[...s[38]||(s[38]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"},null,-1)])])):(n(),d("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:I.value},null,8,Ms))]),e("div",zs,[e("p",Us,a(t(o)("preview_finalize_note")),1),e("button",{type:"button",onClick:s[22]||(s[22]=l=>M.value=!1),class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500"},a(t(o)("close")),1)])])])])):w("",!0),U.value?(n(),d("div",$s,[e("div",js,[e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:s[23]||(s[23]=l=>U.value=!1)}),e("div",Ls,[e("div",Ss,[e("div",qs,[s[39]||(s[39]=e("div",{class:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",Fs,[e("h3",Bs,a(t(o)("finalize_invoice_question")),1),e("div",As,[e("p",Is,a(t(o)("finalize_invoice_warning")),1)])])])]),e("div",Es,[e("button",{type:"button",onClick:ne,class:"inline-flex w-full justify-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 sm:ml-3 sm:w-auto"},a(t(o)("finalize")),1),e("button",{type:"button",onClick:s[24]||(s[24]=l=>U.value=!1),class:"mt-3 inline-flex w-full justify-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500 sm:mt-0 sm:w-auto"},a(t(o)("cancel")),1)])])])])):w("",!0)]}),_:1})],64))}};export{Ks as default};
