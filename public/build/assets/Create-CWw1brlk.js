import{u as N,y as S,c as u,a as n,b as t,h as z,i as h,d as e,w as j,f as p,t as m,o as c,F as b,j as g,k as R,g as V,v,e as A,l as B,B as $,r as D}from"./app-BcQ2hP1Y.js";import{_ as T}from"./AppLayout-BAEs7JDD.js";import{_ as y}from"./InputError-CyLuDTn7.js";import{_}from"./InputLabel-xUtG1kC3.js";import{_ as H}from"./PrimaryButton-B9liqhC8.js";import{_ as L}from"./VatScenarioIndicator-DVbIi87q.js";import{u as O}from"./useTranslations-BSkf9FAV.js";import"./DropdownLink-CVd4zr5M.js";const G={class:"flex items-center space-x-4"},J={class:"text-xl font-semibold text-slate-900 dark:text-white"},K={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},P={class:"px-6 py-4"},Q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},W={value:""},X=["value"],Y={key:0,class:"mt-2"},Z=["placeholder"],ee={class:"mt-4"},te={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},ae={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},se={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},le={class:"text-lg font-medium text-slate-900 dark:text-white"},re={class:"px-6 py-4"},oe={class:"space-y-4"},de={class:"flex flex-wrap gap-4 items-end"},ie={class:"flex-1 min-w-[200px]"},ne=["id","onUpdate:modelValue","placeholder"],ue={class:"flex flex-wrap gap-4 items-end"},ce={class:"flex-1 min-w-[200px]"},me=["id","onUpdate:modelValue","placeholder"],_e={class:"w-24"},pe=["id","onUpdate:modelValue"],ve={class:"w-32"},fe=["id","onUpdate:modelValue"],he=["value"],be={class:"w-32"},ke=["id","onUpdate:modelValue"],xe={class:"w-32"},we=["id","value","onChange"],ge=["value"],ye={key:0,class:"w-24"},Ve=["id","value","onInput"],$e=["onClick"],Ce={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},Ue={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},qe={class:"text-lg font-medium text-slate-900 dark:text-white"},Re={class:"px-6 py-4"},Ae=["placeholder"],Be={class:"flex justify-end space-x-3"},Fe={key:0},Ee={key:1},He={__name:"Create",props:{clients:Array,vatRates:Array,units:Array,defaultClientId:[String,Number],isVatExempt:Boolean,vatScenarios:Object,defaultVatRate:{type:Number,default:17}},setup(k){const{t:d}=O(),f=k,C=$(()=>{var r,a;return f.isVatExempt?0:((r=x.value)==null?void 0:r.default_vat_rate)!==null&&((a=x.value)==null?void 0:a.default_vat_rate)!==void 0?parseFloat(x.value.default_vat_rate):f.defaultVatRate}),x=$(()=>{var r;return(r=f.clients)==null?void 0:r.find(a=>a.id===l.client_id)}),U=$(()=>{var r;return((r=x.value)==null?void 0:r.vat_scenario)||null}),l=N({client_id:f.defaultClientId||"",title:"",due_at:"",notes:"",currency:"EUR",items:[]}),w=D({}),q=()=>{const r=l.items.length;l.items.push({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:C.value,vat_rate_select:C.value}),w.value[r]=""},F=(r,a)=>{a==="custom"?(l.items[r].vat_rate_select="custom",l.items[r].vat_rate=w.value[r]||0):(l.items[r].vat_rate_select=a,l.items[r].vat_rate=a)},E=(r,a)=>{w.value[r]=a,l.items[r].vat_rate_select==="custom"&&(l.items[r].vat_rate=parseFloat(a)||0)};S(()=>l.client_id,r=>{if(r){const a=f.clients.find(s=>s.id===r);(a==null?void 0:a.default_vat_rate)!==null&&(a==null?void 0:a.default_vat_rate)!==void 0&&l.items.forEach((s,i)=>{if(s.vat_rate_select!=="custom"){const o=parseFloat(a.default_vat_rate);s.vat_rate=o,s.vat_rate_select=o}})}});const I=r=>{l.items.splice(r,1)},M=()=>{l.post(route("invoices.store"))};return l.items.length===0&&q(),(r,a)=>(c(),u(b,null,[n(t(z),{title:t(d)("new_invoice")},null,8,["title"]),n(T,null,{header:h(()=>[e("div",G,[n(t(B),{href:r.route("invoices.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:h(()=>[...a[4]||(a[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",J,m(t(d)("new_invoice")),1)])]),default:h(()=>[e("form",{onSubmit:j(M,["prevent"]),class:"space-y-6"},[e("div",K,[a[5]||(a[5]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Client")],-1)),e("div",P,[e("div",Q,[e("div",null,[n(_,{for:"client_id",value:"Client"}),p(e("select",{id:"client_id","onUpdate:modelValue":a[0]||(a[0]=s=>t(l).client_id=s),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[e("option",W,m(t(d)("select_client")),1),(c(!0),u(b,null,g(k.clients,s=>(c(),u("option",{key:s.id,value:s.id},m(s.name),9,X))),128))],512),[[R,t(l).client_id]]),n(y,{message:t(l).errors.client_id,class:"mt-2"},null,8,["message"]),U.value?(c(),u("div",Y,[n(L,{scenario:U.value,size:"sm"},null,8,["scenario"])])):V("",!0)]),e("div",null,[n(_,{for:"title",value:t(d)("title_optional")},null,8,["value"]),p(e("input",{id:"title","onUpdate:modelValue":a[1]||(a[1]=s=>t(l).title=s),type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(d)("example_placeholder")},null,8,Z),[[v,t(l).title]]),n(y,{message:t(l).errors.title,class:"mt-2"},null,8,["message"])])]),e("div",ee,[n(_,{for:"due_at",value:t(d)("due_date_optional")},null,8,["value"]),p(e("input",{id:"due_at","onUpdate:modelValue":a[2]||(a[2]=s=>t(l).due_at=s),type:"date",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white sm:max-w-xs"},null,512),[[v,t(l).due_at]]),e("p",te,m(t(d)("default_30_days_after")),1),n(y,{message:t(l).errors.due_at,class:"mt-2"},null,8,["message"])])])]),e("div",ae,[e("div",se,[e("h2",le,m(t(d)("invoice_lines")),1)]),e("div",re,[e("div",oe,[(c(!0),u(b,null,g(t(l).items,(s,i)=>(c(),u("div",{key:i,class:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3"},[e("div",de,[e("div",ie,[n(_,{for:`item-${i}-title`,value:t(d)("title_required")},null,8,["for","value"]),p(e("input",{id:`item-${i}-title`,"onUpdate:modelValue":o=>s.title=o,type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(d)("service_title_placeholder"),required:""},null,8,ne),[[v,s.title]])])]),e("div",ue,[e("div",ce,[n(_,{for:`item-${i}-description`,value:t(d)("description_optional")},null,8,["for","value"]),p(e("input",{id:`item-${i}-description`,"onUpdate:modelValue":o=>s.description=o,type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(d)("additional_details")},null,8,me),[[v,s.description]])]),e("div",_e,[n(_,{for:`item-${i}-quantity`,value:t(d)("qty")},null,8,["for","value"]),p(e("input",{id:`item-${i}-quantity`,"onUpdate:modelValue":o=>s.quantity=o,type:"number",step:"0.01",min:"0.01",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,pe),[[v,s.quantity,void 0,{number:!0}]])]),e("div",ve,[n(_,{for:`item-${i}-unit`,value:t(d)("unit")},null,8,["for","value"]),p(e("select",{id:`item-${i}-unit`,"onUpdate:modelValue":o=>s.unit=o,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[a[6]||(a[6]=e("option",{value:""},"-",-1)),(c(!0),u(b,null,g(k.units,o=>(c(),u("option",{key:o.value,value:o.value},m(o.label),9,he))),128))],8,fe),[[R,s.unit]])]),e("div",be,[n(_,{for:`item-${i}-unit_price`,value:t(d)("price_ht")},null,8,["for","value"]),p(e("input",{id:`item-${i}-unit_price`,"onUpdate:modelValue":o=>s.unit_price=o,type:"number",step:"0.01",min:"0",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,ke),[[v,s.unit_price,void 0,{number:!0}]])]),e("div",xe,[n(_,{for:`item-${i}-vat_rate`,value:t(d)("vat")},null,8,["for","value"]),e("select",{id:`item-${i}-vat_rate`,value:s.vat_rate_select??s.vat_rate,onChange:o=>F(i,o.target.value==="custom"?"custom":parseFloat(o.target.value)),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(c(!0),u(b,null,g(k.vatRates,o=>(c(),u("option",{key:o.value,value:o.value},m(o.label),9,ge))),128))],40,we)]),s.vat_rate_select==="custom"?(c(),u("div",ye,[n(_,{for:`item-${i}-custom_vat_rate`,value:"%"},null,8,["for"]),e("input",{id:`item-${i}-custom_vat_rate`,type:"number",step:"0.01",min:"0",max:"100",value:w.value[i],onInput:o=>E(i,o.target.value),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Ex: 12"},null,40,Ve)])):V("",!0),t(l).items.length>1?(c(),u("button",{key:1,type:"button",onClick:o=>I(i),class:"p-2 text-pink-600 hover:text-pink-800 dark:text-pink-400 dark:hover:text-pink-300"},[...a[7]||(a[7]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,$e)):V("",!0)])]))),128)),e("button",{type:"button",onClick:q,class:"inline-flex items-center rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[a[8]||(a[8]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),A(" "+m(t(d)("add_line")),1)])])])]),e("div",Ce,[e("div",Ue,[e("h2",qe,m(t(d)("notes_optional")),1)]),e("div",Re,[p(e("textarea",{"onUpdate:modelValue":a[3]||(a[3]=s=>t(l).notes=s),rows:"3",class:"block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(d)("notes_placeholder")},null,8,Ae),[[v,t(l).notes]]),n(y,{message:t(l).errors.notes,class:"mt-2"},null,8,["message"])])]),e("div",Be,[n(t(B),{href:r.route("invoices.index"),class:"inline-flex items-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},{default:h(()=>[A(m(t(d)("cancel")),1)]),_:1},8,["href"]),n(H,{disabled:t(l).processing},{default:h(()=>[t(l).processing?(c(),u("span",Fe,m(t(d)("creating")),1)):(c(),u("span",Ee,m(t(d)("create_draft")),1))]),_:1},8,["disabled"])])],32)]),_:1})],64))}};export{He as default};
