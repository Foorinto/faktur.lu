import{r as V,u as j,c as a,a as p,b as r,h as ne,i as E,d as e,f as x,o,F as k,j as g,t as b,k as A,v as m,g as w,w as ue,e as h,x as I,l as ce,p as y,z as P,K as be}from"./app-Cw6IEGVk.js";import{_ as xe}from"./AppLayout-T6HYhi4C.js";import{_ as C}from"./InputError-BFEvDpzk.js";import{_ as D}from"./InputLabel-CpzW-Qag.js";import"./DropdownLink-BIvKXa6q.js";import"./useTranslations-DhFO0YlB.js";const pe={class:"flex items-center justify-between"},me={class:"flex items-center space-x-4"},ve={class:"text-xl font-semibold text-slate-900 dark:text-white"},fe={class:"flex items-center space-x-3"},ke=["disabled"],ge={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},we={class:"lg:col-span-2 space-y-6"},he={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},ye={class:"px-6 py-4"},qe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Ce=["value"],_e={class:"mt-4"},Me={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Ve={class:"divide-y divide-slate-200 dark:divide-slate-700"},Ae={key:0,class:"space-y-3"},ze={class:"grid grid-cols-1 gap-3"},Le={class:"flex flex-wrap gap-3 items-end"},Se={class:"w-20"},Ue={class:"w-28"},Be=["value"],Te={class:"w-28"},Fe={class:"w-28"},$e=["value"],je={key:1,class:"block w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-slate-500 dark:border-slate-600 dark:bg-slate-600 dark:text-slate-400 text-sm"},Ee={class:"flex space-x-2"},Ie=["onClick","disabled"],De={key:1,class:"flex items-center justify-between"},He={key:0,class:"flex flex-col mr-3"},Re=["onClick","disabled"],Ne=["onClick","disabled"],Pe=["onClick"],Qe={class:"text-sm font-medium text-slate-900 dark:text-white"},Oe={key:0,class:"text-sm text-slate-500 dark:text-slate-400 whitespace-pre-line"},Ke={class:"text-xs text-slate-400 dark:text-slate-500 mt-1"},Ge={class:"flex items-center space-x-2"},Je={class:"text-sm font-medium text-slate-900 dark:text-white mr-2"},We=["onClick"],Xe=["onClick"],Ye={class:"space-y-3"},Ze={class:"grid grid-cols-1 gap-3"},et={class:"flex flex-wrap gap-3 items-end"},tt={class:"w-20"},st={class:"w-28"},lt=["value"],rt={class:"w-28"},at={class:"w-28"},ot=["value"],dt={key:1,class:"block w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-slate-500 dark:border-slate-600 dark:bg-slate-600 dark:text-slate-400 text-sm"},it=["disabled"],nt={class:"space-y-6"},ut={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800 sticky top-20"},ct={class:"px-6 py-4 space-y-3"},bt={class:"flex justify-between text-sm"},xt={class:"font-medium text-slate-900 dark:text-white"},pt={class:"flex justify-between text-sm"},mt={class:"font-medium text-slate-900 dark:text-white"},vt={class:"border-t border-slate-200 dark:border-slate-700 pt-3"},ft={class:"flex justify-between"},kt={class:"text-lg font-bold text-slate-900 dark:text-white"},gt={class:"px-6 py-4 bg-slate-50 dark:bg-slate-700/50"},wt={class:"text-xs text-slate-500 dark:text-slate-400"},ht={key:0,class:"fixed inset-0 z-50 overflow-hidden"},yt={class:"flex items-center justify-center min-h-screen p-4"},qt={class:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Ct={class:"flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700"},_t={class:"flex items-center space-x-2"},Mt={class:"flex items-center border border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden"},Vt=["onClick","title"],At=["href"],zt=["disabled"],Lt={class:"flex-1 overflow-auto p-6 bg-slate-100 dark:bg-slate-900"},St={key:0,class:"flex items-center justify-center h-96"},Ut=["innerHTML"],Bt={class:"flex items-center justify-end px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/50"},Dt={__name:"Edit",props:{quote:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean},setup(n){var N;const c=n,S=c.isVatExempt?0:17,Q=l=>{if(!l)return"";const t=new Date(l);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]},q=V(!1),U=V(""),_=V(!1),z=V(null),L=V(((N=c.quote.client)==null?void 0:N.locale)||"fr"),O=[{value:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{value:"de",label:"Deutsch",flag:"üá©üá™"},{value:"en",label:"English",flag:"üá¨üáß"},{value:"lb",label:"L√´tzebuergesch",flag:"üá±üá∫"}],K=P(()=>`${route("quotes.pdf.stream",c.quote.id)}?locale=${L.value}`),i=j({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:S}),v=j({client_id:c.quote.client_id,valid_until:Q(c.quote.valid_until),notes:c.quote.notes||"",currency:c.quote.currency}),u=j({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:S}),B=P(()=>{let l=0,t=0;for(const f of c.quote.items||[])l+=parseFloat(f.total_ht)||0,t+=parseFloat(f.total_vat)||0;return{ht:l,vat:t,ttc:l+t}}),M=l=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:c.quote.currency||"EUR"}).format(l),T=()=>{v.put(route("quotes.update",c.quote.id),{preserveScroll:!0})},G=()=>{u.post(route("quotes.items.store",c.quote.id),{preserveScroll:!0,onSuccess:()=>{u.reset(),u.title="",u.description="",u.quantity=1,u.unit="hour",u.vat_rate=S}})},J=(l,t)=>{const f={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unit√©",plural:"unit√©s"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!l||!f[l]?"":t<=1?f[l].singular:f[l].plural},W=l=>{const t=parseFloat(l);return t===Math.floor(t)?Math.floor(t).toString():t.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},H=(l,t)=>{y.patch(route("quotes.items.move",[c.quote.id,l]),{direction:t},{preserveScroll:!0})},X=l=>{confirm("Supprimer cette ligne ?")&&y.delete(route("quotes.items.destroy",[c.quote.id,l]),{preserveScroll:!0})},R=l=>{z.value=l.id,i.title=l.title,i.description=l.description||"",i.quantity=parseFloat(l.quantity),i.unit=l.unit||"",i.unit_price=parseFloat(l.unit_price),i.vat_rate=parseFloat(l.vat_rate)},Y=()=>{z.value=null,i.reset()},Z=l=>{i.put(route("quotes.items.update",[c.quote.id,l]),{preserveScroll:!0,onSuccess:()=>{z.value=null,i.reset()}})},ee=()=>{confirm("Supprimer ce devis ?")&&y.delete(route("quotes.destroy",c.quote.id))},te=()=>{y.post(route("quotes.mark-sent",c.quote.id),{},{preserveScroll:!0})},se=()=>{y.post(route("quotes.mark-accepted",c.quote.id),{},{preserveScroll:!0})},le=()=>{y.post(route("quotes.mark-declined",c.quote.id),{},{preserveScroll:!0})},re=()=>{confirm("Convertir ce devis en facture ? Une nouvelle facture brouillon sera cr√©√©e avec les m√™mes lignes.")&&y.post(route("quotes.convert",c.quote.id),{},{preserveScroll:!0})},F=async()=>{_.value=!0;try{const l=route("quotes.preview-html",c.quote.id)+`?locale=${L.value}`,t=await be.get(l);U.value=t.data.html}catch(l){console.error("Error loading preview:",l),U.value=`<p style="color: red; padding: 20px;">Erreur lors du chargement de l'aper√ßu</p>`}finally{_.value=!1}},ae=l=>{L.value=l,q.value&&F()},oe=()=>{q.value=!0,F()},de=l=>{const t={draft:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return t[l]||t.draft},ie=l=>({draft:"Brouillon",sent:"Envoy√©",accepted:"Accept√©",declined:"Refus√©",expired:"Expir√©",converted:"Converti"})[l]||l;return(l,t)=>(o(),a(k,null,[p(r(ne),{title:`Devis ${n.quote.reference}`},null,8,["title"]),p(xe,null,{header:E(()=>[e("div",pe,[e("div",me,[p(r(ce),{href:l.route("quotes.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:E(()=>[...t[18]||(t[18]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",ve," Devis "+b(n.quote.reference),1),e("span",{class:I([de(n.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},b(ie(n.quote.status)),3)]),e("div",fe,[e("button",{type:"button",onClick:oe,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[...t[19]||(t[19]=[e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1),h(" Aper√ßu ",-1)])]),e("button",{type:"button",onClick:ee,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"}," Supprimer "),n.quote.status==="draft"?(o(),a("button",{key:0,type:"button",onClick:te,disabled:!n.quote.items||n.quote.items.length===0,class:"inline-flex items-center rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Marquer envoy√© ",8,ke)):w("",!0),n.quote.status==="sent"?(o(),a("button",{key:1,type:"button",onClick:se,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"},[...t[20]||(t[20]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1),h(" Accepter ",-1)])])):w("",!0),n.quote.status==="sent"?(o(),a("button",{key:2,type:"button",onClick:le,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"},[...t[21]||(t[21]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1),h(" Refuser ",-1)])])):w("",!0),n.quote.status==="accepted"?(o(),a("button",{key:3,type:"button",onClick:re,class:"inline-flex items-center rounded-xl bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500"},[...t[22]||(t[22]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M1 4a1 1 0 011-1h16a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4zm12 4a3 3 0 11-6 0 3 3 0 016 0zM4 9a1 1 0 100-2 1 1 0 000 2zm13-1a1 1 0 11-2 0 1 1 0 012 0zM1.75 14.5a.75.75 0 000 1.5c4.417 0 8.693.603 12.749 1.73 1.111.309 2.251-.512 2.251-1.696v-.784a.75.75 0 00-1.5 0v.784a.272.272 0 01-.35.25A49.043 49.043 0 001.75 14.5z","clip-rule":"evenodd"})],-1),h(" Convertir en facture ",-1)])])):w("",!0)])])]),default:E(()=>{var f;return[e("div",ge,[e("div",we,[e("div",he,[t[23]||(t[23]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Informations")],-1)),e("div",ye,[e("div",qe,[e("div",null,[p(D,{for:"client_id",value:"Client"}),x(e("select",{id:"client_id","onUpdate:modelValue":t[0]||(t[0]=s=>r(v).client_id=s),onChange:T,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(o(!0),a(k,null,g(n.clients,s=>(o(),a("option",{key:s.id,value:s.id},b(s.name),9,Ce))),128))],544),[[A,r(v).client_id]]),p(C,{message:r(v).errors.client_id,class:"mt-2"},null,8,["message"])]),e("div",null,[p(D,{for:"valid_until",value:"Valide jusqu'au"}),x(e("input",{id:"valid_until","onUpdate:modelValue":t[1]||(t[1]=s=>r(v).valid_until=s),onChange:T,type:"date",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,544),[[m,r(v).valid_until]]),p(C,{message:r(v).errors.valid_until,class:"mt-2"},null,8,["message"])])]),e("div",_e,[p(D,{for:"notes",value:"Notes / Conditions"}),x(e("textarea",{id:"notes","onUpdate:modelValue":t[2]||(t[2]=s=>r(v).notes=s),onBlur:T,rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Conditions particuli√®res..."},null,544),[[m,r(v).notes]])])])]),e("div",Me,[t[44]||(t[44]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Lignes du devis")],-1)),e("div",Ve,[(o(!0),a(k,null,g(n.quote.items,(s,$)=>(o(),a("div",{key:s.id,class:"px-6 py-4"},[z.value===s.id?(o(),a("div",Ae,[e("div",ze,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Titre",-1)),x(e("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>r(i).title=d),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[m,r(i).title]]),p(C,{message:r(i).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Description (optionnel)",-1)),x(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=d=>r(i).description=d),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e"},null,512),[[m,r(i).description]]),p(C,{message:r(i).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Le,[e("div",Se,[t[26]||(t[26]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Quantit√©",-1)),x(e("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>r(i).quantity=d),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[m,r(i).quantity,void 0,{number:!0}]])]),e("div",Ue,[t[28]||(t[28]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Unit√©",-1)),x(e("select",{"onUpdate:modelValue":t[6]||(t[6]=d=>r(i).unit=d),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[t[27]||(t[27]=e("option",{value:""},"Sans unit√©",-1)),(o(!0),a(k,null,g(n.units,d=>(o(),a("option",{key:d.value,value:d.value},b(d.label),9,Be))),128))],512),[[A,r(i).unit]])]),e("div",Te,[t[29]||(t[29]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Prix HT",-1)),x(e("input",{"onUpdate:modelValue":t[7]||(t[7]=d=>r(i).unit_price=d),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[m,r(i).unit_price,void 0,{number:!0}]])]),e("div",Fe,[t[30]||(t[30]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"TVA",-1)),n.isVatExempt?(o(),a("div",je," 0% ")):x((o(),a("select",{key:0,"onUpdate:modelValue":t[8]||(t[8]=d=>r(i).vat_rate=d),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(o(!0),a(k,null,g(n.vatRates,d=>(o(),a("option",{key:d.value,value:d.value},b(d.value)+"% ",9,$e))),128))],512)),[[A,r(i).vat_rate,void 0,{number:!0}]])]),e("div",Ee,[e("button",{type:"button",onClick:d=>Z(s.id),disabled:r(i).processing,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...t[31]||(t[31]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,Ie),e("button",{type:"button",onClick:Y,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...t[32]||(t[32]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(o(),a("div",De,[n.quote.items.length>1?(o(),a("div",He,[e("button",{type:"button",onClick:d=>H(s.id,"up"),disabled:$===0,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Monter"},[...t[33]||(t[33]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,Re),e("button",{type:"button",onClick:d=>H(s.id,"down"),disabled:$===n.quote.items.length-1,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Descendre"},[...t[34]||(t[34]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Ne)])):w("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:d=>R(s)},[e("p",Qe,b(s.title),1),s.description?(o(),a("p",Oe,b(s.description),1)):w("",!0),e("p",Ke,b(W(s.quantity))+" "+b(J(s.unit,s.quantity))+" x "+b(M(s.unit_price))+" (TVA "+b(s.vat_rate)+"%) ",1)],8,Pe),e("div",Ge,[e("span",Je,b(M(s.total_ht)),1),e("button",{type:"button",onClick:d=>R(s),class:"p-1 text-slate-400 hover:text-primary-600 dark:hover:text-primary-400",title:"Modifier"},[...t[35]||(t[35]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,We),e("button",{type:"button",onClick:d=>X(s.id),class:"p-1 text-slate-400 hover:text-red-600 dark:hover:text-red-400",title:"Supprimer"},[...t[36]||(t[36]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,Xe)])]))]))),128)),e("form",{onSubmit:ue(G,["prevent"]),class:"px-6 py-4"},[t[43]||(t[43]=e("p",{class:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3"},"Ajouter une ligne",-1)),e("div",Ye,[e("div",Ze,[e("div",null,[x(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>r(u).title=s),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[m,r(u).title]]),p(C,{message:r(u).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[x(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=s=>r(u).description=s),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e (optionnel)"},null,512),[[m,r(u).description]]),p(C,{message:r(u).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",et,[e("div",tt,[t[37]||(t[37]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Quantit√©",-1)),x(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>r(u).quantity=s),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[m,r(u).quantity,void 0,{number:!0}]])]),e("div",st,[t[39]||(t[39]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Unit√©",-1)),x(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>r(u).unit=s),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[t[38]||(t[38]=e("option",{value:""},"Sans unit√©",-1)),(o(!0),a(k,null,g(n.units,s=>(o(),a("option",{key:s.value,value:s.value},b(s.label),9,lt))),128))],512),[[A,r(u).unit]])]),e("div",rt,[t[40]||(t[40]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Prix HT",-1)),x(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>r(u).unit_price=s),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[m,r(u).unit_price,void 0,{number:!0}]])]),e("div",at,[t[41]||(t[41]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"TVA",-1)),n.isVatExempt?(o(),a("div",dt," 0% ")):x((o(),a("select",{key:0,"onUpdate:modelValue":t[14]||(t[14]=s=>r(u).vat_rate=s),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(o(!0),a(k,null,g(n.vatRates,s=>(o(),a("option",{key:s.value,value:s.value},b(s.value)+"% ",9,ot))),128))],512)),[[A,r(u).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:r(u).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[...t[42]||(t[42]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),h(" Ajouter ",-1)])],8,it)])])],32)])])]),e("div",nt,[e("div",ut,[t[48]||(t[48]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"R√©sum√©")],-1)),e("div",ct,[e("div",bt,[t[45]||(t[45]=e("span",{class:"text-slate-500 dark:text-slate-400"},"Total HT",-1)),e("span",xt,b(M(B.value.ht)),1)]),e("div",pt,[t[46]||(t[46]=e("span",{class:"text-slate-500 dark:text-slate-400"},"TVA",-1)),e("span",mt,b(M(B.value.vat)),1)]),e("div",vt,[e("div",ft,[t[47]||(t[47]=e("span",{class:"text-base font-medium text-slate-900 dark:text-white"},"Total TTC",-1)),e("span",kt,b(M(B.value.ttc)),1)])])]),e("div",gt,[e("p",wt,b(((f=n.quote.items)==null?void 0:f.length)||0)+" ligne(s) ",1)])])])]),q.value?(o(),a("div",ht,[e("div",yt,[e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:t[15]||(t[15]=s=>q.value=!1)}),e("div",qt,[e("div",Ct,[t[53]||(t[53]=e("h3",{class:"text-lg font-medium text-slate-900 dark:text-white"}," Aper√ßu du devis ",-1)),e("div",_t,[e("div",Mt,[(o(),a(k,null,g(O,s=>e("button",{key:s.value,type:"button",onClick:$=>ae(s.value),title:s.label,class:I(["px-2 py-1.5 text-base transition-colors",L.value===s.value?"bg-primary-100 dark:bg-primary-900":"bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"])},b(s.flag),11,Vt)),64))]),e("a",{href:K.value,target:"_blank",class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...t[49]||(t[49]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),h(" PDF ",-1)])],8,At),e("button",{type:"button",onClick:F,disabled:_.value,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 disabled:opacity-50"},[(o(),a("svg",{class:I(["h-4 w-4 mr-1",{"animate-spin":_.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...t[50]||(t[50]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),t[51]||(t[51]=h(" Actualiser ",-1))],8,zt),e("button",{type:"button",onClick:t[16]||(t[16]=s=>q.value=!1),class:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"},[...t[52]||(t[52]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Lt,[_.value?(o(),a("div",St,[...t[54]||(t[54]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(o(),a("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:U.value},null,8,Ut))]),e("div",Bt,[e("button",{type:"button",onClick:t[17]||(t[17]=s=>q.value=!1),class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500"}," Fermer ")])])])])):w("",!0)]}),_:1})],64))}};export{Dt as default};
