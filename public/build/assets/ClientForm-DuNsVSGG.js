import{p as F,c as l,b as t,F as k,r as V,n as y,q as b,C as M,t as g,a,d as h,B as A,v as w,w as p,g as B,o as s,u as T,s as D,f as z,A as f,D as j}from"./app-BNdkYu5R.js";import{a as d,_ as n}from"./InputError-j9SVREoo.js";import{P as H}from"./PrimaryButton-CRxPFKvX.js";import{_ as m}from"./TextInput-DK16qsdl.js";import{_ as O}from"./VatScenarioIndicator-DuT__XLE.js";const $={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},G={class:"px-6 py-4"},K={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},W=["value"],X={class:"ml-3"},Y={class:"block text-sm font-medium text-gray-900 dark:text-white"},Z={class:"block text-sm text-gray-500 dark:text-gray-400"},J={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Q={class:"px-6 py-4 space-y-4"},_={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ee={key:0},re={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},te=["value"],oe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ae={key:0,class:"text-amber-600 text-xs font-medium"},le={key:1,class:"text-gray-400 text-xs"},se={key:2,class:"text-gray-400 text-xs"},de={class:"flex items-center justify-between"},ne={class:"text-right"},ie={key:0,class:"mt-3 text-sm text-amber-600 dark:text-amber-400"},ue={key:0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},me={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ce={class:"px-6 py-4 space-y-4"},ge={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},fe=["value"],be=["value"],ye={class:"flex justify-end space-x-3"},ve={key:0},xe={key:1},Be={__name:"ClientForm",props:{form:{type:Object,required:!0},clientTypes:{type:Array,required:!0},currencies:{type:Array,required:!0},countries:{type:Array,required:!0},submitLabel:{type:String,default:"Enregistrer"},cancelRoute:{type:String,default:"clients.index"},cancelRouteParams:{type:[Object,Number,String],default:null},sellerVatRegime:{type:String,default:"franchise"}},emits:["submit"],setup(e,{emit:R}){const C=j(),i=e,S=R,u=f(()=>i.form.type==="b2b"),U=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK"],N=f(()=>U.includes(i.form.country_code)),q=f(()=>i.form.country_code==="LU"),L=f(()=>N.value&&!q.value),E=f(()=>i.form.vat_number&&i.form.vat_number.trim()!==""),v=f(()=>{if(i.sellerVatRegime==="franchise")return{key:"FRANCHISE",label:"Franchise de TVA",description:"Vous êtes exonéré de TVA (régime franchise)",rate:0,mention:"franchise",color:"gray"};const c=i.form.country_code||"LU",r=i.form.type||"b2b";return c==="LU"?{key:r==="b2b"?"B2B_LU":"B2C_LU",label:r==="b2b"?"B2B Luxembourg":"B2C Luxembourg",description:"Client luxembourgeois - TVA à 17%",rate:17,mention:null,color:"green"}:U.includes(c)?r==="b2b"&&E.value?{key:"B2B_INTRA_EU",label:"B2B Intracommunautaire",description:"Autoliquidation - TVA 0%",rate:0,mention:"reverse_charge",color:"blue"}:{key:r==="b2b"?"B2B_LU":"B2C_LU",label:r==="b2b"?"B2B UE (sans TVA)":"B2C UE",description:"TVA Luxembourg applicable (17%)",rate:17,mention:null,color:"yellow"}:{key:"EXPORT",label:"Export hors UE",description:"Exonération - TVA 0%",rate:0,mention:"export",color:"purple"}}),P=f(()=>u.value&&L.value&&!E.value);F(()=>i.form.type,c=>{c==="b2c"&&(i.form.vat_number="")});const I=()=>{S("submit")};return(c,r)=>(s(),l("form",{onSubmit:z(I,["prevent"]),class:"space-y-8"},[t("div",$,[r[14]||(r[14]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Type de client ")],-1)),t("div",G,[t("div",K,[(s(!0),l(k,null,V(e.clientTypes,o=>(s(),l("label",{key:o.value,class:y(["flex items-start p-4 rounded-lg border cursor-pointer transition-colors",[e.form.type===o.value?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"]])},[b(t("input",{type:"radio","onUpdate:modelValue":r[0]||(r[0]=x=>e.form.type=x),value:o.value,class:"mt-0.5 h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,8,W),[[M,e.form.type]]),t("div",X,[t("span",Y,g(o.label),1),t("span",Z,g(o.description),1)])],2))),128))]),a(d,{message:e.form.errors.type,class:"mt-2"},null,8,["message"])])]),t("div",J,[r[19]||(r[19]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Informations du client ")],-1)),t("div",Q,[t("div",_,[t("div",null,[a(n,{for:"name",value:u.value?"Raison sociale":"Nom complet"},null,8,["value"]),a(m,{id:"name",modelValue:e.form.name,"onUpdate:modelValue":r[1]||(r[1]=o=>e.form.name=o),type:"text",class:"mt-1 block w-full",required:"",placeholder:u.value?"Société Exemple SARL":"Marie Durand"},null,8,["modelValue","placeholder"]),a(d,{message:e.form.errors.name,class:"mt-2"},null,8,["message"])]),u.value?(s(),l("div",ee,[a(n,{for:"contact_name",value:"Nom du dirigeant / contact (optionnel)"}),a(m,{id:"contact_name",modelValue:e.form.contact_name,"onUpdate:modelValue":r[2]||(r[2]=o=>e.form.contact_name=o),type:"text",class:"mt-1 block w-full",placeholder:"Pierre Exemple"},null,8,["modelValue"]),a(d,{message:e.form.errors.contact_name,class:"mt-2"},null,8,["message"])])):h("",!0),t("div",null,[a(n,{for:"email",value:"Email"}),a(m,{id:"email",modelValue:e.form.email,"onUpdate:modelValue":r[3]||(r[3]=o=>e.form.email=o),type:"email",class:"mt-1 block w-full",required:"",placeholder:"contact@example.com"},null,8,["modelValue"]),a(d,{message:e.form.errors.email,class:"mt-2"},null,8,["message"])])]),t("div",null,[a(n,{for:"address",value:"Adresse"}),b(t("textarea",{id:"address","onUpdate:modelValue":r[4]||(r[4]=o=>e.form.address=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:"2",placeholder:"10 Rue Fictive"},null,512),[[A,e.form.address]]),a(d,{message:e.form.errors.address,class:"mt-2"},null,8,["message"])]),t("div",re,[t("div",null,[a(n,{for:"postal_code",value:"Code postal"}),a(m,{id:"postal_code",modelValue:e.form.postal_code,"onUpdate:modelValue":r[5]||(r[5]=o=>e.form.postal_code=o),type:"text",class:"mt-1 block w-full",placeholder:"L-2000"},null,8,["modelValue"]),a(d,{message:e.form.errors.postal_code,class:"mt-2"},null,8,["message"])]),t("div",null,[a(n,{for:"city",value:"Ville"}),a(m,{id:"city",modelValue:e.form.city,"onUpdate:modelValue":r[6]||(r[6]=o=>e.form.city=o),type:"text",class:"mt-1 block w-full",placeholder:"Luxembourg"},null,8,["modelValue"]),a(d,{message:e.form.errors.city,class:"mt-2"},null,8,["message"])]),t("div",null,[a(n,{for:"country_code",value:"Pays"}),b(t("select",{id:"country_code","onUpdate:modelValue":r[7]||(r[7]=o=>e.form.country_code=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},[(s(!0),l(k,null,V(e.countries,o=>(s(),l("option",{key:o.code,value:o.code},g(o.name),9,te))),128))],512),[[w,e.form.country_code]]),a(d,{message:e.form.errors.country_code,class:"mt-2"},null,8,["message"])])]),t("div",oe,[t("div",null,[a(n,{for:"phone",value:"Téléphone (optionnel)"}),a(m,{id:"phone",modelValue:e.form.phone,"onUpdate:modelValue":r[8]||(r[8]=o=>e.form.phone=o),type:"tel",class:"mt-1 block w-full",placeholder:"+352 000 000 000"},null,8,["modelValue"]),a(d,{message:e.form.errors.phone,class:"mt-2"},null,8,["message"])]),t("div",null,[a(n,{for:"vat_number"},{default:p(()=>[r[15]||(r[15]=B(" N° TVA intracommunautaire ",-1)),u.value&&L.value?(s(),l("span",ae,"(requis pour autoliquidation)")):u.value?(s(),l("span",le,"(recommandé pour B2B)")):(s(),l("span",se,"(optionnel)"))]),_:1}),a(m,{id:"vat_number",modelValue:e.form.vat_number,"onUpdate:modelValue":r[9]||(r[9]=o=>e.form.vat_number=o),type:"text",class:y(["mt-1 block w-full font-mono uppercase",{"bg-gray-100 dark:bg-gray-600":!u.value}]),placeholder:"LU00000000"},null,8,["modelValue","class"]),a(d,{message:e.form.errors.vat_number,class:"mt-2"},null,8,["message"])])]),t("div",{class:y(["rounded-lg border p-4",[v.value.rate===0?"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-900/20":"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800"]])},[t("div",de,[t("div",null,[r[16]||(r[16]=t("h4",{class:"text-sm font-medium text-gray-900 dark:text-white"}," Scénario TVA détecté ",-1)),a(O,{scenario:v.value,size:"sm",class:"mt-2"},null,8,["scenario"])]),t("div",ne,[t("span",{class:y(["text-2xl font-bold",[v.value.rate===0?"text-blue-600 dark:text-blue-400":"text-gray-900 dark:text-white"]])},g(v.value.rate)+"% ",3),r[17]||(r[17]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Taux TVA",-1))])]),P.value?(s(),l("p",ie,[...r[18]||(r[18]=[t("svg",{class:"inline h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1),B(" Sans numéro de TVA valide, la TVA luxembourgeoise (17%) sera appliquée. ",-1)])])):h("",!0)],2),u.value?(s(),l("div",ue,[t("div",null,[a(n,{for:"registration_number",value:"N° d'identification (RCS / SIRET) (optionnel)"}),a(m,{id:"registration_number",modelValue:e.form.registration_number,"onUpdate:modelValue":r[10]||(r[10]=o=>e.form.registration_number=o),type:"text",class:"mt-1 block w-full font-mono",placeholder:"B000000"},null,8,["modelValue"]),a(d,{message:e.form.errors.registration_number,class:"mt-2"},null,8,["message"])])])):h("",!0)])]),t("div",me,[r[22]||(r[22]=t("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[t("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Paramètres de facturation ")],-1)),t("div",ce,[t("div",ge,[t("div",null,[a(n,{for:"currency",value:"Devise par défaut"}),b(t("select",{id:"currency","onUpdate:modelValue":r[11]||(r[11]=o=>e.form.currency=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},[(s(!0),l(k,null,V(e.currencies,o=>(s(),l("option",{key:o.value,value:o.value},g(o.label),9,fe))),128))],512),[[w,e.form.currency]]),a(d,{message:e.form.errors.currency,class:"mt-2"},null,8,["message"])]),t("div",null,[a(n,{for:"locale",value:"Langue des documents"}),b(t("select",{id:"locale","onUpdate:modelValue":r[12]||(r[12]=o=>e.form.locale=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[(s(!0),l(k,null,V(T(C).props.availableLocales,(o,x)=>(s(),l("option",{key:x,value:x},g(o),9,be))),128))],512),[[w,e.form.locale]]),r[20]||(r[20]=t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Langue utilisée sur les factures et devis pour ce client. ",-1)),a(d,{message:e.form.errors.locale,class:"mt-2"},null,8,["message"])])]),t("div",null,[a(n,{for:"notes",value:"Notes internes (optionnel)"}),b(t("textarea",{id:"notes","onUpdate:modelValue":r[13]||(r[13]=o=>e.form.notes=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",rows:"3",placeholder:"Notes internes sur ce client..."},null,512),[[A,e.form.notes]]),r[21]||(r[21]=t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Ces notes ne seront pas visibles sur les factures. ",-1)),a(d,{message:e.form.errors.notes,class:"mt-2"},null,8,["message"])])])]),t("div",ye,[a(T(D),{href:e.cancelRouteParams?c.route(e.cancelRoute,e.cancelRouteParams):c.route(e.cancelRoute),class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},{default:p(()=>[...r[23]||(r[23]=[B(" Annuler ",-1)])]),_:1},8,["href"]),a(H,{disabled:e.form.processing,class:y({"opacity-25":e.form.processing})},{default:p(()=>[e.form.processing?(s(),l("span",ve,"Enregistrement...")):(s(),l("span",xe,g(e.submitLabel),1))]),_:1},8,["disabled","class"])])],32))}};export{Be as _};
