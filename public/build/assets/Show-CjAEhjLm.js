import{_ as U}from"./AppLayout-CvSNZVsy.js";import{r as _,c as d,a as p,b as l,h as R,i as k,d as t,t as e,o as r,g as c,e as h,l as z,F as w,j as B,x as j,B as F,p as q,K as I}from"./app-VBVMX246.js";import{u as K}from"./useTranslations-B0OnAzZY.js";import"./DropdownLink-C42D9Sln.js";const O={class:"flex items-center justify-between"},G={class:"flex items-center space-x-4"},J={class:"text-xl font-semibold text-slate-900 dark:text-white"},Q={class:"flex items-center space-x-3"},W=["disabled"],X=["disabled"],Y=["disabled"],Z={class:"space-y-6"},tt={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},et={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},st={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},at={class:"text-lg font-medium text-slate-900 dark:text-white"},lt={class:"px-6 py-4"},ot={key:0,class:"text-sm text-slate-700 dark:text-slate-300 space-y-1"},dt={class:"font-semibold"},rt={key:0},nt={key:1,class:"pt-2"},it={class:"text-slate-500"},ct={key:2},ut={class:"text-slate-500"},ht={key:1,class:"text-sm text-slate-500 dark:text-slate-400"},xt={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},mt={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},vt={class:"text-lg font-medium text-slate-900 dark:text-white"},bt={class:"px-6 py-4"},_t={key:0,class:"text-sm text-slate-700 dark:text-slate-300 space-y-1"},ft={class:"font-semibold"},pt={key:0},kt={key:1,class:"pt-2"},gt={class:"text-slate-500"},yt={key:1,class:"text-sm text-slate-700 dark:text-slate-300 space-y-1"},wt={class:"font-semibold"},qt={key:0},Ct={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Lt={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Mt={class:"text-lg font-medium text-slate-900 dark:text-white"},zt={class:"px-6 py-4"},Bt={class:"grid grid-cols-2 gap-4 sm:grid-cols-4"},jt={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},Ft={class:"mt-1 text-sm text-slate-900 dark:text-white"},$t={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},At={class:"mt-1 text-sm text-slate-900 dark:text-white"},Dt={key:0},St={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},Vt={class:"mt-1 text-sm text-slate-900 dark:text-white"},Ht={key:1},Pt={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},Nt={class:"mt-1 text-sm text-slate-900 dark:text-white"},Tt={key:2},Et={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},Ut={class:"mt-1 text-sm text-slate-900 dark:text-white"},Rt={key:3},It={class:"text-sm font-medium text-slate-500 dark:text-slate-400"},Kt={class:"mt-1 text-sm"},Ot={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Gt={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Jt={class:"text-lg font-medium text-slate-900 dark:text-white"},Qt={class:"overflow-x-auto"},Wt={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},Xt={class:"bg-slate-50 dark:bg-slate-700"},Yt={class:"py-3.5 pl-6 pr-3 text-left text-sm font-semibold text-slate-900 dark:text-white"},Zt={class:"px-3 py-3.5 text-right text-sm font-semibold text-slate-900 dark:text-white"},te={class:"px-3 py-3.5 text-right text-sm font-semibold text-slate-900 dark:text-white"},ee={class:"px-3 py-3.5 text-right text-sm font-semibold text-slate-900 dark:text-white"},se={class:"py-3.5 pl-3 pr-6 text-right text-sm font-semibold text-slate-900 dark:text-white"},ae={class:"divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800"},le={class:"py-4 pl-6 pr-3 text-sm"},oe={class:"font-medium text-slate-900 dark:text-white"},de={key:0,class:"text-slate-500 dark:text-slate-400 whitespace-pre-line"},re={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-slate-500 dark:text-slate-400"},ne={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-slate-500 dark:text-slate-400"},ie={class:"whitespace-nowrap px-3 py-4 text-right text-sm text-slate-500 dark:text-slate-400"},ce={class:"whitespace-nowrap py-4 pl-3 pr-6 text-right text-sm font-medium text-slate-900 dark:text-white"},ue={class:"bg-slate-50 dark:bg-slate-700"},he={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-medium text-slate-500 dark:text-slate-400"},xe={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-medium text-slate-900 dark:text-white"},me={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-medium text-slate-500 dark:text-slate-400"},ve={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-medium text-slate-900 dark:text-white"},be={class:"border-t-2 border-slate-300 dark:border-slate-600"},_e={colspan:"4",class:"py-3 pl-6 pr-3 text-right text-sm font-bold text-slate-900 dark:text-white"},fe={class:"whitespace-nowrap py-3 pl-3 pr-6 text-right text-sm font-bold text-slate-900 dark:text-white"},pe={key:0,class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},ke={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},ge={class:"text-lg font-medium text-slate-900 dark:text-white"},ye={class:"px-6 py-4"},we={class:"text-sm text-slate-700 dark:text-slate-300 whitespace-pre-wrap"},qe={key:0,class:"fixed inset-0 z-50 overflow-hidden"},Ce={class:"flex items-center justify-center min-h-screen p-4"},Le={class:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Me={class:"flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700"},ze={class:"text-lg font-medium text-slate-900 dark:text-white"},Be={class:"flex items-center space-x-2"},je={class:"flex items-center border border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden"},Fe=["onClick","title"],$e=["href"],Ae={class:"flex-1 overflow-auto p-6 bg-slate-100 dark:bg-slate-900"},De={key:0,class:"flex items-center justify-center h-96"},Se=["innerHTML"],Ve={class:"flex items-center justify-end px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/50"},Ue={__name:"Show",props:{quote:Object},setup(s){var L,M;const{t:a}=K(),x=s,u=_(!1),m=_(!1),g=_(""),y=_(!1),f=_(((L=x.quote.buyer_snapshot)==null?void 0:L.locale)||((M=x.quote.client)==null?void 0:M.locale)||"fr"),$=[{value:"fr",label:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{value:"de",label:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{value:"en",label:"English",flag:"ðŸ‡¬ðŸ‡§"},{value:"lb",label:"LÃ«tzebuergesch",flag:"ðŸ‡±ðŸ‡º"}],A=F(()=>`${route("quotes.pdf.stream",x.quote.id)}?locale=${f.value}`),C=async()=>{y.value=!0;try{const n=route("quotes.preview-html",x.quote.id)+`?locale=${f.value}`,o=await I.get(n);g.value=o.data.html}catch(n){console.error("Error loading preview:",n),g.value=`<p style="color: red; padding: 20px;">${a("error_loading_preview")}</p>`}finally{y.value=!1}},D=n=>{f.value=n,m.value&&C()},S=()=>{m.value=!0,C()},V=n=>{const o={draft:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return o[n]||o.draft},H=F(()=>({draft:a("draft"),sent:a("sent"),accepted:a("accepted"),declined:a("rejected"),expired:a("expired"),converted:a("converted")})),P=n=>H.value[n]||n,v=(n,o="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:o}).format(n),b=n=>n?new Date(n).toLocaleDateString("fr-FR"):"-",N=()=>{u.value||(u.value=!0,q.post(route("quotes.mark-accepted",x.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))},T=()=>{u.value||(u.value=!0,q.post(route("quotes.mark-declined",x.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))},E=()=>{u.value||confirm(a("convert_quote_confirm"))&&(u.value=!0,q.post(route("quotes.convert",x.quote.id),{},{preserveScroll:!0,onFinish:()=>u.value=!1}))};return(n,o)=>(r(),d(w,null,[p(l(R),{title:`Devis ${s.quote.reference}`},null,8,["title"]),p(U,null,{header:k(()=>[t("div",O,[t("div",G,[p(l(z),{href:n.route("quotes.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:k(()=>[...o[3]||(o[3]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),t("h1",J,e(s.quote.reference),1),t("span",{class:j([V(s.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},e(P(s.quote.status)),3)]),t("div",Q,[t("button",{type:"button",onClick:S,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[o[4]||(o[4]=t("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),t("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),h(" "+e(l(a)("preview")),1)]),s.quote.status==="sent"?(r(),d("button",{key:0,onClick:N,disabled:u.value,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[o[5]||(o[5]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1)),h(" "+e(l(a)("accept")),1)],8,W)):c("",!0),s.quote.status==="sent"?(r(),d("button",{key:1,onClick:T,disabled:u.value,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"},[o[6]||(o[6]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1)),h(" "+e(l(a)("reject")),1)],8,X)):c("",!0),s.quote.status==="accepted"?(r(),d("button",{key:2,onClick:E,disabled:u.value,class:"inline-flex items-center rounded-xl bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500 disabled:opacity-50"},[o[7]||(o[7]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M3 4a2 2 0 00-2 2v1.161l8.441 4.221a1.25 1.25 0 001.118 0L19 7.162V6a2 2 0 00-2-2H3z"}),t("path",{d:"M19 8.839l-7.77 3.885a2.75 2.75 0 01-2.46 0L1 8.839V14a2 2 0 002 2h14a2 2 0 002-2V8.839z"})],-1)),h(" "+e(l(a)("convert_to_invoice")),1)],8,Y)):c("",!0)])])]),default:k(()=>[t("div",Z,[t("div",tt,[t("div",et,[t("div",st,[t("h2",at,e(l(a)("issuer")),1)]),t("div",lt,[s.quote.seller_snapshot?(r(),d("div",ot,[t("p",dt,e(s.quote.seller_snapshot.company_name),1),s.quote.seller_snapshot.legal_name?(r(),d("p",rt,e(s.quote.seller_snapshot.legal_name),1)):c("",!0),t("p",null,e(s.quote.seller_snapshot.address),1),t("p",null,e(s.quote.seller_snapshot.postal_code)+" "+e(s.quote.seller_snapshot.city),1),t("p",null,e(s.quote.seller_snapshot.country),1),s.quote.seller_snapshot.matricule?(r(),d("p",nt,[t("span",it,e(l(a)("matricule"))+":",1),h(" "+e(s.quote.seller_snapshot.matricule),1)])):c("",!0),s.quote.seller_snapshot.vat_number?(r(),d("p",ct,[t("span",ut,e(l(a)("vat_number_short"))+":",1),h(" "+e(s.quote.seller_snapshot.vat_number),1)])):c("",!0)])):(r(),d("div",ht,e(l(a)("seller_info_not_recorded")),1))])]),t("div",xt,[t("div",mt,[t("h2",vt,e(l(a)("client")),1)]),t("div",bt,[s.quote.buyer_snapshot?(r(),d("div",_t,[t("p",ft,e(s.quote.buyer_snapshot.company_name||s.quote.buyer_snapshot.name),1),s.quote.buyer_snapshot.contact_name?(r(),d("p",pt,e(s.quote.buyer_snapshot.contact_name),1)):c("",!0),t("p",null,e(s.quote.buyer_snapshot.address),1),t("p",null,e(s.quote.buyer_snapshot.postal_code)+" "+e(s.quote.buyer_snapshot.city),1),t("p",null,e(s.quote.buyer_snapshot.country),1),s.quote.buyer_snapshot.vat_number?(r(),d("p",kt,[t("span",gt,e(l(a)("vat_number_short"))+":",1),h(" "+e(s.quote.buyer_snapshot.vat_number),1)])):c("",!0)])):s.quote.client?(r(),d("div",yt,[t("p",wt,e(s.quote.client.name),1),s.quote.client.contact_name?(r(),d("p",qt,e(s.quote.client.contact_name),1)):c("",!0),t("p",null,e(s.quote.client.address),1),t("p",null,e(s.quote.client.postal_code)+" "+e(s.quote.client.city),1),t("p",null,e(s.quote.client.country),1)])):c("",!0)])])]),t("div",Ct,[t("div",Lt,[t("h2",Mt,e(l(a)("details")),1)]),t("div",zt,[t("dl",Bt,[t("div",null,[t("dt",jt,e(l(a)("created_at")),1),t("dd",Ft,e(b(s.quote.created_at)),1)]),t("div",null,[t("dt",$t,e(l(a)("valid_until")),1),t("dd",At,e(b(s.quote.valid_until)),1)]),s.quote.sent_at?(r(),d("div",Dt,[t("dt",St,e(l(a)("sent_on")),1),t("dd",Vt,e(b(s.quote.sent_at)),1)])):c("",!0),s.quote.accepted_at?(r(),d("div",Ht,[t("dt",Pt,e(l(a)("accepted_on")),1),t("dd",Nt,e(b(s.quote.accepted_at)),1)])):c("",!0),s.quote.declined_at?(r(),d("div",Tt,[t("dt",Et,e(l(a)("rejected_on")),1),t("dd",Ut,e(b(s.quote.declined_at)),1)])):c("",!0),s.quote.converted_to_invoice_id?(r(),d("div",Rt,[t("dt",It,e(l(a)("converted_to_invoice")),1),t("dd",Kt,[p(l(z),{href:n.route("invoices.show",s.quote.converted_to_invoice_id),class:"text-primary-600 hover:text-primary-500 dark:text-primary-400"},{default:k(()=>[h(e(l(a)("see_invoice")),1)]),_:1},8,["href"])])])):c("",!0)])])]),t("div",Ot,[t("div",Gt,[t("h2",Jt,e(l(a)("quote_lines")),1)]),t("div",Qt,[t("table",Wt,[t("thead",Xt,[t("tr",null,[t("th",Yt,e(l(a)("description")),1),t("th",Zt,e(l(a)("qty")),1),t("th",te,e(l(a)("price_ht")),1),t("th",ee,e(l(a)("vat")),1),t("th",se,e(l(a)("total_ht")),1)])]),t("tbody",ae,[(r(!0),d(w,null,B(s.quote.items,i=>(r(),d("tr",{key:i.id},[t("td",le,[t("div",oe,e(i.title),1),i.description?(r(),d("div",de,e(i.description),1)):c("",!0)]),t("td",re,e(i.quantity),1),t("td",ne,e(v(i.unit_price,s.quote.currency)),1),t("td",ie,e(i.vat_rate)+"% ",1),t("td",ce,e(v(i.total_ht,s.quote.currency)),1)]))),128))]),t("tfoot",ue,[t("tr",null,[t("td",he,e(l(a)("total_ht")),1),t("td",xe,e(v(s.quote.total_ht,s.quote.currency)),1)]),t("tr",null,[t("td",me,e(l(a)("total_vat")),1),t("td",ve,e(v(s.quote.total_vat,s.quote.currency)),1)]),t("tr",be,[t("td",_e,e(l(a)("total_ttc")),1),t("td",fe,e(v(s.quote.total_ttc,s.quote.currency)),1)])])])])]),s.quote.notes?(r(),d("div",pe,[t("div",ke,[t("h2",ge,e(l(a)("notes")),1)]),t("div",ye,[t("p",we,e(s.quote.notes),1)])])):c("",!0)]),m.value?(r(),d("div",qe,[t("div",Ce,[t("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:o[0]||(o[0]=i=>m.value=!1)}),t("div",Le,[t("div",Me,[t("h3",ze,e(s.quote.reference),1),t("div",Be,[t("div",je,[(r(),d(w,null,B($,i=>t("button",{key:i.value,type:"button",onClick:He=>D(i.value),title:i.label,class:j(["px-2 py-1.5 text-base transition-colors",f.value===i.value?"bg-primary-100 dark:bg-primary-900":"bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"])},e(i.flag),11,Fe)),64))]),t("a",{href:A.value,target:"_blank",class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...o[8]||(o[8]=[t("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),t("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),h(" PDF ",-1)])],8,$e),t("button",{type:"button",onClick:o[1]||(o[1]=i=>m.value=!1),class:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"},[...o[9]||(o[9]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),t("div",Ae,[y.value?(r(),d("div",De,[...o[10]||(o[10]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(r(),d("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:g.value},null,8,Se))]),t("div",Ve,[t("button",{type:"button",onClick:o[2]||(o[2]=i=>m.value=!1),class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500"},e(l(a)("close")),1)])])])])):c("",!0)]),_:1})],64))}};export{Ue as default};
