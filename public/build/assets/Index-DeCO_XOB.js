import{r as c,z as W,c as i,a as w,b as a,h as X,i as h,d as e,f as U,t as l,o as n,F as g,j as y,k as D,l as v,e as _,g as x,x as C,m as F,p as E,B as Y,H as Z}from"./app-CCfNw5_2.js";import{_ as ee}from"./AppLayout-C5Yc7w9R.js";import{u as te}from"./useTranslations-CUaV1VvB.js";import"./ApplicationLogo-D_NVnA7Z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-CMdmUlDG.js";const re={class:"flex items-center justify-between"},se={class:"text-xl font-semibold text-gray-900 dark:text-white"},ae={class:"mb-6 flex flex-wrap gap-4"},oe={value:""},le=["value"],ne={value:""},ie=["value"],de={value:""},ue=["value"],ce={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ge={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},he={class:"bg-gray-50 dark:bg-gray-700"},xe={class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white sm:pl-6"},fe={class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"},ye={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white md:table-cell"},ve={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white lg:table-cell"},pe={class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"},me={class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"},ke={class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},be={class:"sr-only"},we={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},_e={key:0},Ce={colspan:"7",class:"py-10 text-center text-sm text-gray-500 dark:text-gray-400"},ze={class:"mt-2"},Me={class:"whitespace-nowrap py-4 pl-4 pr-3 sm:pl-6"},Le={key:0,class:"text-red-600 dark:text-red-400"},je={key:0,class:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-[200px]"},Be={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400"},Ve={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 md:table-cell"},Fe={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 lg:table-cell"},He={class:"whitespace-nowrap px-3 py-4 text-sm"},Ae={key:0,class:"inline-flex relative"},Se=["value","onChange","disabled"],Ne=["value"],Ue=["value"],De={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},Pe={class:"flex items-center justify-end gap-5"},$e=["onClick","title"],Te=["href","title"],Ee={class:"text-sm"},Ie={key:0,class:"mt-6 flex items-center justify-between"},Re={class:"text-sm text-gray-700 dark:text-gray-400"},Oe={class:"isolate inline-flex -space-x-px rounded-md shadow-sm"},qe={key:1,class:"fixed inset-0 z-50 overflow-hidden"},Ge={class:"flex items-center justify-center min-h-screen p-4"},Je={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Ke={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Qe={class:"text-lg font-medium text-gray-900 dark:text-white"},We={key:0,class:"text-red-600 dark:text-red-400"},Xe={class:"flex items-center space-x-2"},Ye={class:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden"},Ze=["onClick","title"],et=["href"],tt={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},rt={key:0,class:"flex items-center justify-center h-96"},st=["innerHTML"],at={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},gt={__name:"Index",props:{invoices:Object,filters:Object,statuses:Array,years:Array,clients:Array},setup(d){const{t:o}=te(),H=d,z=c(H.filters.status||""),M=c(H.filters.year||""),L=c(H.filters.client_id||""),j=c(!1),B=c(""),A=c(!1),u=c(null),m=c("fr"),I=[{value:"fr",label:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{value:"de",label:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{value:"en",label:"English",flag:"ðŸ‡¬ðŸ‡§"},{value:"lb",label:"LÃ«tzebuergesch",flag:"ðŸ‡±ðŸ‡º"}],R=Y(()=>u.value?`${u.value.status==="draft"?route("invoices.draft-pdf",u.value.id):route("invoices.pdf.stream",u.value.id)}?locale=${m.value}`:""),P=async()=>{if(u.value){A.value=!0;try{const s=u.value.status==="draft"?"invoices.preview-draft":"invoices.preview-html",r=route(s,u.value.id)+`?locale=${m.value}`,k=await Z.get(r);B.value=k.data.html}catch(s){console.error("Error loading preview:",s),B.value=`<p style="color: red; padding: 20px;">${o("error_loading_preview")}</p>`}finally{A.value=!1}}},O=s=>{m.value=s,j.value&&P()},q=async s=>{var r;u.value=s,m.value=((r=s.client)==null?void 0:r.locale)||"fr",j.value=!0,P()},S=()=>{j.value=!1,B.value="",u.value=null};W([z,M,L],()=>{E.get(route("invoices.index"),{status:z.value||void 0,year:M.value||void 0,client_id:L.value||void 0},{preserveState:!0,replace:!0})});const $=s=>{const r={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",finalized:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",sent:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"};return r[s]||r.draft},N=s=>({draft:o("draft"),finalized:o("finalized"),sent:o("sent"),paid:o("paid"),cancelled:o("cancelled")})[s]||s,G=(s,r="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:r}).format(s),T=s=>s?new Date(s).toLocaleDateString("fr-FR"):"-",V=c(null),J=s=>({finalized:["sent","paid"],sent:["paid"]})[s]||[],K=s=>["finalized","sent"].includes(s.status),Q=(s,r)=>{V.value=s.id;const b={sent:"invoices.mark-sent",paid:"invoices.mark-paid"}[r];b&&E.post(route(b,s.id),{},{preserveScroll:!0,onFinish:()=>{V.value=null}})};return(s,r)=>(n(),i(g,null,[w(a(X),{title:a(o)("invoices")},null,8,["title"]),w(ee,null,{header:h(()=>[e("div",re,[e("h1",se,l(a(o)("invoices")),1),w(a(v),{href:s.route("invoices.create"),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},{default:h(()=>[r[3]||(r[3]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),_(" "+l(a(o)("new_invoice")),1)]),_:1},8,["href"])])]),default:h(()=>{var k,b;return[e("div",ae,[U(e("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>z.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",oe,l(a(o)("all_statuses")),1),(n(!0),i(g,null,y(d.statuses,t=>(n(),i("option",{key:t.value,value:t.value},l(t.label),9,le))),128))],512),[[D,z.value]]),U(e("select",{"onUpdate:modelValue":r[1]||(r[1]=t=>M.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",ne,l(a(o)("all_years")),1),(n(!0),i(g,null,y(d.years,t=>(n(),i("option",{key:t,value:t},l(t),9,ie))),128))],512),[[D,M.value]]),U(e("select",{"onUpdate:modelValue":r[2]||(r[2]=t=>L.value=t),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[e("option",de,l(a(o)("all_clients")),1),(n(!0),i(g,null,y(d.clients,t=>(n(),i("option",{key:t.id,value:t.id},l(t.name),9,ue))),128))],512),[[D,L.value]])]),e("div",ce,[e("table",ge,[e("thead",he,[e("tr",null,[e("th",xe,l(a(o)("number")),1),e("th",fe,l(a(o)("client")),1),e("th",ye,l(a(o)("date")),1),e("th",ve,l(a(o)("due_date")),1),e("th",pe,l(a(o)("total"))+" "+l(a(o)("ttc")),1),e("th",me,l(a(o)("status")),1),e("th",ke,[e("span",be,l(a(o)("actions")),1)])])]),e("tbody",we,[d.invoices.data.length===0?(n(),i("tr",_e,[e("td",Ce,[r[4]||(r[4]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("p",ze,l(a(o)("no_invoices")),1),w(a(v),{href:s.route("invoices.create"),class:"mt-4 inline-flex items-center text-indigo-600 hover:text-indigo-500 dark:text-indigo-400"},{default:h(()=>[_(l(a(o)("create_first_invoice")),1)]),_:1},8,["href"])])])):x("",!0),(n(!0),i(g,null,y(d.invoices.data,t=>{var f;return n(),i("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",Me,[w(a(v),{href:t.status==="draft"?s.route("invoices.edit",t.id):s.route("invoices.show",t.id),class:"font-medium text-gray-900 hover:text-indigo-600 dark:text-white dark:hover:text-indigo-400"},{default:h(()=>[t.type==="credit_note"?(n(),i("span",Le," NC- ")):x("",!0),_(" "+l(t.number||a(o)("draft").toUpperCase()),1)]),_:2},1032,["href"]),t.title?(n(),i("p",je,l(t.title),1)):x("",!0)]),e("td",Be,l((f=t.client)==null?void 0:f.name),1),e("td",Ve,l(T(t.issued_at)),1),e("td",Fe,l(T(t.due_at)),1),e("td",{class:C(["whitespace-nowrap px-3 py-4 text-right text-sm font-medium",t.type==="credit_note"?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-white"])},l(G(t.total_ttc,t.currency)),3),e("td",He,[K(t)?(n(),i("div",Ae,[e("select",{value:t.status,onChange:p=>Q(t,p.target.value),disabled:V.value===t.id,class:C([$(t.status),"appearance-none cursor-pointer rounded-full pl-2.5 pr-6 py-0.5 text-xs font-medium border-0 focus:ring-2 focus:ring-indigo-500",V.value===t.id?"opacity-50":""])},[e("option",{value:t.status},l(N(t.status)),9,Ne),(n(!0),i(g,null,y(J(t.status),p=>(n(),i("option",{key:p,value:p}," â†’ "+l(N(p)),9,Ue))),128))],42,Se)])):(n(),i("span",{key:1,class:C([$(t.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},l(N(t.status)),3))]),e("td",De,[e("div",Pe,[e("button",{type:"button",onClick:p=>q(t),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",title:a(o)("preview")},[...r[5]||(r[5]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.573-3.007-9.963-7.178z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,$e),e("a",{href:t.status==="draft"?s.route("invoices.draft-pdf",t.id):s.route("invoices.pdf.stream",t.id),target:"_blank",class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",title:a(o)("download_pdf")},[...r[6]||(r[6]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})],-1)])],8,Te),t.status==="draft"?(n(),F(a(v),{key:0,href:s.route("invoices.edit",t.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:a(o)("edit")},{default:h(()=>[...r[7]||(r[7]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})],-1)])]),_:1},8,["href","title"])):(n(),F(a(v),{key:1,href:s.route("invoices.show",t.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:a(o)("view")},{default:h(()=>[...r[8]||(r[8]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})],-1)])]),_:1},8,["href","title"])),t.status==="draft"?(n(),F(a(v),{key:2,href:s.route("invoices.finalize",t.id),method:"post",as:"button",class:"inline-flex items-center gap-1 text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:a(o)("finalize")},{default:h(()=>[r[9]||(r[9]=e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",Ee,l(a(o)("finalize")),1)]),_:1},8,["href","title"])):x("",!0)])])])}),128))])])]),d.invoices.links&&d.invoices.links.length>3?(n(),i("div",Ie,[e("div",Re,l(a(o)("showing_x_to_y_of_z",{from:d.invoices.from,to:d.invoices.to,total:d.invoices.total,items:a(o)("invoices").toLowerCase()})),1),e("nav",Oe,[(n(!0),i(g,null,y(d.invoices.links,(t,f)=>(n(),i(g,{key:f},[t.url?(n(),F(a(v),{key:0,href:t.url,class:C([t.active?"z-10 bg-indigo-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:text-gray-300 dark:ring-gray-600 dark:hover:bg-gray-700","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20",f===0?"rounded-l-md":"",f===d.invoices.links.length-1?"rounded-r-md":""]),innerHTML:t.label,"preserve-scroll":""},null,8,["href","class","innerHTML"])):x("",!0)],64))),128))])])):x("",!0),j.value?(n(),i("div",qe,[e("div",Ge,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:S}),e("div",Je,[e("div",Ke,[e("h3",Qe,[((k=u.value)==null?void 0:k.type)==="credit_note"?(n(),i("span",We,"NC-")):x("",!0),_(l(((b=u.value)==null?void 0:b.number)||a(o)("draft")),1)]),e("div",Xe,[e("div",Ye,[(n(),i(g,null,y(I,t=>e("button",{key:t.value,type:"button",onClick:f=>O(t.value),title:t.label,class:C(["px-2 py-1.5 text-base transition-colors",m.value===t.value?"bg-indigo-100 dark:bg-indigo-900":"bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},l(t.flag),11,Ze)),64))]),e("a",{href:R.value,target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...r[10]||(r[10]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),_(" PDF ",-1)])],8,et),e("button",{type:"button",onClick:S,class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...r[11]||(r[11]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",tt,[A.value?(n(),i("div",rt,[...r[12]||(r[12]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(n(),i("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:B.value},null,8,st))]),e("div",at,[e("button",{type:"button",onClick:S,class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"},l(a(o)("close")),1)])])])])):x("",!0)]}),_:1})],64))}};export{gt as default};
