import{u as q,r as N,c as n,a as d,b as t,h as R,i as x,d as e,w as T,t as o,f as u,v,o as i,F as f,j as g,k,s as E,g as y,e as F,l as j,B as C}from"./app-BscPlTF8.js";import{_ as L}from"./AppLayout-DflfC80w.js";import{_ as m,a as p}from"./InputError-C4pdGA5n.js";import{_ as $}from"./PrimaryButton-BE961Ipk.js";import{u as D}from"./useTranslations-DQDh3TgL.js";import"./DropdownLink-De3XmeDu.js";const S={class:"flex items-center space-x-4"},z={class:"text-xl font-semibold text-slate-900 dark:text-white"},H={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},I={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},O={class:"text-lg font-medium text-slate-900 dark:text-white"},P={class:"px-6 py-4"},G={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},J=["placeholder"],K={class:"sm:col-span-2"},Q={value:""},W=["value"],X={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Y={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Z={class:"text-lg font-medium text-slate-900 dark:text-white"},ee={class:"px-6 py-4"},te={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},se={class:"relative mt-1"},ae=["value"],le={class:"mt-1 rounded-xl bg-slate-50 dark:bg-slate-700 px-4 py-3 text-sm"},re={class:"flex justify-between"},oe={class:"text-slate-500 dark:text-slate-400"},de={class:"font-medium text-slate-900 dark:text-white"},ne={class:"flex justify-between mt-1"},ie={class:"text-slate-500 dark:text-slate-400"},ce={class:"font-medium text-slate-900 dark:text-white"},ue={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},me={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},pe={class:"text-lg font-medium text-slate-900 dark:text-white"},_e={class:"px-6 py-4"},he={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},xe={value:""},ve=["value"],fe=["placeholder"],be={class:"sm:col-span-2"},ge=["placeholder"],ke={class:"sm:col-span-2"},ye={class:"flex items-center"},we={for:"is_deductible",class:"ml-2 block text-sm text-slate-900 dark:text-white"},Ve={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Fe={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},je={class:"text-lg font-medium text-slate-900 dark:text-white"},Ce={class:"px-6 py-4"},Ue={key:0,class:"mb-4 p-4 rounded-2xl bg-slate-50 dark:bg-slate-700 flex items-center justify-between"},Ae={class:"flex items-center"},Me={class:"ml-3"},Be={class:"text-sm font-medium text-slate-900 dark:text-white"},qe=["href"],Ne={key:1,class:"flex items-center justify-center w-full"},Re={for:"attachment",class:"flex flex-col items-center justify-center w-full h-32 border-2 border-slate-300 border-dashed rounded-2xl cursor-pointer bg-slate-50 hover:bg-slate-100 dark:border-slate-600 dark:bg-slate-700 dark:hover:bg-slate-600"},Te={class:"flex flex-col items-center justify-center pt-5 pb-6"},Ee={class:"mb-2 text-sm text-slate-500 dark:text-slate-400"},Le={class:"font-semibold"},$e={class:"text-xs text-slate-500 dark:text-slate-400"},De={key:2,class:"mt-3 text-sm text-slate-600 dark:text-slate-400"},Se={class:"flex justify-end space-x-3"},ze={key:0},He={key:1},Qe={__name:"Edit",props:{expense:Object,categories:Array,vatRates:Array,paymentMethods:Array},setup(_){const{t:a}=D(),c=_,s=q({date:c.expense.date,provider_name:c.expense.provider_name,category:c.expense.category,amount_ht:c.expense.amount_ht,vat_rate:parseFloat(c.expense.vat_rate),description:c.expense.description||"",is_deductible:c.expense.is_deductible,payment_method:c.expense.payment_method||"",reference:c.expense.reference||"",attachment:null,remove_attachment:!1}),b=N(!!c.expense.attachment_url),w=C(()=>!s.amount_ht||!s.vat_rate?0:(parseFloat(s.amount_ht)*parseFloat(s.vat_rate)/100).toFixed(2)),U=C(()=>s.amount_ht?(parseFloat(s.amount_ht)+parseFloat(w.value)).toFixed(2):0),V=h=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(h),A=h=>{s.attachment=h.target.files[0],s.remove_attachment=!1},M=()=>{s.remove_attachment=!0,b.value=!1,s.attachment=null},B=()=>{s.post(route("expenses.update",c.expense.id),{forceFormData:!0,_method:"PUT"})};return(h,r)=>(i(),n(f,null,[d(t(R),{title:t(a)("edit_expense")},null,8,["title"]),d(L,null,{header:x(()=>[e("div",S,[d(t(j),{href:h.route("expenses.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:x(()=>[...r[9]||(r[9]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",z,o(t(a)("edit_expense")),1)])]),default:x(()=>[e("form",{onSubmit:T(B,["prevent"]),class:"space-y-6"},[e("div",H,[e("div",I,[e("h2",O,o(t(a)("information")),1)]),e("div",P,[e("div",G,[e("div",null,[d(m,{for:"date",value:t(a)("date")},null,8,["value"]),u(e("input",{id:"date","onUpdate:modelValue":r[0]||(r[0]=l=>t(s).date=l),type:"date",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,512),[[v,t(s).date]]),d(p,{message:t(s).errors.date,class:"mt-2"},null,8,["message"])]),e("div",null,[d(m,{for:"provider_name",value:t(a)("supplier")},null,8,["value"]),u(e("input",{id:"provider_name","onUpdate:modelValue":r[1]||(r[1]=l=>t(s).provider_name=l),type:"text",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(a)("example_provider"),required:""},null,8,J),[[v,t(s).provider_name]]),d(p,{message:t(s).errors.provider_name,class:"mt-2"},null,8,["message"])]),e("div",K,[d(m,{for:"category",value:t(a)("category")},null,8,["value"]),u(e("select",{id:"category","onUpdate:modelValue":r[2]||(r[2]=l=>t(s).category=l),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[e("option",Q,o(t(a)("select_category")),1),(i(!0),n(f,null,g(_.categories,l=>(i(),n("option",{key:l.value,value:l.value},o(l.label),9,W))),128))],512),[[k,t(s).category]]),d(p,{message:t(s).errors.category,class:"mt-2"},null,8,["message"])])])])]),e("div",X,[e("div",Y,[e("h2",Z,o(t(a)("calculated_amounts")),1)]),e("div",ee,[e("div",te,[e("div",null,[d(m,{for:"amount_ht",value:t(a)("amount_ht")},null,8,["value"]),e("div",se,[u(e("input",{id:"amount_ht","onUpdate:modelValue":r[3]||(r[3]=l=>t(s).amount_ht=l),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 pr-12 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"0.00",required:""},null,512),[[v,t(s).amount_ht]]),r[10]||(r[10]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},[e("span",{class:"text-slate-500 dark:text-slate-400"},"EUR")],-1))]),d(p,{message:t(s).errors.amount_ht,class:"mt-2"},null,8,["message"])]),e("div",null,[d(m,{for:"vat_rate",value:t(a)("vat_rate_label")},null,8,["value"]),u(e("select",{id:"vat_rate","onUpdate:modelValue":r[4]||(r[4]=l=>t(s).vat_rate=l),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(i(!0),n(f,null,g(_.vatRates,l=>(i(),n("option",{key:l.value,value:l.value},o(l.label),9,ae))),128))],512),[[k,t(s).vat_rate,void 0,{number:!0}]]),d(p,{message:t(s).errors.vat_rate,class:"mt-2"},null,8,["message"])]),e("div",null,[d(m,{value:t(a)("calculated_amounts")},null,8,["value"]),e("div",le,[e("div",re,[e("span",oe,o(t(a)("vat"))+":",1),e("span",de,o(V(w.value)),1)]),e("div",ne,[e("span",ie,o(t(a)("ttc"))+":",1),e("span",ce,o(V(U.value)),1)])])])])])]),e("div",ue,[e("div",me,[e("h2",pe,o(t(a)("additional_info")),1)]),e("div",_e,[e("div",he,[e("div",null,[d(m,{for:"payment_method",value:t(a)("payment_method_optional")},null,8,["value"]),u(e("select",{id:"payment_method","onUpdate:modelValue":r[5]||(r[5]=l=>t(s).payment_method=l),class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[e("option",xe,o(t(a)("select")),1),(i(!0),n(f,null,g(_.paymentMethods,l=>(i(),n("option",{key:l.value,value:l.value},o(l.label),9,ve))),128))],512),[[k,t(s).payment_method]]),d(p,{message:t(s).errors.payment_method,class:"mt-2"},null,8,["message"])]),e("div",null,[d(m,{for:"reference",value:t(a)("invoice_reference_optional")},null,8,["value"]),u(e("input",{id:"reference","onUpdate:modelValue":r[6]||(r[6]=l=>t(s).reference=l),type:"text",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(a)("example_ref")},null,8,fe),[[v,t(s).reference]]),d(p,{message:t(s).errors.reference,class:"mt-2"},null,8,["message"])]),e("div",be,[d(m,{for:"description",value:t(a)("description_optional")},null,8,["value"]),u(e("textarea",{id:"description","onUpdate:modelValue":r[7]||(r[7]=l=>t(s).description=l),rows:"3",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(a)("expense_notes")},null,8,ge),[[v,t(s).description]]),d(p,{message:t(s).errors.description,class:"mt-2"},null,8,["message"])]),e("div",ke,[e("div",ye,[u(e("input",{id:"is_deductible","onUpdate:modelValue":r[8]||(r[8]=l=>t(s).is_deductible=l),type:"checkbox",class:"h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700"},null,512),[[E,t(s).is_deductible]]),e("label",we,o(t(a)("expense_deductible")),1)])])])])]),e("div",Ve,[e("div",Fe,[e("h2",je,o(t(a)("receipt_attachment")),1)]),e("div",Ce,[b.value?(i(),n("div",Ue,[e("div",Ae,[r[11]||(r[11]=e("svg",{class:"h-8 w-8 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)),e("div",Me,[e("p",Be,o(_.expense.attachment_filename),1),e("a",{href:_.expense.attachment_url,target:"_blank",class:"text-xs text-primary-600 hover:text-primary-500 dark:text-primary-400"},o(t(a)("view_file")),9,qe)])]),e("button",{type:"button",onClick:M,class:"text-red-600 hover:text-red-500 dark:text-red-400"},[...r[12]||(r[12]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])])])):y("",!0),b.value?y("",!0):(i(),n("div",Ne,[e("label",Re,[e("div",Te,[r[13]||(r[13]=e("svg",{class:"w-8 h-8 mb-3 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),e("p",Ee,[e("span",Le,o(t(a)("click_to_upload")),1),F(" "+o(t(a)("drag_drop")),1)]),e("p",$e,o(t(a)("file_types_allowed")),1)]),e("input",{id:"attachment",type:"file",class:"hidden",accept:".pdf,.jpg,.jpeg,.png,.webp",onChange:A},null,32)])])),t(s).attachment?(i(),n("div",De,o(t(a)("new_file_selected"))+" "+o(t(s).attachment.name),1)):y("",!0),d(p,{message:t(s).errors.attachment,class:"mt-2"},null,8,["message"])])]),e("div",Se,[d(t(j),{href:h.route("expenses.index"),class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},{default:x(()=>[F(o(t(a)("cancel")),1)]),_:1},8,["href"]),d($,{disabled:t(s).processing},{default:x(()=>[t(s).processing?(i(),n("span",ze,o(t(a)("saving")),1)):(i(),n("span",He,o(t(a)("save")),1))]),_:1},8,["disabled"])])],32)]),_:1})],64))}};export{Qe as default};
