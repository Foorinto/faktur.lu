import{r as z,u as E,c as a,a as p,b as l,h as ne,i as D,d as e,f as b,o,F as k,j as g,t as m,k as C,v,g as w,w as ue,e as h,x as I,l as ce,p as y,B as N,K as me}from"./app-BnwxtZv5.js";import{_ as be}from"./AppLayout-CxvVj1Z5.js";import{_ as M}from"./InputError-BTq4n7KK.js";import{_ as V}from"./InputLabel-BmaEP7h2.js";import"./DropdownLink-C__TNu2U.js";import"./useTranslations-XGH72HYp.js";const xe={class:"flex items-center justify-between"},pe={class:"flex items-center space-x-4"},ve={class:"text-xl font-semibold text-slate-900 dark:text-white"},fe={class:"flex items-center space-x-3"},ke=["disabled"],ge={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},we={class:"lg:col-span-2 space-y-6"},he={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},ye={class:"px-6 py-4"},_e={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},qe=["value"],Ce={class:"mt-4"},Me={class:"mt-4"},Ve=["value"],Ae={key:0,class:"mt-4"},Se={class:"mt-4"},ze=["placeholder"],Le={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},Ue={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},Be={class:"divide-y divide-slate-200 dark:divide-slate-700"},Te={key:0,class:"space-y-3"},Fe={class:"grid grid-cols-1 gap-3"},$e={class:"flex flex-wrap gap-3 items-end"},je={class:"w-20"},Ee={class:"w-28"},De=["value"],Ie={class:"w-28"},He={class:"w-28"},Pe=["value"],Re={key:1,class:"block w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-slate-500 dark:border-slate-600 dark:bg-slate-600 dark:text-slate-400 text-sm"},Ne={class:"flex space-x-2"},Qe=["onClick","disabled"],Oe={key:1,class:"flex items-center justify-between"},Ke={key:0,class:"flex flex-col mr-3"},Ge=["onClick","disabled"],Je=["onClick","disabled"],We=["onClick"],Xe={class:"text-sm font-medium text-slate-900 dark:text-white"},Ye={key:0,class:"text-sm text-slate-500 dark:text-slate-400 whitespace-pre-line"},Ze={class:"text-xs text-slate-400 dark:text-slate-500 mt-1"},et={class:"flex items-center space-x-2"},tt={class:"text-sm font-medium text-slate-900 dark:text-white mr-2"},st=["onClick"],lt=["onClick"],rt={class:"space-y-3"},at={class:"grid grid-cols-1 gap-3"},ot={class:"flex flex-wrap gap-3 items-end"},dt={class:"w-20"},it={class:"w-28"},nt=["value"],ut={class:"w-28"},ct={class:"w-28"},mt=["value"],bt={key:1,class:"block w-full rounded-xl border border-slate-300 bg-slate-100 px-3 py-2 text-slate-500 dark:border-slate-600 dark:bg-slate-600 dark:text-slate-400 text-sm"},xt=["disabled"],pt={class:"space-y-6"},vt={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800 sticky top-20"},ft={class:"px-6 py-4 space-y-3"},kt={class:"flex justify-between text-sm"},gt={class:"font-medium text-slate-900 dark:text-white"},wt={class:"flex justify-between text-sm"},ht={class:"font-medium text-slate-900 dark:text-white"},yt={class:"border-t border-slate-200 dark:border-slate-700 pt-3"},_t={class:"flex justify-between"},qt={class:"text-lg font-bold text-slate-900 dark:text-white"},Ct={class:"px-6 py-4 bg-slate-50 dark:bg-slate-700/50"},Mt={class:"text-xs text-slate-500 dark:text-slate-400"},Vt={key:0,class:"fixed inset-0 z-50 overflow-hidden"},At={class:"flex items-center justify-center min-h-screen p-4"},St={class:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},zt={class:"flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Lt={class:"flex items-center space-x-2"},Ut={class:"flex items-center border border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden"},Bt=["onClick","title"],Tt=["href"],Ft=["disabled"],$t={class:"flex-1 overflow-auto p-6 bg-slate-100 dark:bg-slate-900"},jt={key:0,class:"flex items-center justify-center h-96"},Et=["innerHTML"],Dt={class:"flex items-center justify-end px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/50"},Ot={__name:"Edit",props:{quote:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean,vatMentionOptions:Array,defaultVatMention:String,suggestedVatMention:String,defaultQuoteFooter:String},setup(d){var R;const u=d,B=u.isVatExempt?0:17,Q=r=>{if(!r)return"";const t=new Date(r);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]},_=z(!1),T=z(""),A=z(!1),L=z(null),U=z(((R=u.quote.client)==null?void 0:R.locale)||"fr"),O=[{value:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{value:"de",label:"Deutsch",flag:"üá©üá™"},{value:"en",label:"English",flag:"üá¨üáß"},{value:"lb",label:"L√´tzebuergesch",flag:"üá±üá∫"}],K=N(()=>`${route("quotes.pdf.stream",u.quote.id)}?locale=${U.value}`),n=E({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:B}),x=E({client_id:u.quote.client_id,valid_until:Q(u.quote.valid_until),notes:u.quote.notes||"",currency:u.quote.currency,vat_mention:u.quote.vat_mention||"",custom_vat_mention:u.quote.custom_vat_mention||"",footer_message:u.quote.footer_message||""}),c=E({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:B}),F=N(()=>{let r=0,t=0;for(const f of u.quote.items||[])r+=parseFloat(f.total_ht)||0,t+=parseFloat(f.total_vat)||0;return{ht:r,vat:t,ttc:r+t}}),S=r=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:u.quote.currency||"EUR"}).format(r),q=()=>{x.put(route("quotes.update",u.quote.id),{preserveScroll:!0})},G=()=>{c.post(route("quotes.items.store",u.quote.id),{preserveScroll:!0,onSuccess:()=>{c.reset(),c.title="",c.description="",c.quantity=1,c.unit="hour",c.vat_rate=B}})},J=(r,t)=>{const f={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unit√©",plural:"unit√©s"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!r||!f[r]?"":t<=1?f[r].singular:f[r].plural},W=r=>{const t=parseFloat(r);return t===Math.floor(t)?Math.floor(t).toString():t.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},H=(r,t)=>{y.patch(route("quotes.items.move",[u.quote.id,r]),{direction:t},{preserveScroll:!0})},X=r=>{confirm("Supprimer cette ligne ?")&&y.delete(route("quotes.items.destroy",[u.quote.id,r]),{preserveScroll:!0})},P=r=>{L.value=r.id,n.title=r.title,n.description=r.description||"",n.quantity=parseFloat(r.quantity),n.unit=r.unit||"",n.unit_price=parseFloat(r.unit_price),n.vat_rate=parseFloat(r.vat_rate)},Y=()=>{L.value=null,n.reset()},Z=r=>{n.put(route("quotes.items.update",[u.quote.id,r]),{preserveScroll:!0,onSuccess:()=>{L.value=null,n.reset()}})},ee=()=>{confirm("Supprimer ce devis ?")&&y.delete(route("quotes.destroy",u.quote.id))},te=()=>{y.post(route("quotes.mark-sent",u.quote.id),{},{preserveScroll:!0})},se=()=>{y.post(route("quotes.mark-accepted",u.quote.id),{},{preserveScroll:!0})},le=()=>{y.post(route("quotes.mark-declined",u.quote.id),{},{preserveScroll:!0})},re=()=>{confirm("Convertir ce devis en facture ? Une nouvelle facture brouillon sera cr√©√©e avec les m√™mes lignes.")&&y.post(route("quotes.convert",u.quote.id),{},{preserveScroll:!0})},$=async()=>{A.value=!0;try{const r=route("quotes.preview-html",u.quote.id)+`?locale=${U.value}`,t=await me.get(r);T.value=t.data.html}catch(r){console.error("Error loading preview:",r),T.value=`<p style="color: red; padding: 20px;">Erreur lors du chargement de l'aper√ßu</p>`}finally{A.value=!1}},ae=r=>{U.value=r,_.value&&$()},oe=()=>{_.value=!0,$()},de=r=>{const t={draft:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return t[r]||t.draft},ie=r=>({draft:"Brouillon",sent:"Envoy√©",accepted:"Accept√©",declined:"Refus√©",expired:"Expir√©",converted:"Converti"})[r]||r;return(r,t)=>(o(),a(k,null,[p(l(ne),{title:`Devis ${d.quote.reference}`},null,8,["title"]),p(be,null,{header:D(()=>[e("div",xe,[e("div",pe,[p(l(ce),{href:r.route("quotes.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:D(()=>[...t[21]||(t[21]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",ve," Devis "+m(d.quote.reference),1),e("span",{class:I([de(d.quote.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},m(ie(d.quote.status)),3)]),e("div",fe,[e("button",{type:"button",onClick:oe,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[...t[22]||(t[22]=[e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1),h(" Aper√ßu ",-1)])]),e("button",{type:"button",onClick:ee,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"}," Supprimer "),d.quote.status==="draft"?(o(),a("button",{key:0,type:"button",onClick:te,disabled:!d.quote.items||d.quote.items.length===0,class:"inline-flex items-center rounded-xl bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}," Marquer envoy√© ",8,ke)):w("",!0),d.quote.status==="sent"?(o(),a("button",{key:1,type:"button",onClick:se,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500"},[...t[23]||(t[23]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})],-1),h(" Accepter ",-1)])])):w("",!0),d.quote.status==="sent"?(o(),a("button",{key:2,type:"button",onClick:le,class:"inline-flex items-center rounded-xl border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-slate-700 dark:text-red-400 dark:hover:bg-slate-600"},[...t[24]||(t[24]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})],-1),h(" Refuser ",-1)])])):w("",!0),d.quote.status==="accepted"?(o(),a("button",{key:3,type:"button",onClick:re,class:"inline-flex items-center rounded-xl bg-purple-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-500"},[...t[25]||(t[25]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M1 4a1 1 0 011-1h16a1 1 0 011 1v8a1 1 0 01-1 1H2a1 1 0 01-1-1V4zm12 4a3 3 0 11-6 0 3 3 0 016 0zM4 9a1 1 0 100-2 1 1 0 000 2zm13-1a1 1 0 11-2 0 1 1 0 012 0zM1.75 14.5a.75.75 0 000 1.5c4.417 0 8.693.603 12.749 1.73 1.111.309 2.251-.512 2.251-1.696v-.784a.75.75 0 00-1.5 0v.784a.272.272 0 01-.35.25A49.043 49.043 0 001.75 14.5z","clip-rule":"evenodd"})],-1),h(" Convertir en facture ",-1)])])):w("",!0)])])]),default:D(()=>{var f;return[e("div",ge,[e("div",we,[e("div",he,[t[28]||(t[28]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Informations")],-1)),e("div",ye,[e("div",_e,[e("div",null,[p(V,{for:"client_id",value:"Client"}),b(e("select",{id:"client_id","onUpdate:modelValue":t[0]||(t[0]=s=>l(x).client_id=s),onChange:q,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(o(!0),a(k,null,g(d.clients,s=>(o(),a("option",{key:s.id,value:s.id},m(s.name),9,qe))),128))],544),[[C,l(x).client_id]]),p(M,{message:l(x).errors.client_id,class:"mt-2"},null,8,["message"])]),e("div",null,[p(V,{for:"valid_until",value:"Valide jusqu'au"}),b(e("input",{id:"valid_until","onUpdate:modelValue":t[1]||(t[1]=s=>l(x).valid_until=s),onChange:q,type:"date",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,544),[[v,l(x).valid_until]]),p(M,{message:l(x).errors.valid_until,class:"mt-2"},null,8,["message"])])]),e("div",Ce,[p(V,{for:"notes",value:"Notes / Conditions"}),b(e("textarea",{id:"notes","onUpdate:modelValue":t[2]||(t[2]=s=>l(x).notes=s),onBlur:q,rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Conditions particuli√®res..."},null,544),[[v,l(x).notes]])]),e("div",Me,[p(V,{for:"vat_mention",value:"Mention TVA (optionnel)"}),b(e("select",{id:"vat_mention","onUpdate:modelValue":t[3]||(t[3]=s=>l(x).vat_mention=s),onChange:q,class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[t[26]||(t[26]=e("option",{value:""},"Mention par d√©faut",-1)),(o(!0),a(k,null,g(d.vatMentionOptions,s=>(o(),a("option",{key:s.value,value:s.value},m(s.label),9,Ve))),128))],544),[[C,l(x).vat_mention]]),t[27]||(t[27]=e("p",{class:"mt-1 text-xs text-slate-500 dark:text-slate-400"}," Cette mention appara√Ætra sur le PDF du devis. ",-1))]),l(x).vat_mention==="other"?(o(),a("div",Ae,[p(V,{for:"custom_vat_mention",value:"Mention TVA personnalis√©e"}),b(e("textarea",{id:"custom_vat_mention","onUpdate:modelValue":t[4]||(t[4]=s=>l(x).custom_vat_mention=s),onBlur:q,rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Entrez votre mention TVA personnalis√©e..."},null,544),[[v,l(x).custom_vat_mention]])])):w("",!0),e("div",Se,[p(V,{for:"footer_message",value:"Message de pied de page (optionnel)"}),b(e("textarea",{id:"footer_message","onUpdate:modelValue":t[5]||(t[5]=s=>l(x).footer_message=s),onBlur:q,rows:"2",class:"mt-1 block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:d.defaultQuoteFooter},null,40,ze),[[v,l(x).footer_message]]),e("p",Le,' Si vide, le message par d√©faut sera utilis√© : "'+m(d.defaultQuoteFooter)+'" ',1)])])]),e("div",Ue,[t[49]||(t[49]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Lignes du devis")],-1)),e("div",Be,[(o(!0),a(k,null,g(d.quote.items,(s,j)=>(o(),a("div",{key:s.id,class:"px-6 py-4"},[L.value===s.id?(o(),a("div",Te,[e("div",Fe,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Titre",-1)),b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>l(n).title=i),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[v,l(n).title]]),p(M,{message:l(n).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Description (optionnel)",-1)),b(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=i=>l(n).description=i),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e"},null,512),[[v,l(n).description]]),p(M,{message:l(n).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",$e,[e("div",je,[t[31]||(t[31]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Quantit√©",-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=i=>l(n).quantity=i),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[v,l(n).quantity,void 0,{number:!0}]])]),e("div",Ee,[t[33]||(t[33]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Unit√©",-1)),b(e("select",{"onUpdate:modelValue":t[9]||(t[9]=i=>l(n).unit=i),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[t[32]||(t[32]=e("option",{value:""},"Sans unit√©",-1)),(o(!0),a(k,null,g(d.units,i=>(o(),a("option",{key:i.value,value:i.value},m(i.label),9,De))),128))],512),[[C,l(n).unit]])]),e("div",Ie,[t[34]||(t[34]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[10]||(t[10]=i=>l(n).unit_price=i),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[v,l(n).unit_price,void 0,{number:!0}]])]),e("div",He,[t[35]||(t[35]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"TVA",-1)),d.isVatExempt?(o(),a("div",Re," 0% ")):b((o(),a("select",{key:0,"onUpdate:modelValue":t[11]||(t[11]=i=>l(n).vat_rate=i),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(o(!0),a(k,null,g(d.vatRates,i=>(o(),a("option",{key:i.value,value:i.value},m(i.value)+"% ",9,Pe))),128))],512)),[[C,l(n).vat_rate,void 0,{number:!0}]])]),e("div",Ne,[e("button",{type:"button",onClick:i=>Z(s.id),disabled:l(n).processing,class:"inline-flex items-center rounded-xl bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...t[36]||(t[36]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,Qe),e("button",{type:"button",onClick:Y,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...t[37]||(t[37]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(o(),a("div",Oe,[d.quote.items.length>1?(o(),a("div",Ke,[e("button",{type:"button",onClick:i=>H(s.id,"up"),disabled:j===0,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Monter"},[...t[38]||(t[38]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,Ge),e("button",{type:"button",onClick:i=>H(s.id,"down"),disabled:j===d.quote.items.length-1,class:"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Descendre"},[...t[39]||(t[39]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Je)])):w("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:i=>P(s)},[e("p",Xe,m(s.title),1),s.description?(o(),a("p",Ye,m(s.description),1)):w("",!0),e("p",Ze,m(W(s.quantity))+" "+m(J(s.unit,s.quantity))+" x "+m(S(s.unit_price))+" (TVA "+m(s.vat_rate)+"%) ",1)],8,We),e("div",et,[e("span",tt,m(S(s.total_ht)),1),e("button",{type:"button",onClick:i=>P(s),class:"p-1 text-slate-400 hover:text-primary-600 dark:hover:text-primary-400",title:"Modifier"},[...t[40]||(t[40]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,st),e("button",{type:"button",onClick:i=>X(s.id),class:"p-1 text-slate-400 hover:text-red-600 dark:hover:text-red-400",title:"Supprimer"},[...t[41]||(t[41]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,lt)])]))]))),128)),e("form",{onSubmit:ue(G,["prevent"]),class:"px-6 py-4"},[t[48]||(t[48]=e("p",{class:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-3"},"Ajouter une ligne",-1)),e("div",rt,[e("div",at,[e("div",null,[b(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l(c).title=s),type:"text",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Titre de la prestation",required:""},null,512),[[v,l(c).title]]),p(M,{message:l(c).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[b(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=s=>l(c).description=s),rows:"2",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",placeholder:"Description d√©taill√©e (optionnel)"},null,512),[[v,l(c).description]]),p(M,{message:l(c).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",ot,[e("div",dt,[t[42]||(t[42]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Quantit√©",-1)),b(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>l(c).quantity=s),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[v,l(c).quantity,void 0,{number:!0}]])]),e("div",it,[t[44]||(t[44]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Unit√©",-1)),b(e("select",{"onUpdate:modelValue":t[15]||(t[15]=s=>l(c).unit=s),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[t[43]||(t[43]=e("option",{value:""},"Sans unit√©",-1)),(o(!0),a(k,null,g(d.units,s=>(o(),a("option",{key:s.value,value:s.value},m(s.label),9,nt))),128))],512),[[C,l(c).unit]])]),e("div",ut,[t[45]||(t[45]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"Prix HT",-1)),b(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>l(c).unit_price=s),type:"number",step:"0.01",min:"0",class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm",required:""},null,512),[[v,l(c).unit_price,void 0,{number:!0}]])]),e("div",ct,[t[46]||(t[46]=e("label",{class:"block text-xs text-slate-500 dark:text-slate-400 mb-1"},"TVA",-1)),d.isVatExempt?(o(),a("div",bt," 0% ")):b((o(),a("select",{key:0,"onUpdate:modelValue":t[17]||(t[17]=s=>l(c).vat_rate=s),class:"block w-full rounded-xl border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white text-sm"},[(o(!0),a(k,null,g(d.vatRates,s=>(o(),a("option",{key:s.value,value:s.value},m(s.value)+"% ",9,mt))),128))],512)),[[C,l(c).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:l(c).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[...t[47]||(t[47]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),h(" Ajouter ",-1)])],8,xt)])])],32)])])]),e("div",pt,[e("div",vt,[t[53]||(t[53]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"R√©sum√©")],-1)),e("div",ft,[e("div",kt,[t[50]||(t[50]=e("span",{class:"text-slate-500 dark:text-slate-400"},"Total HT",-1)),e("span",gt,m(S(F.value.ht)),1)]),e("div",wt,[t[51]||(t[51]=e("span",{class:"text-slate-500 dark:text-slate-400"},"TVA",-1)),e("span",ht,m(S(F.value.vat)),1)]),e("div",yt,[e("div",_t,[t[52]||(t[52]=e("span",{class:"text-base font-medium text-slate-900 dark:text-white"},"Total TTC",-1)),e("span",qt,m(S(F.value.ttc)),1)])])]),e("div",Ct,[e("p",Mt,m(((f=d.quote.items)==null?void 0:f.length)||0)+" ligne(s) ",1)])])])]),_.value?(o(),a("div",Vt,[e("div",At,[e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:t[18]||(t[18]=s=>_.value=!1)}),e("div",St,[e("div",zt,[t[58]||(t[58]=e("h3",{class:"text-lg font-medium text-slate-900 dark:text-white"}," Aper√ßu du devis ",-1)),e("div",Lt,[e("div",Ut,[(o(),a(k,null,g(O,s=>e("button",{key:s.value,type:"button",onClick:j=>ae(s.value),title:s.label,class:I(["px-2 py-1.5 text-base transition-colors",U.value===s.value?"bg-primary-100 dark:bg-primary-900":"bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"])},m(s.flag),11,Bt)),64))]),e("a",{href:K.value,target:"_blank",class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...t[54]||(t[54]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),h(" PDF ",-1)])],8,Tt),e("button",{type:"button",onClick:$,disabled:A.value,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 disabled:opacity-50"},[(o(),a("svg",{class:I(["h-4 w-4 mr-1",{"animate-spin":A.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...t[55]||(t[55]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),t[56]||(t[56]=h(" Actualiser ",-1))],8,Ft),e("button",{type:"button",onClick:t[19]||(t[19]=s=>_.value=!1),class:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"},[...t[57]||(t[57]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",$t,[A.value?(o(),a("div",jt,[...t[59]||(t[59]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(o(),a("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:T.value},null,8,Et))]),e("div",Dt,[e("button",{type:"button",onClick:t[20]||(t[20]=s=>_.value=!1),class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500"}," Fermer ")])])])])):w("",!0)]}),_:1})],64))}};export{Ot as default};
