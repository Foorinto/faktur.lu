import{r as c,y as I,c as n,a as b,b as l,h as O,i as p,d as e,f as z,t as s,o as i,F as u,j as f,k as B,l as m,e as v,g as j,x as V,m as q,p as K,B as Q,K as G}from"./app-Cw-UdvnB.js";import{_ as J}from"./AppLayout-BPXH3yDG.js";import{u as W}from"./useTranslations-CG1TRj3c.js";import"./DropdownLink-DfZnvZxO.js";const X={class:"flex items-center justify-between"},Y={class:"text-xl font-semibold text-slate-900 dark:text-white"},Z={class:"mb-6 flex flex-wrap gap-4"},ee={value:""},te=["value"],se={value:""},ae=["value"],le={value:""},re=["value"],oe={class:"overflow-hidden rounded-2xl bg-white shadow dark:bg-slate-800"},ie={class:"min-w-full divide-y divide-slate-200 dark:divide-slate-700"},ne={class:"bg-slate-50 dark:bg-slate-700"},de={class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-slate-900 dark:text-white sm:pl-6"},ce={class:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900 dark:text-white"},ue={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-slate-900 dark:text-white md:table-cell"},xe={class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-slate-900 dark:text-white lg:table-cell"},he={class:"px-3 py-3.5 text-right text-sm font-semibold text-slate-900 dark:text-white"},pe={class:"px-3 py-3.5 text-left text-sm font-semibold text-slate-900 dark:text-white"},fe={class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},me={class:"sr-only"},ve={class:"divide-y divide-slate-200 bg-white dark:divide-slate-700 dark:bg-slate-800"},ge={key:0},be={colspan:"7",class:"py-10 text-center text-sm text-slate-500 dark:text-slate-400"},ke={class:"mt-2"},ye={class:"whitespace-nowrap py-4 pl-4 pr-3 sm:pl-6"},we={class:"whitespace-nowrap px-3 py-4 text-sm text-slate-500 dark:text-slate-400"},_e={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-slate-500 dark:text-slate-400 md:table-cell"},Ce={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-slate-500 dark:text-slate-400 lg:table-cell"},je={class:"whitespace-nowrap px-3 py-4 text-right text-sm font-medium text-slate-900 dark:text-white"},Le={class:"whitespace-nowrap px-3 py-4 text-sm"},Me={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},Fe={class:"flex items-center justify-end gap-3"},ze=["onClick","title"],Be={key:0,class:"mt-6 flex items-center justify-between"},Ve={class:"text-sm text-slate-700 dark:text-slate-400"},qe={class:"isolate inline-flex -space-x-px rounded-xl shadow-sm"},De={key:1,class:"fixed inset-0 z-50 overflow-hidden"},He={class:"flex items-center justify-center min-h-screen p-4"},Pe={class:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},Ue={class:"flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700"},$e={class:"text-lg font-medium text-slate-900 dark:text-white"},Se={class:"flex items-center space-x-2"},Te={class:"flex items-center border border-slate-300 dark:border-slate-600 rounded-xl overflow-hidden"},Ae=["onClick","title"],Ee=["href"],Ne={class:"flex-1 overflow-auto p-6 bg-slate-100 dark:bg-slate-900"},Re={key:0,class:"flex items-center justify-center h-96"},Ie=["innerHTML"],Oe={class:"flex items-center justify-end px-6 py-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-700/50"},Ye={__name:"Index",props:{quotes:Object,filters:Object,statuses:Array,years:Array,clients:Array},setup(d){const{t:a}=W(),L=d,k=c(L.filters.status||""),y=c(L.filters.year||""),w=c(L.filters.client_id||""),_=c(!1),C=c(""),M=c(!1),x=c(null),g=c("fr"),$=[{value:"fr",label:"FranÃ§ais",flag:"ðŸ‡«ðŸ‡·"},{value:"de",label:"Deutsch",flag:"ðŸ‡©ðŸ‡ª"},{value:"en",label:"English",flag:"ðŸ‡¬ðŸ‡§"},{value:"lb",label:"LÃ«tzebuergesch",flag:"ðŸ‡±ðŸ‡º"}],S=Q(()=>x.value?`${route("quotes.pdf.stream",x.value.id)}?locale=${g.value}`:""),D=async()=>{if(x.value){M.value=!0;try{const o=route("quotes.preview-html",x.value.id)+`?locale=${g.value}`,r=await G.get(o);C.value=r.data.html}catch(o){console.error("Error loading preview:",o),C.value=`<p style="color: red; padding: 20px;">${a("error_loading_preview")}</p>`}finally{M.value=!1}}},T=o=>{g.value=o,_.value&&D()},A=async o=>{var r;x.value=o,g.value=((r=o.client)==null?void 0:r.locale)||"fr",_.value=!0,D()},F=()=>{_.value=!1,C.value="",x.value=null};I([k,y,w],()=>{K.get(route("quotes.index"),{status:k.value||void 0,year:y.value||void 0,client_id:w.value||void 0},{preserveState:!0,replace:!0})});const E=o=>{const r={draft:"bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return r[o]||r.draft},N=o=>({draft:a("draft"),sent:a("sent"),accepted:a("accepted"),declined:a("rejected"),expired:a("expired"),converted:a("converted")})[o]||o,R=(o,r="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:r}).format(o),H=o=>o?new Date(o).toLocaleDateString("fr-FR"):"-",P=o=>["draft","sent"].includes(o.status);return(o,r)=>(i(),n(u,null,[b(l(O),{title:l(a)("quotes")},null,8,["title"]),b(J,null,{header:p(()=>[e("div",X,[e("h1",Y,s(l(a)("quotes")),1),b(l(m),{href:o.route("quotes.create"),class:"inline-flex items-center rounded-xl bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500"},{default:p(()=>[r[3]||(r[3]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),v(" "+s(l(a)("new_quote")),1)]),_:1},8,["href"])])]),default:p(()=>{var U;return[e("div",Z,[z(e("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>k.value=t),class:"rounded-xl border-0 py-1.5 pl-3 pr-10 text-slate-900 ring-1 ring-inset ring-slate-300 focus:ring-2 focus:ring-primary-600 dark:bg-slate-800 dark:text-white dark:ring-slate-600 sm:text-sm"},[e("option",ee,s(l(a)("all_statuses")),1),(i(!0),n(u,null,f(d.statuses,t=>(i(),n("option",{key:t.value,value:t.value},s(t.label),9,te))),128))],512),[[B,k.value]]),z(e("select",{"onUpdate:modelValue":r[1]||(r[1]=t=>y.value=t),class:"rounded-xl border-0 py-1.5 pl-3 pr-10 text-slate-900 ring-1 ring-inset ring-slate-300 focus:ring-2 focus:ring-primary-600 dark:bg-slate-800 dark:text-white dark:ring-slate-600 sm:text-sm"},[e("option",se,s(l(a)("all_years")),1),(i(!0),n(u,null,f(d.years,t=>(i(),n("option",{key:t,value:t},s(t),9,ae))),128))],512),[[B,y.value]]),z(e("select",{"onUpdate:modelValue":r[2]||(r[2]=t=>w.value=t),class:"rounded-xl border-0 py-1.5 pl-3 pr-10 text-slate-900 ring-1 ring-inset ring-slate-300 focus:ring-2 focus:ring-primary-600 dark:bg-slate-800 dark:text-white dark:ring-slate-600 sm:text-sm"},[e("option",le,s(l(a)("all_clients")),1),(i(!0),n(u,null,f(d.clients,t=>(i(),n("option",{key:t.id,value:t.id},s(t.name),9,re))),128))],512),[[B,w.value]])]),e("div",oe,[e("table",ie,[e("thead",ne,[e("tr",null,[e("th",de,s(l(a)("reference")),1),e("th",ce,s(l(a)("client")),1),e("th",ue,s(l(a)("created_at")),1),e("th",xe,s(l(a)("due_date")),1),e("th",he,s(l(a)("total"))+" "+s(l(a)("ttc")),1),e("th",pe,s(l(a)("status")),1),e("th",fe,[e("span",me,s(l(a)("actions")),1)])])]),e("tbody",ve,[d.quotes.data.length===0?(i(),n("tr",ge,[e("td",be,[r[4]||(r[4]=e("svg",{class:"mx-auto h-12 w-12 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("p",ke,s(l(a)("no_quotes")),1),b(l(m),{href:o.route("quotes.create"),class:"mt-4 inline-flex items-center text-primary-600 hover:text-primary-500 dark:text-primary-400"},{default:p(()=>[v(s(l(a)("create_first_quote")),1)]),_:1},8,["href"])])])):j("",!0),(i(!0),n(u,null,f(d.quotes.data,t=>{var h;return i(),n("tr",{key:t.id,class:"hover:bg-slate-50 dark:hover:bg-slate-700"},[e("td",ye,[b(l(m),{href:P(t)?o.route("quotes.edit",t.id):o.route("quotes.show",t.id),class:"font-medium text-slate-900 hover:text-primary-600 dark:text-white dark:hover:text-primary-400"},{default:p(()=>[v(s(t.reference),1)]),_:2},1032,["href"])]),e("td",we,s((h=t.client)==null?void 0:h.name),1),e("td",_e,s(H(t.created_at)),1),e("td",Ce,s(H(t.valid_until)),1),e("td",je,s(R(t.total_ttc,t.currency)),1),e("td",Le,[e("span",{class:V([E(t.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},s(N(t.status)),3)]),e("td",Me,[e("div",Fe,[e("button",{type:"button",onClick:Qe=>A(t),class:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300",title:l(a)("preview")},[...r[5]||(r[5]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.573-3.007-9.963-7.178z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,ze),P(t)?(i(),q(l(m),{key:0,href:o.route("quotes.edit",t.id),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},{default:p(()=>[v(s(l(a)("edit")),1)]),_:1},8,["href"])):(i(),q(l(m),{key:1,href:o.route("quotes.show",t.id),class:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300"},{default:p(()=>[v(s(l(a)("view")),1)]),_:1},8,["href"]))])])])}),128))])])]),d.quotes.links&&d.quotes.links.length>3?(i(),n("div",Be,[e("div",Ve,s(l(a)("showing"))+" "+s(d.quotes.from)+" "+s(l(a)("to"))+" "+s(d.quotes.to)+" "+s(l(a)("of"))+" "+s(d.quotes.total)+" "+s(l(a)("quotes").toLowerCase()),1),e("nav",qe,[(i(!0),n(u,null,f(d.quotes.links,(t,h)=>(i(),n(u,{key:h},[t.url?(i(),q(l(m),{key:0,href:t.url,class:V([t.active?"z-10 bg-primary-600 text-white":"text-slate-900 ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:text-slate-300 dark:ring-slate-600 dark:hover:bg-slate-700","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20",h===0?"rounded-l-md":"",h===d.quotes.links.length-1?"rounded-r-md":""]),innerHTML:t.label,"preserve-scroll":""},null,8,["href","class","innerHTML"])):j("",!0)],64))),128))])])):j("",!0),_.value?(i(),n("div",De,[e("div",He,[e("div",{class:"fixed inset-0 bg-slate-500 bg-opacity-75 transition-opacity",onClick:F}),e("div",Pe,[e("div",Ue,[e("h3",$e,s((U=x.value)==null?void 0:U.reference),1),e("div",Se,[e("div",Te,[(i(),n(u,null,f($,t=>e("button",{key:t.value,type:"button",onClick:h=>T(t.value),title:t.label,class:V(["px-2 py-1.5 text-base transition-colors",g.value===t.value?"bg-primary-100 dark:bg-primary-900":"bg-white dark:bg-slate-700 hover:bg-slate-50 dark:hover:bg-slate-600"])},s(t.flag),11,Ae)),64))]),e("a",{href:S.value,target:"_blank",class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[...r[6]||(r[6]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),v(" PDF ",-1)])],8,Ee),e("button",{type:"button",onClick:F,class:"text-slate-400 hover:text-slate-500 dark:hover:text-slate-300"},[...r[7]||(r[7]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Ne,[M.value?(i(),n("div",Re,[...r[8]||(r[8]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(i(),n("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:C.value},null,8,Ie))]),e("div",Oe,[e("button",{type:"button",onClick:F,class:"inline-flex items-center rounded-xl bg-white px-3 py-2 text-sm font-semibold text-slate-900 shadow-sm ring-1 ring-inset ring-slate-300 hover:bg-slate-50 dark:bg-slate-600 dark:text-white dark:ring-slate-500"},s(l(a)("close")),1)])])])])):j("",!0)]}),_:1})],64))}};export{Ye as default};
