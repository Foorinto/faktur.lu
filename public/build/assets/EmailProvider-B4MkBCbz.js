import{u as A,z as D,c as o,a as b,b as s,h as L,i as v,d as e,l as g,e as p,t as i,w as N,o as a,F as y,j as _,x as V,f as k,C as T,g as m,k as H,P as F,v as z,B as E,r as S,p as $}from"./app-CEFOLa1I.js";import{_ as I}from"./AppLayout-B2flebT2.js";import{u as R}from"./useTranslations-D1Z83VQy.js";import"./DropdownLink-rVEdhqNI.js";const G={class:"text-xl font-semibold text-slate-900 dark:text-white"},J={class:"mb-6 border-b border-slate-200 dark:border-slate-700"},K={class:"flex space-x-8","aria-label":"Settings tabs"},Q={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},W={class:"px-6 py-4 space-y-4"},X=["onClick"],Y={class:"flex items-center h-5"},Z=["id","value"],ee={class:"ml-3"},te=["for"],se={key:0,class:"ml-2 inline-flex items-center rounded-xl bg-emerald-100 px-2 py-0.5 text-xs font-medium text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200"},re={class:"text-sm text-slate-500 dark:text-slate-400"},oe={key:0,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},ae={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},le={class:"text-lg font-medium text-slate-900 dark:text-white"},de={class:"px-6 py-4 space-y-4"},ie=["for"],ne={key:0,class:"text-pink-500"},ue=["id","onUpdate:modelValue"],ce=["value"],me={key:1,class:"relative mt-1"},pe=["id","type","onUpdate:modelValue","required"],xe=["onClick"],be={key:0,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ve={key:1,class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ke=["id","type","onUpdate:modelValue","required"],he={key:3,class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},fe={key:0,class:"text-sm text-pink-600"},we={key:1,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},ge={class:"px-6 py-4 space-y-4"},ye={key:2,class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},_e={class:"px-6 py-4"},Ce={class:"flex items-center justify-between"},je={class:"flex items-center space-x-3"},Me={key:0,class:"w-6 h-6 text-emerald-600 dark:text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ve={key:1,class:"w-6 h-6 text-amber-600 dark:text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Fe={class:"font-medium text-slate-900 dark:text-white"},ze={key:0,class:"text-sm text-slate-500 dark:text-slate-400"},Ee=["disabled"],Se={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24"},Ue={class:"mt-2 text-sm text-slate-500 dark:text-slate-400"},Be={class:"flex justify-end space-x-3"},Oe=["disabled"],Pe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Ne={__name:"EmailProvider",props:{settings:Object,providers:Object,smtpFields:Object,brevoFields:Object,postmarkFields:Object,resendFields:Object,userEmail:String},setup(u){const{t:h}=R(),x=u,r=A({provider:x.settings.provider||"faktur",from_address:x.settings.from_address||"",from_name:x.settings.from_name||"",config:{}}),f=S(!1),w=S({}),C=E(()=>{switch(r.provider){case"smtp":return x.smtpFields;case"brevo":return x.brevoFields;case"postmark":return x.postmarkFields;case"resend":return x.resendFields;default:return{}}});D(()=>r.provider,c=>{r.config={};const t=C.value;Object.keys(t).forEach(d=>{t[d].default!==void 0&&(r.config[d]=t[d].default)})},{immediate:!0});const j=E(()=>["smtp","brevo","postmark","resend"].includes(r.provider)),U={faktur:"Envoi via les serveurs de faktur.lu. Aucune configuration requise.",smtp:"Utilisez votre propre serveur SMTP (Gmail, Office 365, OVH, etc.).",brevo:"Service d'email marketing et transactionnel (anciennement Sendinblue).",postmark:"Service d'email transactionnel premium avec excellent taux de délivrabilité.",resend:"API email moderne et simple à configurer."},B=()=>{r.put(route("settings.email.provider.update"),{preserveScroll:!0})},O=()=>{f.value=!0,$.post(route("settings.email.provider.test"),{},{preserveScroll:!0,onFinish:()=>{f.value=!1}})},P=c=>{w.value[c]=!w.value[c]},q=(c,t)=>t.type==="password"?w.value[c]?"text":"password":t.type||"text";return(c,t)=>(a(),o(y,null,[b(s(L),{title:"Configuration Email"}),b(I,null,{header:v(()=>[e("h1",G,i(s(h)("settings")),1)]),default:v(()=>[e("div",J,[e("nav",K,[b(s(g),{href:c.route("settings.business.edit"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[p(i(s(h)("business_settings")),1)]),_:1},8,["href"]),b(s(g),{href:c.route("settings.email"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[p(i(s(h)("email_settings")),1)]),_:1},8,["href"]),b(s(g),{href:c.route("settings.email.provider"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-primary-500 text-primary-600 dark:text-primary-400"},{default:v(()=>[...t[3]||(t[3]=[p(" Fournisseur Email ",-1)])]),_:1},8,["href"]),b(s(g),{href:c.route("settings.accountant"),class:"whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300 dark:text-slate-400 dark:hover:text-slate-300"},{default:v(()=>[...t[4]||(t[4]=[p(" Accès Comptable ",-1)])]),_:1},8,["href"])])]),e("form",{onSubmit:N(B,["prevent"]),class:"space-y-6"},[e("div",Q,[t[5]||(t[5]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Provider d'envoi"),e("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Choisissez comment envoyer vos factures par email. ")],-1)),e("div",W,[(a(!0),o(y,null,_(u.providers,(d,l)=>(a(),o("div",{key:l,class:V(["relative flex items-start p-4 border rounded-xl cursor-pointer transition-colors",s(r).provider===l?"border-primary-500 bg-primary-50 dark:bg-primary-900/20 dark:border-primary-400":"border-slate-200 dark:border-slate-600 hover:border-slate-300 dark:hover:border-slate-500"]),onClick:n=>s(r).provider=l},[e("div",Y,[k(e("input",{id:"provider-"+l,type:"radio",value:l,"onUpdate:modelValue":t[0]||(t[0]=n=>s(r).provider=n),class:"h-4 w-4 text-primary-600 border-slate-300 focus:ring-primary-500"},null,8,Z),[[T,s(r).provider]])]),e("div",ee,[e("label",{for:"provider-"+l,class:"font-medium text-slate-900 dark:text-white cursor-pointer"},[p(i(d)+" ",1),l==="faktur"?(a(),o("span",se," Recommandé ")):m("",!0)],8,te),e("p",re,i(U[l]),1)])],10,X))),128))])]),j.value?(a(),o("div",oe,[e("div",ae,[e("h2",le," Configuration "+i(u.providers[s(r).provider]),1)]),e("div",de,[(a(!0),o(y,null,_(C.value,(d,l)=>(a(),o("div",{key:l},[e("label",{for:l,class:"block text-sm font-medium text-slate-700 dark:text-slate-300"},[p(i(d.label)+" ",1),d.required?(a(),o("span",ne,"*")):m("",!0)],8,ie),d.type==="select"?k((a(),o("select",{key:0,id:l,"onUpdate:modelValue":n=>s(r).config[l]=n,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(a(!0),o(y,null,_(d.options,(n,M)=>(a(),o("option",{key:M,value:M},i(n),9,ce))),128))],8,ue)),[[H,s(r).config[l]]]):d.type==="password"?(a(),o("div",me,[k(e("input",{id:l,type:q(l,d),"onUpdate:modelValue":n=>s(r).config[l]=n,required:d.required,class:"block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white pr-10"},null,8,pe),[[F,s(r).config[l]]]),e("button",{type:"button",onClick:n=>P(l),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400 hover:text-slate-500"},[w.value[l]?(a(),o("svg",be,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])])):(a(),o("svg",ve,[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))],8,xe)])):k((a(),o("input",{key:2,id:l,type:d.type||"text","onUpdate:modelValue":n=>s(r).config[l]=n,required:d.required,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,8,ke)),[[F,s(r).config[l]]]),d.help?(a(),o("p",he,i(d.help),1)):m("",!0)]))),128)),s(r).errors.config?(a(),o("p",fe,i(s(r).errors.config),1)):m("",!0)])])):m("",!0),j.value?(a(),o("div",we,[t[10]||(t[10]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Expéditeur"),e("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Personnalisez l'adresse et le nom de l'expéditeur. ")],-1)),e("div",ge,[e("div",null,[t[8]||(t[8]=e("label",{for:"from_address",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Adresse email ",-1)),k(e("input",{id:"from_address",type:"email","onUpdate:modelValue":t[1]||(t[1]=d=>s(r).from_address=d),placeholder:"contact@votreentreprise.lu",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[z,s(r).from_address]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"from_name",class:"block text-sm font-medium text-slate-700 dark:text-slate-300"}," Nom de l'expéditeur ",-1)),k(e("input",{id:"from_name",type:"text","onUpdate:modelValue":t[2]||(t[2]=d=>s(r).from_name=d),placeholder:"Votre Entreprise",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},null,512),[[z,s(r).from_name]])])])])):m("",!0),u.settings.provider!=="faktur"?(a(),o("div",ye,[e("div",_e,[e("div",Ce,[e("div",je,[e("div",{class:V(["flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center",u.settings.provider_verified?"bg-emerald-100 dark:bg-emerald-900":"bg-amber-100 dark:bg-amber-900"])},[u.settings.provider_verified?(a(),o("svg",Me,[...t[11]||(t[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(a(),o("svg",Ve,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])]))],2),e("div",null,[e("p",Fe,i(u.settings.provider_verified?"Configuration vérifiée":"Configuration non vérifiée"),1),u.settings.last_test_at?(a(),o("p",ze," Dernier test : "+i(u.settings.last_test_at),1)):m("",!0)])]),e("button",{type:"button",onClick:O,disabled:f.value||s(r).processing,class:"inline-flex items-center rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 disabled:opacity-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300"},[f.value?(a(),o("svg",Se,[...t[13]||(t[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("",!0),p(" "+i(f.value?"Envoi en cours...":"Envoyer un email de test"),1)],8,Ee)]),e("p",Ue," Un email de test sera envoyé à "+i(u.userEmail)+". ",1)])])):m("",!0),e("div",Be,[e("button",{type:"submit",disabled:s(r).processing,class:"inline-flex items-center rounded-xl bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 disabled:opacity-50"},[s(r).processing?(a(),o("svg",Pe,[...t[14]||(t[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):m("",!0),p(" "+i(s(r).processing?s(h)("saving"):s(h)("save")),1)],8,Oe)])],32)]),_:1})],64))}};export{Ne as default};
