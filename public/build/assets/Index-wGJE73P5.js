import{k as n,p as q,c as i,a as p,u as d,h as P,w as u,b as e,q as F,o as a,F as g,r as m,t as o,v as V,s as c,g as y,d as w,n as D,i as A,j as R,H as U}from"./app-BNdkYu5R.js";import{_ as I}from"./AppLayout-CQ5EpIy-.js";import"./ApplicationLogo-Btd2wIUd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-7-ZIUky-.js";const O={class:"flex items-center justify-between"},$={class:"mb-6 flex flex-wrap gap-4"},Q=["value"],G=["value"],J=["value"],K={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},W={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},X={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},Y={key:0},Z={colspan:"7",class:"py-10 text-center text-sm text-gray-500 dark:text-gray-400"},ee={class:"whitespace-nowrap py-4 pl-4 pr-3 sm:pl-6"},te={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400"},re={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 md:table-cell"},se={class:"hidden whitespace-nowrap px-3 py-4 text-sm text-gray-500 dark:text-gray-400 lg:table-cell"},ae={class:"whitespace-nowrap px-3 py-4 text-right text-sm font-medium text-gray-900 dark:text-white"},ie={class:"whitespace-nowrap px-3 py-4 text-sm"},le={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},oe={class:"flex items-center justify-end gap-3"},ne=["onClick"],de={key:0,class:"mt-6 flex items-center justify-between"},ue={class:"text-sm text-gray-700 dark:text-gray-400"},ge={class:"isolate inline-flex -space-x-px rounded-md shadow-sm"},xe={key:1,class:"fixed inset-0 z-50 overflow-hidden"},ce={class:"flex items-center justify-center min-h-screen p-4"},ye={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},pe={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},me={class:"text-lg font-medium text-gray-900 dark:text-white"},he={class:"flex items-center space-x-2"},ve=["href"],fe={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},ke={key:0,class:"flex items-center justify-center h-96"},be=["innerHTML"],Ae={__name:"Index",props:{quotes:Object,filters:Object,statuses:Array,years:Array,clients:Array},setup(l){const C=l,h=n(C.filters.status||""),v=n(C.filters.year||""),f=n(C.filters.client_id||""),_=n(!1),k=n(""),j=n(!1),b=n(null),H=async s=>{b.value=s,_.value=!0,j.value=!0;try{const t=await U.get(route("quotes.preview-html",s.id));k.value=t.data.html}catch(t){console.error("Error loading preview:",t),k.value=`<p style="color: red; padding: 20px;">Erreur lors du chargement de l'aperçu</p>`}finally{j.value=!1}},M=()=>{_.value=!1,k.value="",b.value=null};q([h,v,f],()=>{R.get(route("quotes.index"),{status:h.value||void 0,year:v.value||void 0,client_id:f.value||void 0},{preserveState:!0,replace:!0})});const E=s=>{const t={draft:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",sent:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",accepted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",declined:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",expired:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",converted:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"};return t[s]||t.draft},S=s=>({draft:"Brouillon",sent:"Envoyé",accepted:"Accepté",declined:"Refusé",expired:"Expiré",converted:"Converti"})[s]||s,N=(s,t="EUR")=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:t}).format(s),B=s=>s?new Date(s).toLocaleDateString("fr-FR"):"-",T=s=>["draft","sent"].includes(s.status);return(s,t)=>(a(),i(g,null,[p(d(P),{title:"Devis"}),p(I,null,{header:u(()=>[e("div",O,[t[4]||(t[4]=e("h1",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Devis ",-1)),p(d(c),{href:s.route("quotes.create"),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500"},{default:u(()=>[...t[3]||(t[3]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),y(" Nouveau devis ",-1)])]),_:1},8,["href"])])]),default:u(()=>{var z,L;return[e("div",$,[F(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>h.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[t[5]||(t[5]=e("option",{value:""},"Tous les statuts",-1)),(a(!0),i(g,null,m(l.statuses,r=>(a(),i("option",{key:r.value,value:r.value},o(r.label),9,Q))),128))],512),[[V,h.value]]),F(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>v.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[t[6]||(t[6]=e("option",{value:""},"Toutes les années",-1)),(a(!0),i(g,null,m(l.years,r=>(a(),i("option",{key:r,value:r},o(r),9,G))),128))],512),[[V,v.value]]),F(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>f.value=r),class:"rounded-md border-0 py-1.5 pl-3 pr-10 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-indigo-600 dark:bg-gray-800 dark:text-white dark:ring-gray-600 sm:text-sm"},[t[7]||(t[7]=e("option",{value:""},"Tous les clients",-1)),(a(!0),i(g,null,m(l.clients,r=>(a(),i("option",{key:r.id,value:r.id},o(r.name),9,J))),128))],512),[[V,f.value]])]),e("div",K,[e("table",W,[t[14]||(t[14]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 dark:text-white sm:pl-6"}," Référence "),e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"}," Client "),e("th",{class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white md:table-cell"}," Créé le "),e("th",{class:"hidden px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white lg:table-cell"}," Valide jusqu'au "),e("th",{class:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 dark:text-white"}," Total TTC "),e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900 dark:text-white"}," Statut "),e("th",{class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",X,[l.quotes.data.length===0?(a(),i("tr",Y,[e("td",Z,[t[9]||(t[9]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[10]||(t[10]=e("p",{class:"mt-2"},"Aucun devis trouvé.",-1)),p(d(c),{href:s.route("quotes.create"),class:"mt-4 inline-flex items-center text-indigo-600 hover:text-indigo-500 dark:text-indigo-400"},{default:u(()=>[...t[8]||(t[8]=[y(" Créer votre premier devis ",-1)])]),_:1},8,["href"])])])):w("",!0),(a(!0),i(g,null,m(l.quotes.data,r=>{var x;return a(),i("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",ee,[p(d(c),{href:T(r)?s.route("quotes.edit",r.id):s.route("quotes.show",r.id),class:"font-medium text-gray-900 hover:text-indigo-600 dark:text-white dark:hover:text-indigo-400"},{default:u(()=>[y(o(r.reference),1)]),_:2},1032,["href"])]),e("td",te,o((x=r.client)==null?void 0:x.name),1),e("td",re,o(B(r.created_at)),1),e("td",se,o(B(r.valid_until)),1),e("td",ae,o(N(r.total_ttc,r.currency)),1),e("td",ie,[e("span",{class:D([E(r.status),"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"])},o(S(r.status)),3)]),e("td",le,[e("div",oe,[e("button",{type:"button",onClick:Ce=>H(r),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",title:"Aperçu"},[...t[11]||(t[11]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.573-3.007-9.963-7.178z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])],8,ne),T(r)?(a(),A(d(c),{key:0,href:s.route("quotes.edit",r.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},{default:u(()=>[...t[12]||(t[12]=[y(" Modifier ",-1)])]),_:1},8,["href"])):(a(),A(d(c),{key:1,href:s.route("quotes.show",r.id),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},{default:u(()=>[...t[13]||(t[13]=[y(" Voir ",-1)])]),_:1},8,["href"]))])])])}),128))])])]),l.quotes.links&&l.quotes.links.length>3?(a(),i("div",de,[e("div",ue," Affichage de "+o(l.quotes.from)+" à "+o(l.quotes.to)+" sur "+o(l.quotes.total)+" devis ",1),e("nav",ge,[(a(!0),i(g,null,m(l.quotes.links,(r,x)=>(a(),i(g,{key:x},[r.url?(a(),A(d(c),{key:0,href:r.url,class:D([r.active?"z-10 bg-indigo-600 text-white":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:text-gray-300 dark:ring-gray-600 dark:hover:bg-gray-700","relative inline-flex items-center px-4 py-2 text-sm font-semibold focus:z-20",x===0?"rounded-l-md":"",x===l.quotes.links.length-1?"rounded-r-md":""]),innerHTML:r.label,"preserve-scroll":""},null,8,["href","class","innerHTML"])):w("",!0)],64))),128))])])):w("",!0),_.value?(a(),i("div",xe,[e("div",ce,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:M}),e("div",ye,[e("div",pe,[e("h3",me," Aperçu - "+o((z=b.value)==null?void 0:z.reference),1),e("div",he,[e("a",{href:s.route("quotes.pdf.stream",(L=b.value)==null?void 0:L.id),target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...t[15]||(t[15]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),y(" PDF ",-1)])],8,ve),e("button",{type:"button",onClick:M,class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...t[16]||(t[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",fe,[j.value?(a(),i("div",ke,[...t[17]||(t[17]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(a(),i("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:k.value},null,8,be))]),e("div",{class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},[e("button",{type:"button",onClick:M,class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"}," Fermer ")])])])])):w("",!0)]}),_:1})],64))}};export{Ae as default};
