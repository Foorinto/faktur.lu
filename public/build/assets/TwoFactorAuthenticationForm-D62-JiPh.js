import{o as s,c as r,b as o,x as w,i as h,w as a,a as n,g as i,n as C,t as $,L as K,M as j,N as E,k as y,e as I,p as Q,d as f,u as V,F as H,r as U,A as W,j as L,J as G}from"./app-B2KrZOCa.js";import{_ as J}from"./Modal-8Ez8Z5B8.js";import{a as M,_ as O}from"./InputError-CsSOzQ1V.js";import{P as B}from"./PrimaryButton-DZCmMAEy.js";import{_ as A,D as X}from"./SecondaryButton-CQrlu4EG.js";import{_ as q}from"./TextInput-CPumfmre.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"md:grid md:grid-cols-3 md:gap-6"},Z={class:"md:col-span-1 flex justify-between"},ee={class:"px-4 sm:px-0"},te={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},se={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},oe={class:"mt-5 md:mt-0 md:col-span-2"},ae={class:"px-4 py-5 sm:p-6 bg-white dark:bg-gray-800 shadow sm:rounded-lg"},re={__name:"ActionSection",props:{title:String,description:String},setup(m){return(p,x)=>(s(),r("div",Y,[o("div",Z,[o("div",ee,[o("h3",te,[w(p.$slots,"title")]),o("p",se,[w(p.$slots,"description")])])]),o("div",oe,[o("div",ae,[w(p.$slots,"content")])])]))}},ne={class:"px-6 py-4"},le={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ie={class:"mt-4 text-sm text-gray-600 dark:text-gray-400"},de={class:"flex flex-row justify-end px-6 py-4 bg-gray-100 dark:bg-gray-800 text-end"},ue={__name:"DialogModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(m,{emit:p}){const x=p,l=()=>{x("close")};return(e,u)=>(s(),h(J,{show:m.show,"max-width":m.maxWidth,closeable:m.closeable,onClose:l},{default:a(()=>[o("div",ne,[o("div",le,[w(e.$slots,"title")]),o("div",ie,[w(e.$slots,"content")])]),o("div",de,[w(e.$slots,"footer")])]),_:3},8,["show","max-width","closeable"]))}},ce={class:"mt-4"},b={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirmer le mot de passe"},content:{type:String,default:"Pour votre sécurité, veuillez confirmer votre mot de passe pour continuer."},button:{type:String,default:"Confirmer"}},emits:["confirmed"],setup(m,{emit:p}){const x=p,l=y(!1),e=E({password:"",error:"",processing:!1}),u=y(null),k=()=>{axios.get(route("password.confirmation")).then(d=>{d.data.confirmed?x("confirmed"):(l.value=!0,setTimeout(()=>u.value.focus(),250))})},_=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,v(),j().then(()=>x("confirmed"))}).catch(d=>{e.processing=!1,e.error=d.response.data.errors.password[0],u.value.focus()})},v=()=>{l.value=!1,e.password="",e.error=""};return(d,c)=>(s(),r("span",null,[o("span",{onClick:k},[w(d.$slots,"default")]),n(ue,{show:l.value,onClose:v},{title:a(()=>[i($(m.title),1)]),content:a(()=>[i($(m.content)+" ",1),o("div",ce,[n(q,{ref_key:"passwordInput",ref:u,modelValue:e.password,"onUpdate:modelValue":c[0]||(c[0]=F=>e.password=F),type:"password",class:"mt-1 block w-3/4",placeholder:"Mot de passe",autocomplete:"current-password",onKeyup:K(_,["enter"])},null,8,["modelValue"]),n(M,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:a(()=>[n(A,{onClick:v},{default:a(()=>[...c[1]||(c[1]=[i(" Annuler ",-1)])]),_:1}),n(B,{class:C(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:_},{default:a(()=>[i($(m.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},me={key:0,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},fe={key:1,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},pe={key:2,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ve={key:3},ge={key:0},ye={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},xe={key:0,class:"font-semibold"},_e={key:1},he=["innerHTML"],we={key:0,class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},ke={class:"font-semibold"},be={class:"font-mono text-base select-all"},Ce={key:1,class:"mt-4"},$e={key:1},Se={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 dark:bg-gray-900 rounded-lg"},Ae={class:"mt-5"},Fe={key:0},ze={key:1},qe={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(m){const p=m,x=G(),l=y(!1),e=y(!1),u=y(!1),k=y(null),_=y(null),v=y([]),d=I({code:""}),c=W(()=>{var g;return!l.value&&((g=x.props.auth.user)==null?void 0:g.two_factor_enabled)});Q(c,()=>{c.value||(d.reset(),d.clearErrors())});const F=()=>{l.value=!0,L.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([D(),N(),z()]),onFinish:()=>{l.value=!1,e.value=p.requiresConfirmation}})},D=()=>axios.get(route("two-factor.qr-code")).then(g=>{k.value=g.data.svg}),N=()=>axios.get(route("two-factor.secret-key")).then(g=>{_.value=g.data.secretKey}),z=()=>axios.get(route("two-factor.recovery-codes")).then(g=>{v.value=g.data}),P=()=>{d.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,k.value=null,_.value=null}})},R=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>z())},T=()=>{u.value=!0,L.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,e.value=!1}})};return(g,t)=>(s(),h(re,null,{title:a(()=>[...t[1]||(t[1]=[i(" Authentification à deux facteurs ",-1)])]),description:a(()=>[...t[2]||(t[2]=[i(" Ajoutez une couche de sécurité supplémentaire à votre compte en utilisant l'authentification à deux facteurs. ",-1)])]),content:a(()=>[c.value&&!e.value?(s(),r("h3",me," L'authentification à deux facteurs est activée. ")):c.value&&e.value?(s(),r("h3",fe," Finalisez l'activation de l'authentification à deux facteurs. ")):(s(),r("h3",pe," L'authentification à deux facteurs n'est pas activée. ")),t[11]||(t[11]=o("div",{class:"mt-3 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[o("p",null," Lorsque l'authentification à deux facteurs est activée, un code aléatoire vous sera demandé lors de l'authentification. Vous pouvez récupérer ce code depuis l'application Google Authenticator ou Authy de votre téléphone. ")],-1)),c.value?(s(),r("div",ve,[k.value?(s(),r("div",ge,[o("div",ye,[e.value?(s(),r("p",xe," Pour finaliser l'activation, scannez le QR code suivant avec votre application d'authentification ou entrez la clé de configuration. ")):(s(),r("p",_e," L'authentification à deux facteurs est maintenant activée. Scannez le QR code suivant avec votre application d'authentification ou entrez la clé de configuration. "))]),o("div",{class:"mt-4 p-4 bg-white inline-block rounded-lg",innerHTML:k.value},null,8,he),_.value?(s(),r("div",we,[o("p",ke,[t[3]||(t[3]=i(" Clé de configuration : ",-1)),o("span",be,$(_.value),1)])])):f("",!0),e.value?(s(),r("div",Ce,[n(O,{for:"code",value:"Code"}),n(q,{id:"code",modelValue:V(d).code,"onUpdate:modelValue":t[0]||(t[0]=S=>V(d).code=S),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:K(P,["enter"])},null,8,["modelValue"]),n(M,{message:V(d).errors.code,class:"mt-2"},null,8,["message"])])):f("",!0)])):f("",!0),v.value.length>0&&!e.value?(s(),r("div",$e,[t[4]||(t[4]=o("div",{class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[o("p",{class:"font-semibold"}," Conservez ces codes de récupération dans un gestionnaire de mots de passe sécurisé. Ils peuvent être utilisés pour récupérer l'accès à votre compte si vous perdez votre appareil d'authentification à deux facteurs. ")],-1)),o("div",Se,[(s(!0),r(H,null,U(v.value,S=>(s(),r("div",{key:S},$(S),1))),128))])])):f("",!0)])):f("",!0),o("div",Ae,[c.value?(s(),r("div",ze,[n(b,{onConfirmed:P},{default:a(()=>[e.value?(s(),h(B,{key:0,type:"button",class:C(["me-3",{"opacity-25":l.value}]),disabled:l.value},{default:a(()=>[...t[6]||(t[6]=[i(" Confirmer ",-1)])]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),n(b,{onConfirmed:R},{default:a(()=>[v.value.length>0&&!e.value?(s(),h(A,{key:0,class:"me-3"},{default:a(()=>[...t[7]||(t[7]=[i(" Régénérer les codes de récupération ",-1)])]),_:1})):f("",!0)]),_:1}),n(b,{onConfirmed:z},{default:a(()=>[v.value.length===0&&!e.value?(s(),h(A,{key:0,class:"me-3"},{default:a(()=>[...t[8]||(t[8]=[i(" Afficher les codes de récupération ",-1)])]),_:1})):f("",!0)]),_:1}),n(b,{onConfirmed:T},{default:a(()=>[e.value?(s(),h(A,{key:0,class:C({"opacity-25":u.value}),disabled:u.value},{default:a(()=>[...t[9]||(t[9]=[i(" Annuler ",-1)])]),_:1},8,["class","disabled"])):f("",!0)]),_:1}),n(b,{onConfirmed:T},{default:a(()=>[e.value?f("",!0):(s(),h(X,{key:0,class:C({"opacity-25":u.value}),disabled:u.value},{default:a(()=>[...t[10]||(t[10]=[i(" Désactiver ",-1)])]),_:1},8,["class","disabled"]))]),_:1})])):(s(),r("div",Fe,[n(b,{onConfirmed:F},{default:a(()=>[n(B,{type:"button",class:C({"opacity-25":l.value}),disabled:l.value},{default:a(()=>[...t[5]||(t[5]=[i(" Activer ",-1)])]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{qe as default};
