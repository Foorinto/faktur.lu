import{u as E,y as z,c as u,a as n,b as t,h as j,i as k,d as e,w as D,f as v,t as m,o as c,F as b,j as x,k as $,g,v as p,e as I,l as R,B as C,r as O}from"./app-BM4k7HEV.js";import{_ as T}from"./AppLayout-S94i9LSh.js";import{_ as V}from"./InputError-DEUunjFw.js";import{_}from"./InputLabel-gVYLty1b.js";import{_ as H}from"./PrimaryButton-Cv573IV-.js";import{_ as L}from"./VatScenarioIndicator-CZ966ELO.js";import{u as G}from"./useTranslations-BUq1IIhi.js";import"./DropdownLink-4RKVfM9H.js";const J={class:"flex items-center space-x-4"},K={class:"text-xl font-semibold text-slate-900 dark:text-white"},P={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},Q={class:"px-6 py-4"},W={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},X={value:""},Y=["value"],Z={key:0,class:"mt-2"},ee=["placeholder"],te={class:"mt-4"},ae={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},se={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},le={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},re={class:"text-lg font-medium text-slate-900 dark:text-white"},oe={class:"px-6 py-4"},de={class:"space-y-4"},ie={class:"flex flex-wrap gap-4 items-end"},ne={class:"flex-1 min-w-[200px]"},ue=["id","onUpdate:modelValue","placeholder"],ce={class:"flex flex-wrap gap-4 items-end"},me={class:"flex-1 min-w-[200px]"},_e=["id","onUpdate:modelValue","placeholder"],ve={class:"w-24"},pe=["id","onUpdate:modelValue"],fe={class:"w-32"},he=["id","onUpdate:modelValue"],be=["value"],ke={class:"w-32"},xe=["id","onUpdate:modelValue"],ge={class:"w-32"},we=["id","value","onChange"],ye=["value"],Ve={key:0,class:"w-24"},$e=["id","value","onInput"],Ce=["onClick"],Ue={class:"overflow-hidden rounded-2xl bg-white shadow-xl shadow-slate-200/50 border border-slate-200 dark:bg-slate-800 dark:border-slate-700 dark:shadow-slate-900/50"},qe={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},Fe={class:"text-lg font-medium text-slate-900 dark:text-white"},Me={class:"px-6 py-4 space-y-4"},Ie=["placeholder"],Re={value:""},Ae=["value"],Se={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},Be={key:0},Ne=["placeholder"],Ee=["placeholder"],ze={key:0,class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},je={class:"flex justify-end space-x-3"},De={key:0},Oe={key:1},We={__name:"Create",props:{clients:Array,vatRates:Array,units:Array,defaultClientId:[String,Number],isVatExempt:Boolean,vatScenarios:Object,defaultVatRate:{type:Number,default:17},vatMentionOptions:Array,defaultVatMention:String,suggestedVatMention:String,defaultInvoiceFooter:String},setup(f){const{t:r}=G(),h=f,U=C(()=>{var o,l;return h.isVatExempt?0:((o=w.value)==null?void 0:o.default_vat_rate)!==null&&((l=w.value)==null?void 0:l.default_vat_rate)!==void 0?parseFloat(w.value.default_vat_rate):h.defaultVatRate}),w=C(()=>{var o;return(o=h.clients)==null?void 0:o.find(l=>l.id===s.client_id)}),q=C(()=>{var o;return((o=w.value)==null?void 0:o.vat_scenario)||null}),s=E({client_id:h.defaultClientId||"",title:"",due_at:"",notes:"",currency:"EUR",vat_mention:h.suggestedVatMention||"",custom_vat_mention:"",footer_message:"",items:[]}),y=O({}),F=()=>{const o=s.items.length;s.items.push({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:U.value,vat_rate_select:U.value}),y.value[o]=""},A=(o,l)=>{l==="custom"?(s.items[o].vat_rate_select="custom",s.items[o].vat_rate=y.value[o]||0):(s.items[o].vat_rate_select=l,s.items[o].vat_rate=l)},S=(o,l)=>{y.value[o]=l,s.items[o].vat_rate_select==="custom"&&(s.items[o].vat_rate=parseFloat(l)||0)};z(()=>s.client_id,o=>{var l;if(o){const a=h.clients.find(d=>d.id===o);(a==null?void 0:a.default_vat_rate)!==null&&(a==null?void 0:a.default_vat_rate)!==void 0&&s.items.forEach((d,i)=>{if(d.vat_rate_select!=="custom"){const M=parseFloat(a.default_vat_rate);d.vat_rate=M,d.vat_rate_select=M}}),!s.vat_mention&&((l=a==null?void 0:a.vat_scenario)!=null&&l.mention)&&(s.vat_mention=a.vat_scenario.mention)}});const B=o=>{s.items.splice(o,1)},N=()=>{s.post(route("invoices.store"))};return s.items.length===0&&F(),(o,l)=>(c(),u(b,null,[n(t(j),{title:t(r)("new_invoice")},null,8,["title"]),n(T,null,{header:k(()=>[e("div",J,[n(t(R),{href:o.route("invoices.index"),class:"text-slate-400 hover:text-slate-500 dark:text-slate-500 dark:hover:text-slate-400"},{default:k(()=>[...l[7]||(l[7]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",K,m(t(r)("new_invoice")),1)])]),default:k(()=>[e("form",{onSubmit:D(N,["prevent"]),class:"space-y-6"},[e("div",P,[l[8]||(l[8]=e("div",{class:"px-6 py-4 border-b border-slate-200 dark:border-slate-700"},[e("h2",{class:"text-lg font-medium text-slate-900 dark:text-white"},"Client")],-1)),e("div",Q,[e("div",W,[e("div",null,[n(_,{for:"client_id",value:"Client"}),v(e("select",{id:"client_id","onUpdate:modelValue":l[0]||(l[0]=a=>t(s).client_id=a),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[e("option",X,m(t(r)("select_client")),1),(c(!0),u(b,null,x(f.clients,a=>(c(),u("option",{key:a.id,value:a.id},m(a.name),9,Y))),128))],512),[[$,t(s).client_id]]),n(V,{message:t(s).errors.client_id,class:"mt-2"},null,8,["message"]),q.value?(c(),u("div",Z,[n(L,{scenario:q.value,size:"sm"},null,8,["scenario"])])):g("",!0)]),e("div",null,[n(_,{for:"title",value:t(r)("title_optional")},null,8,["value"]),v(e("input",{id:"title","onUpdate:modelValue":l[1]||(l[1]=a=>t(s).title=a),type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(r)("example_placeholder")},null,8,ee),[[p,t(s).title]]),n(V,{message:t(s).errors.title,class:"mt-2"},null,8,["message"])])]),e("div",te,[n(_,{for:"due_at",value:t(r)("due_date_optional")},null,8,["value"]),v(e("input",{id:"due_at","onUpdate:modelValue":l[2]||(l[2]=a=>t(s).due_at=a),type:"date",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white sm:max-w-xs"},null,512),[[p,t(s).due_at]]),e("p",ae,m(t(r)("default_30_days_after")),1),n(V,{message:t(s).errors.due_at,class:"mt-2"},null,8,["message"])])])]),e("div",se,[e("div",le,[e("h2",re,m(t(r)("invoice_lines")),1)]),e("div",oe,[e("div",de,[(c(!0),u(b,null,x(t(s).items,(a,d)=>(c(),u("div",{key:d,class:"p-4 rounded-xl border border-slate-200 dark:border-slate-700 space-y-3"},[e("div",ie,[e("div",ne,[n(_,{for:`item-${d}-title`,value:t(r)("title_required")},null,8,["for","value"]),v(e("input",{id:`item-${d}-title`,"onUpdate:modelValue":i=>a.title=i,type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(r)("service_title_placeholder"),required:""},null,8,ue),[[p,a.title]])])]),e("div",ce,[e("div",me,[n(_,{for:`item-${d}-description`,value:t(r)("description_optional")},null,8,["for","value"]),v(e("input",{id:`item-${d}-description`,"onUpdate:modelValue":i=>a.description=i,type:"text",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(r)("additional_details")},null,8,_e),[[p,a.description]])]),e("div",ve,[n(_,{for:`item-${d}-quantity`,value:t(r)("qty")},null,8,["for","value"]),v(e("input",{id:`item-${d}-quantity`,"onUpdate:modelValue":i=>a.quantity=i,type:"number",step:"0.01",min:"0.01",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,pe),[[p,a.quantity,void 0,{number:!0}]])]),e("div",fe,[n(_,{for:`item-${d}-unit`,value:t(r)("unit")},null,8,["for","value"]),v(e("select",{id:`item-${d}-unit`,"onUpdate:modelValue":i=>a.unit=i,class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[l[9]||(l[9]=e("option",{value:""},"-",-1)),(c(!0),u(b,null,x(f.units,i=>(c(),u("option",{key:i.value,value:i.value},m(i.label),9,be))),128))],8,he),[[$,a.unit]])]),e("div",ke,[n(_,{for:`item-${d}-unit_price`,value:t(r)("price_ht")},null,8,["for","value"]),v(e("input",{id:`item-${d}-unit_price`,"onUpdate:modelValue":i=>a.unit_price=i,type:"number",step:"0.01",min:"0",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},null,8,xe),[[p,a.unit_price,void 0,{number:!0}]])]),e("div",ge,[n(_,{for:`item-${d}-vat_rate`,value:t(r)("vat")},null,8,["for","value"]),e("select",{id:`item-${d}-vat_rate`,value:a.vat_rate_select??a.vat_rate,onChange:i=>A(d,i.target.value==="custom"?"custom":parseFloat(i.target.value)),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",required:""},[(c(!0),u(b,null,x(f.vatRates,i=>(c(),u("option",{key:i.value,value:i.value},m(i.label),9,ye))),128))],40,we)]),a.vat_rate_select==="custom"?(c(),u("div",Ve,[n(_,{for:`item-${d}-custom_vat_rate`,value:"%"},null,8,["for"]),e("input",{id:`item-${d}-custom_vat_rate`,type:"number",step:"0.01",min:"0",max:"100",value:y.value[d],onInput:i=>S(d,i.target.value),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:"Ex: 12"},null,40,$e)])):g("",!0),t(s).items.length>1?(c(),u("button",{key:1,type:"button",onClick:i=>B(d),class:"p-2 text-pink-600 hover:text-pink-800 dark:text-pink-400 dark:hover:text-pink-300"},[...l[10]||(l[10]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,Ce)):g("",!0)])]))),128)),e("button",{type:"button",onClick:F,class:"inline-flex items-center rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},[l[11]||(l[11]=e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),I(" "+m(t(r)("add_line")),1)])])])]),e("div",Ue,[e("div",qe,[e("h2",Fe,m(t(r)("notes_optional")),1)]),e("div",Me,[e("div",null,[n(_,{for:"notes",value:"Notes"}),v(e("textarea",{id:"notes","onUpdate:modelValue":l[3]||(l[3]=a=>t(s).notes=a),rows:"3",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(r)("notes_placeholder")},null,8,Ie),[[p,t(s).notes]]),n(V,{message:t(s).errors.notes,class:"mt-2"},null,8,["message"])]),e("div",null,[n(_,{for:"vat_mention",value:t(r)("vat_mention_optional")},null,8,["value"]),v(e("select",{id:"vat_mention","onUpdate:modelValue":l[4]||(l[4]=a=>t(s).vat_mention=a),class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[e("option",Re,m(t(r)("use_default_mention")),1),(c(!0),u(b,null,x(f.vatMentionOptions,a=>(c(),u("option",{key:a.value,value:a.value},m(a.label),9,Ae))),128))],512),[[$,t(s).vat_mention]]),e("p",Se,m(t(r)("default_mention_note")),1)]),t(s).vat_mention==="other"?(c(),u("div",Be,[n(_,{for:"custom_vat_mention",value:t(r)("custom_vat_mention_label")},null,8,["value"]),v(e("textarea",{id:"custom_vat_mention","onUpdate:modelValue":l[5]||(l[5]=a=>t(s).custom_vat_mention=a),rows:"2",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:t(r)("custom_vat_mention_placeholder")},null,8,Ne),[[p,t(s).custom_vat_mention]])])):g("",!0),e("div",null,[n(_,{for:"footer_message",value:t(r)("footer_message_optional")},null,8,["value"]),v(e("textarea",{id:"footer_message","onUpdate:modelValue":l[6]||(l[6]=a=>t(s).footer_message=a),rows:"2",class:"mt-1 block w-full rounded-xl border-slate-200 shadow-sm focus:border-primary-500 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white",placeholder:f.defaultInvoiceFooter},null,8,Ee),[[p,t(s).footer_message]]),f.defaultInvoiceFooter?(c(),u("p",ze,m(t(r)("empty_default_message"))+' "'+m(f.defaultInvoiceFooter)+'" ',1)):g("",!0)])])]),e("div",je,[n(t(R),{href:o.route("invoices.index"),class:"inline-flex items-center rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-700 shadow-sm hover:bg-slate-50 dark:border-slate-600 dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600"},{default:k(()=>[I(m(t(r)("cancel")),1)]),_:1},8,["href"]),n(H,{disabled:t(s).processing},{default:k(()=>[t(s).processing?(c(),u("span",De,m(t(r)("creating")),1)):(c(),u("span",Oe,m(t(r)("create_draft")),1))]),_:1},8,["disabled"])])],32)]),_:1})],64))}};export{We as default};
