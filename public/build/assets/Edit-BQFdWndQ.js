import{r as h,u as N,z as K,c as d,a as y,b as t,h as ge,i as D,d as e,t as a,f as v,o as n,F as f,j as _,k as M,g as k,v as p,e as L,w as me,x as W,l as ve,B,p as A,H as be}from"./app-Bw40qWnz.js";import{_ as ye}from"./AppLayout-DY_rKOab.js";import{_ as C,a as V}from"./InputError-Ds8nJv-q.js";import{_ as xe}from"./VatScenarioIndicator-XP3GANdn.js";import{u as pe}from"./useTranslations-BmhVlpgi.js";import"./ApplicationLogo-oNrlBF6v.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-DHpUyQjj.js";const fe={class:"flex items-center justify-between"},he={class:"flex items-center space-x-4"},_e={class:"text-xl font-semibold text-gray-900 dark:text-white"},ke={class:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800 dark:bg-gray-700 dark:text-gray-300"},we={class:"flex items-center space-x-3"},Ce=["disabled"],Ve={class:"grid grid-cols-1 gap-6 lg:grid-cols-3"},ze={class:"lg:col-span-2 space-y-6"},Me={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ue={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},$e={class:"text-lg font-medium text-gray-900 dark:text-white"},je={class:"px-6 py-4"},Le={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},Se=["value"],Fe={key:0,class:"mt-2"},qe=["placeholder"],Be={class:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},Ae={class:"mt-4"},Ie=["placeholder"],Ee={class:"mt-4"},He={value:""},Te=["value"],Ne={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},De={key:0,class:"mt-4"},Oe=["placeholder"],Pe={class:"mt-4"},Re=["placeholder"],Qe={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Ge={class:"mt-4 flex items-center justify-end gap-3"},Je={key:0,class:"text-sm text-green-600 dark:text-green-400"},Ke=["disabled"],We={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Xe={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ye={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ze={class:"text-lg font-medium text-gray-900 dark:text-white"},et={class:"divide-y divide-gray-200 dark:divide-gray-700"},tt={key:0,class:"space-y-3"},st={class:"grid grid-cols-1 gap-3"},ot={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},rt=["placeholder"],at={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},it=["placeholder"],lt={class:"flex flex-wrap gap-3 items-end"},dt={class:"w-20"},nt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},ct={class:"w-28"},ut={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},gt={value:""},mt=["value"],vt={class:"w-28"},bt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},yt={class:"w-28"},xt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},pt=["value"],ft={class:"flex space-x-2"},ht=["onClick","disabled"],_t={key:1,class:"flex items-center justify-between"},kt={key:0,class:"flex flex-col mr-3"},wt=["onClick","disabled","title"],Ct=["onClick","disabled","title"],Vt=["onClick"],zt={class:"text-sm font-medium text-gray-900 dark:text-white"},Mt={key:0,class:"text-sm text-gray-500 dark:text-gray-400 whitespace-pre-line"},Ut={class:"text-xs text-gray-400 dark:text-gray-500 mt-1"},$t={class:"flex items-center space-x-2"},jt={class:"text-sm font-medium text-gray-900 dark:text-white mr-2"},Lt=["onClick","title"],St=["onClick","title"],Ft={class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},qt={class:"space-y-3"},Bt={class:"grid grid-cols-1 gap-3"},At=["placeholder"],It=["placeholder"],Et={class:"flex flex-wrap gap-3 items-end"},Ht={class:"w-20"},Tt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},Nt={class:"w-28"},Dt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},Ot={value:""},Pt=["value"],Rt={class:"w-28"},Qt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},Gt={class:"w-28"},Jt={class:"block text-xs text-gray-500 dark:text-gray-400 mb-1"},Kt=["value"],Wt=["disabled"],Xt={class:"space-y-6"},Yt={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800 sticky top-20"},Zt={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},es={class:"text-lg font-medium text-gray-900 dark:text-white"},ts={class:"px-6 py-4 space-y-3"},ss={class:"flex justify-between text-sm"},os={class:"text-gray-500 dark:text-gray-400"},rs={class:"font-medium text-gray-900 dark:text-white"},as={class:"flex justify-between text-sm"},is={class:"text-gray-500 dark:text-gray-400"},ls={class:"font-medium text-gray-900 dark:text-white"},ds={class:"border-t border-gray-200 dark:border-gray-700 pt-3"},ns={class:"flex justify-between"},cs={class:"text-base font-medium text-gray-900 dark:text-white"},us={class:"text-lg font-bold text-gray-900 dark:text-white"},gs={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50"},ms={class:"text-xs text-gray-500 dark:text-gray-400"},vs={key:0,class:"fixed inset-0 z-50 overflow-hidden"},bs={class:"flex items-center justify-center min-h-screen p-4"},ys={class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] flex flex-col"},xs={class:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700"},ps={class:"text-lg font-medium text-gray-900 dark:text-white"},fs={class:"flex items-center space-x-2"},hs={class:"flex items-center border border-gray-300 dark:border-gray-600 rounded-md overflow-hidden"},_s=["onClick","title"],ks=["href"],ws=["disabled"],Cs={class:"flex-1 overflow-auto p-6 bg-gray-100 dark:bg-gray-900"},Vs={key:0,class:"flex items-center justify-center h-96"},zs=["innerHTML"],Ms={class:"flex items-center justify-end px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50"},Us={class:"text-sm text-gray-500 dark:text-gray-400 mr-auto"},$s={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},js={class:"flex min-h-screen items-end justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Ls={class:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all dark:bg-gray-800 sm:my-8 sm:w-full sm:max-w-lg sm:align-middle"},Ss={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Fs={class:"sm:flex sm:items-start"},qs={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},Bs={class:"text-lg font-medium leading-6 text-gray-900 dark:text-white"},As={class:"mt-2"},Is={class:"text-sm text-gray-500 dark:text-gray-400"},Es={class:"bg-gray-50 px-4 py-3 dark:bg-gray-700 sm:flex sm:flex-row-reverse sm:px-6"},Gs={__name:"Edit",props:{invoice:Object,clients:Array,vatRates:Array,units:Array,isVatExempt:Boolean,defaultInvoiceFooter:String,vatMentionOptions:Array,defaultVatMention:String,defaultCustomVatMention:String,clientVatScenario:Object,suggestedVatMention:String,vatScenarios:Object},setup(b){var J;const{t:r}=pe(),g=b,O=g.isVatExempt?0:17,X=i=>{if(!i)return"";const s=new Date(i);return isNaN(s.getTime())?"":s.toISOString().split("T")[0]},Y=B(()=>{var i;return(i=g.clients)==null?void 0:i.find(s=>s.id===l.client_id)}),P=B(()=>{var i;return((i=Y.value)==null?void 0:i.vat_scenario)||null}),U=h(!1),z=h(!1),I=h(""),$=h(!1),S=h(null),F=h(((J=g.invoice.client)==null?void 0:J.locale)||"fr"),Z=[{value:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{value:"de",label:"Deutsch",flag:"üá©üá™"},{value:"en",label:"English",flag:"üá¨üáß"},{value:"lb",label:"L√´tzebuergesch",flag:"üá±üá∫"}],ee=B(()=>`${route("invoices.draft-pdf",g.invoice.id)}?locale=${F.value}`),u=N({title:"",description:"",quantity:1,unit:"",unit_price:0,vat_rate:17}),l=N({client_id:g.invoice.client_id,title:g.invoice.title||"",due_at:X(g.invoice.due_at),notes:g.invoice.notes||"",footer_message:g.invoice.footer_message||"",vat_mention:g.invoice.vat_mention||"",custom_vat_mention:g.invoice.custom_vat_mention||"",currency:g.invoice.currency}),m=N({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:O}),E=B(()=>{let i=0,s=0;for(const x of g.invoice.items||[])i+=parseFloat(x.total_ht)||0,s+=parseFloat(x.total_vat)||0;return{ht:i,vat:s,ttc:i+s}}),j=i=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:g.invoice.currency||"EUR"}).format(i),R=h(!1),q=h(!1);K(()=>[l.client_id,l.title,l.due_at,l.notes,l.footer_message,l.vat_mention,l.custom_vat_mention],()=>{R.value=!0,q.value=!1},{deep:!0}),K(()=>l.client_id,i=>{var s,x;if(i){const w=(s=g.clients)==null?void 0:s.find(o=>o.id===i);(x=w==null?void 0:w.vat_scenario)!=null&&x.mention&&!l.vat_mention&&(l.vat_mention=w.vat_scenario.mention)}});const te=()=>{l.put(route("invoices.update",g.invoice.id),{preserveScroll:!0,onSuccess:()=>{R.value=!1,q.value=!0,setTimeout(()=>{q.value=!1},2e3)}})},se=()=>{m.post(route("invoices.items.store",g.invoice.id),{preserveScroll:!0,onSuccess:()=>{m.reset(),m.title="",m.description="",m.quantity=1,m.unit="hour",m.vat_rate=O}})},oe=(i,s)=>{const x={hour:{singular:"heure",plural:"heures"},day:{singular:"jour",plural:"jours"},piece:{singular:"unit√©",plural:"unit√©s"},package:{singular:"forfait",plural:"forfaits"},month:{singular:"mois",plural:"mois"},word:{singular:"mot",plural:"mots"},page:{singular:"page",plural:"pages"}};return!i||!x[i]?"":s<=1?x[i].singular:x[i].plural},re=i=>{const s=parseFloat(i);return s===Math.floor(s)?Math.floor(s).toString():s.toFixed(2).replace(/\.?0+$/,"").replace(".",",")},Q=(i,s)=>{A.patch(route("invoices.items.move",[g.invoice.id,i]),{direction:s},{preserveScroll:!0})},ae=i=>{confirm(r("delete_line_confirm"))&&A.delete(route("invoices.items.destroy",[g.invoice.id,i]),{preserveScroll:!0})},G=i=>{S.value=i.id,u.title=i.title,u.description=i.description||"",u.quantity=parseFloat(i.quantity),u.unit=i.unit||"",u.unit_price=parseFloat(i.unit_price),u.vat_rate=parseFloat(i.vat_rate)},ie=()=>{S.value=null,u.reset()},le=i=>{u.put(route("invoices.items.update",[g.invoice.id,i]),{preserveScroll:!0,onSuccess:()=>{S.value=null,u.reset()}})},de=()=>{confirm(r("delete_draft_confirm"))&&A.delete(route("invoices.destroy",g.invoice.id))},ne=()=>{A.post(route("invoices.finalize",g.invoice.id),{},{onSuccess:()=>{U.value=!1}})},H=async()=>{$.value=!0;try{const i=route("invoices.preview-draft",g.invoice.id)+`?locale=${F.value}`,s=await be.get(i);I.value=s.data.html}catch(i){console.error("Error loading preview:",i),I.value=`<p style="color: red; padding: 20px;">${r("error_loading_preview")}</p>`}finally{$.value=!1}},ce=i=>{F.value=i,z.value&&H()},ue=()=>{z.value=!0,H()};return(i,s)=>(n(),d(f,null,[y(t(ge),{title:`${t(r)("invoice")} ${b.invoice.display_number}`},null,8,["title"]),y(ye,null,{header:D(()=>[e("div",fe,[e("div",he,[y(t(ve),{href:i.route("invoices.index"),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},{default:D(()=>[...s[25]||(s[25]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),e("h1",_e,a(b.invoice.title||t(r)("draft_invoice")),1),e("span",ke,a(t(r)("draft")),1)]),e("div",we,[e("button",{type:"button",onClick:ue,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[s[26]||(s[26]=e("svg",{class:"h-4 w-4 mr-1.5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"}),e("path",{"fill-rule":"evenodd",d:"M.664 10.59a1.651 1.651 0 010-1.186A10.004 10.004 0 0110 3c4.257 0 7.893 2.66 9.336 6.41.147.381.146.804 0 1.186A10.004 10.004 0 0110 17c-4.257 0-7.893-2.66-9.336-6.41zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"})],-1)),L(" "+a(t(r)("preview")),1)]),e("button",{type:"button",onClick:de,class:"inline-flex items-center rounded-md border border-red-300 bg-white px-3 py-2 text-sm font-medium text-red-700 shadow-sm hover:bg-red-50 dark:border-red-600 dark:bg-gray-700 dark:text-red-400 dark:hover:bg-gray-600"},a(t(r)("delete")),1),e("button",{type:"button",onClick:s[0]||(s[0]=x=>U.value=!0),disabled:!b.invoice.items||b.invoice.items.length===0,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed"},a(t(r)("finalize")),9,Ce)])])]),default:D(()=>{var x,w;return[e("div",Ve,[e("div",ze,[e("div",Me,[e("div",Ue,[e("h2",$e,a(t(r)("information")),1)]),e("div",je,[e("div",Le,[e("div",null,[y(C,{for:"client_id",value:t(r)("client")},null,8,["value"]),v(e("select",{id:"client_id","onUpdate:modelValue":s[1]||(s[1]=o=>t(l).client_id=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[(n(!0),d(f,null,_(b.clients,o=>(n(),d("option",{key:o.id,value:o.id},a(o.name),9,Se))),128))],512),[[M,t(l).client_id]]),y(V,{message:t(l).errors.client_id,class:"mt-2"},null,8,["message"]),P.value?(n(),d("div",Fe,[y(xe,{scenario:P.value,size:"sm"},null,8,["scenario"])])):k("",!0)]),e("div",null,[y(C,{for:"title",value:t(r)("title_optional")},null,8,["value"]),v(e("input",{id:"title","onUpdate:modelValue":s[2]||(s[2]=o=>t(l).title=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:t(r)("example_placeholder")},null,8,qe),[[p,t(l).title]]),y(V,{message:t(l).errors.title,class:"mt-2"},null,8,["message"])])]),e("div",Be,[e("div",null,[y(C,{for:"due_at",value:t(r)("due_date")},null,8,["value"]),v(e("input",{id:"due_at","onUpdate:modelValue":s[3]||(s[3]=o=>t(l).due_at=o),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},null,512),[[p,t(l).due_at]]),y(V,{message:t(l).errors.due_at,class:"mt-2"},null,8,["message"])])]),e("div",Ae,[y(C,{for:"notes",value:t(r)("notes")},null,8,["value"]),v(e("textarea",{id:"notes","onUpdate:modelValue":s[4]||(s[4]=o=>t(l).notes=o),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:t(r)("notes_placeholder")},null,8,Ie),[[p,t(l).notes]])]),e("div",Ee,[y(C,{for:"vat_mention",value:t(r)("vat_mention_optional")},null,8,["value"]),v(e("select",{id:"vat_mention","onUpdate:modelValue":s[5]||(s[5]=o=>t(l).vat_mention=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[e("option",He,a(t(r)("use_default_mention")),1),(n(!0),d(f,null,_(b.vatMentionOptions,o=>(n(),d("option",{key:o.value,value:o.value},a(o.label),9,Te))),128))],512),[[M,t(l).vat_mention]]),e("p",Ne,a(t(r)("default_mention_note")),1)]),t(l).vat_mention==="other"?(n(),d("div",De,[y(C,{for:"custom_vat_mention",value:t(r)("custom_vat_mention_label")},null,8,["value"]),v(e("textarea",{id:"custom_vat_mention","onUpdate:modelValue":s[6]||(s[6]=o=>t(l).custom_vat_mention=o),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:t(r)("custom_vat_mention_placeholder")},null,8,Oe),[[p,t(l).custom_vat_mention]])])):k("",!0),e("div",Pe,[y(C,{for:"footer_message",value:t(r)("footer_message_optional")},null,8,["value"]),v(e("textarea",{id:"footer_message","onUpdate:modelValue":s[7]||(s[7]=o=>t(l).footer_message=o),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:b.defaultInvoiceFooter},null,8,Re),[[p,t(l).footer_message]]),e("p",Qe,a(t(r)("empty_default_message"))+' "'+a(b.defaultInvoiceFooter)+'" ',1)]),e("div",Ge,[q.value?(n(),d("span",Je,a(t(r)("saved")),1)):k("",!0),e("button",{type:"button",onClick:te,disabled:t(l).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},[t(l).processing?(n(),d("svg",We,[...s[27]||(s[27]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):k("",!0),L(" "+a(t(l).processing?t(r)("saving"):t(r)("save")),1)],8,Ke)])])]),e("div",Xe,[e("div",Ye,[e("h2",Ze,a(t(r)("invoice_lines")),1)]),e("div",et,[(n(!0),d(f,null,_(b.invoice.items,(o,T)=>(n(),d("div",{key:o.id,class:"px-6 py-4"},[S.value===o.id?(n(),d("div",tt,[e("div",st,[e("div",null,[e("label",ot,a(t(r)("title")),1),v(e("input",{"onUpdate:modelValue":s[8]||(s[8]=c=>t(u).title=c),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:t(r)("service_title"),required:""},null,8,rt),[[p,t(u).title]]),y(V,{message:t(u).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[e("label",at,a(t(r)("description"))+" ("+a(t(r)("optional"))+")",1),v(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=c=>t(u).description=c),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:t(r)("detailed_description")},null,8,it),[[p,t(u).description]]),y(V,{message:t(u).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",lt,[e("div",dt,[e("label",nt,a(t(r)("quantity")),1),v(e("input",{"onUpdate:modelValue":s[10]||(s[10]=c=>t(u).quantity=c),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[p,t(u).quantity,void 0,{number:!0}]])]),e("div",ct,[e("label",ut,a(t(r)("unit")),1),v(e("select",{"onUpdate:modelValue":s[11]||(s[11]=c=>t(u).unit=c),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[e("option",gt,a(t(r)("without_unit")),1),(n(!0),d(f,null,_(b.units,c=>(n(),d("option",{key:c.value,value:c.value},a(c.label),9,mt))),128))],512),[[M,t(u).unit]])]),e("div",vt,[e("label",bt,a(t(r)("price_ht")),1),v(e("input",{"onUpdate:modelValue":s[12]||(s[12]=c=>t(u).unit_price=c),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[p,t(u).unit_price,void 0,{number:!0}]])]),e("div",yt,[e("label",xt,a(t(r)("vat")),1),v(e("select",{"onUpdate:modelValue":s[13]||(s[13]=c=>t(u).vat_rate=c),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(n(!0),d(f,null,_(b.vatRates,c=>(n(),d("option",{key:c.value,value:c.value},a(c.value)+"% ",9,pt))),128))],512),[[M,t(u).vat_rate,void 0,{number:!0}]])]),e("div",ft,[e("button",{type:"button",onClick:c=>le(o.id),disabled:t(u).processing,class:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50"},[...s[28]||(s[28]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z","clip-rule":"evenodd"})],-1)])],8,ht),e("button",{type:"button",onClick:ie,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...s[29]||(s[29]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})],-1)])])])])])):(n(),d("div",_t,[b.invoice.items.length>1?(n(),d("div",kt,[e("button",{type:"button",onClick:c=>Q(o.id,"up"),disabled:T===0,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:t(r)("move_up")},[...s[30]||(s[30]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M14.77 12.79a.75.75 0 01-1.06-.02L10 8.832 6.29 12.77a.75.75 0 11-1.08-1.04l4.25-4.5a.75.75 0 011.08 0l4.25 4.5a.75.75 0 01-.02 1.06z","clip-rule":"evenodd"})],-1)])],8,wt),e("button",{type:"button",onClick:c=>Q(o.id,"down"),disabled:T===b.invoice.items.length-1,class:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:t(r)("move_down")},[...s[31]||(s[31]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z","clip-rule":"evenodd"})],-1)])],8,Ct)])):k("",!0),e("div",{class:"flex-1 cursor-pointer",onClick:c=>G(o)},[e("p",zt,a(o.title),1),o.description?(n(),d("p",Mt,a(o.description),1)):k("",!0),e("p",Ut,a(re(o.quantity))+" "+a(oe(o.unit,o.quantity))+" x "+a(j(o.unit_price))+" (TVA "+a(o.vat_rate)+"%) ",1)],8,Vt),e("div",$t,[e("span",jt,a(j(o.total_ht)),1),e("button",{type:"button",onClick:c=>G(o),class:"p-1 text-gray-400 hover:text-indigo-600 dark:hover:text-indigo-400",title:t(r)("edit")},[...s[32]||(s[32]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M2.695 14.763l-1.262 3.154a.5.5 0 00.65.65l3.155-1.262a4 4 0 001.343-.885L17.5 5.5a2.121 2.121 0 00-3-3L3.58 13.42a4 4 0 00-.885 1.343z"})],-1)])],8,Lt),e("button",{type:"button",onClick:c=>ae(o.id),class:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400",title:t(r)("delete")},[...s[33]||(s[33]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,St)])]))]))),128)),e("form",{onSubmit:me(se,["prevent"]),class:"px-6 py-4"},[e("p",Ft,a(t(r)("add_line")),1),e("div",qt,[e("div",Bt,[e("div",null,[v(e("input",{"onUpdate:modelValue":s[14]||(s[14]=o=>t(m).title=o),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:t(r)("service_title"),required:""},null,8,At),[[p,t(m).title]]),y(V,{message:t(m).errors.title,class:"mt-1"},null,8,["message"])]),e("div",null,[v(e("textarea",{"onUpdate:modelValue":s[15]||(s[15]=o=>t(m).description=o),rows:"2",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",placeholder:t(r)("detailed_description_optional")},null,8,It),[[p,t(m).description]]),y(V,{message:t(m).errors.description,class:"mt-1"},null,8,["message"])])]),e("div",Et,[e("div",Ht,[e("label",Tt,a(t(r)("quantity")),1),v(e("input",{"onUpdate:modelValue":s[16]||(s[16]=o=>t(m).quantity=o),type:"number",step:"0.01",min:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[p,t(m).quantity,void 0,{number:!0}]])]),e("div",Nt,[e("label",Dt,a(t(r)("unit")),1),v(e("select",{"onUpdate:modelValue":s[17]||(s[17]=o=>t(m).unit=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[e("option",Ot,a(t(r)("without_unit")),1),(n(!0),d(f,null,_(b.units,o=>(n(),d("option",{key:o.value,value:o.value},a(o.label),9,Pt))),128))],512),[[M,t(m).unit]])]),e("div",Rt,[e("label",Qt,a(t(r)("price_ht")),1),v(e("input",{"onUpdate:modelValue":s[18]||(s[18]=o=>t(m).unit_price=o),type:"number",step:"0.01",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm",required:""},null,512),[[p,t(m).unit_price,void 0,{number:!0}]])]),e("div",Gt,[e("label",Jt,a(t(r)("vat")),1),v(e("select",{"onUpdate:modelValue":s[19]||(s[19]=o=>t(m).vat_rate=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white text-sm"},[(n(!0),d(f,null,_(b.vatRates,o=>(n(),d("option",{key:o.value,value:o.value},a(o.value)+"% ",9,Kt))),128))],512),[[M,t(m).vat_rate,void 0,{number:!0}]])]),e("button",{type:"submit",disabled:t(m).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},[s[34]||(s[34]=e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)),L(" "+a(t(r)("add")),1)],8,Wt)])])],32)])])]),e("div",Xt,[e("div",Yt,[e("div",Zt,[e("h2",es,a(t(r)("summary")),1)]),e("div",ts,[e("div",ss,[e("span",os,a(t(r)("total_ht")),1),e("span",rs,a(j(E.value.ht)),1)]),e("div",as,[e("span",is,a(t(r)("vat")),1),e("span",ls,a(j(E.value.vat)),1)]),e("div",ds,[e("div",ns,[e("span",cs,a(t(r)("total_ttc")),1),e("span",us,a(j(E.value.ttc)),1)])])]),e("div",gs,[e("p",ms,a(((x=b.invoice.items)==null?void 0:x.length)||0)+" "+a((((w=b.invoice.items)==null?void 0:w.length)||0)<=1?t(r)("line"):t(r)("lines")),1)])])])]),z.value?(n(),d("div",vs,[e("div",bs,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s[20]||(s[20]=o=>z.value=!1)}),e("div",ys,[e("div",xs,[e("h3",ps,a(t(r)("invoice_preview")),1),e("div",fs,[e("div",hs,[(n(),d(f,null,_(Z,o=>e("button",{key:o.value,type:"button",onClick:T=>ce(o.value),title:o.label,class:W(["px-2 py-1.5 text-base transition-colors",F.value===o.value?"bg-indigo-100 dark:bg-indigo-900":"bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"])},a(o.flag),11,_s)),64))]),e("a",{href:ee.value,target:"_blank",class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300"},[...s[35]||(s[35]=[e("svg",{class:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z"}),e("path",{d:"M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z"})],-1),L(" PDF ",-1)])],8,ks),e("button",{type:"button",onClick:H,disabled:$.value,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 disabled:opacity-50"},[(n(),d("svg",{class:W(["h-4 w-4 mr-1",{"animate-spin":$.value}]),viewBox:"0 0 20 20",fill:"currentColor"},[...s[36]||(s[36]=[e("path",{"fill-rule":"evenodd",d:"M15.312 11.424a5.5 5.5 0 01-9.201 2.466l-.312-.311h2.433a.75.75 0 000-1.5H3.989a.75.75 0 00-.75.75v4.242a.75.75 0 001.5 0v-2.43l.31.31a7 7 0 0011.712-3.138.75.75 0 00-1.449-.39zm1.23-3.723a.75.75 0 00.219-.53V2.929a.75.75 0 00-1.5 0V5.36l-.31-.31A7 7 0 003.239 8.188a.75.75 0 101.448.389A5.5 5.5 0 0113.89 6.11l.311.31h-2.432a.75.75 0 000 1.5h4.243a.75.75 0 00.53-.219z","clip-rule":"evenodd"},null,-1)])],2)),L(" "+a(t(r)("refresh")),1)],8,ws),e("button",{type:"button",onClick:s[21]||(s[21]=o=>z.value=!1),class:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300"},[...s[37]||(s[37]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",Cs,[$.value?(n(),d("div",Vs,[...s[38]||(s[38]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)])])):(n(),d("div",{key:1,class:"bg-white shadow-lg mx-auto",style:{width:"210mm","min-height":"297mm",transform:"scale(1)","transform-origin":"top center"},innerHTML:I.value},null,8,zs))]),e("div",Ms,[e("p",Us,a(t(r)("preview_finalize_note")),1),e("button",{type:"button",onClick:s[22]||(s[22]=o=>z.value=!1),class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500"},a(t(r)("close")),1)])])])])):k("",!0),U.value?(n(),d("div",$s,[e("div",js,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s[23]||(s[23]=o=>U.value=!1)}),e("div",Ls,[e("div",Ss,[e("div",Fs,[s[39]||(s[39]=e("div",{class:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",qs,[e("h3",Bs,a(t(r)("finalize_invoice_question")),1),e("div",As,[e("p",Is,a(t(r)("finalize_invoice_warning")),1)])])])]),e("div",Es,[e("button",{type:"button",onClick:ne,class:"inline-flex w-full justify-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500 sm:ml-3 sm:w-auto"},a(t(r)("finalize")),1),e("button",{type:"button",onClick:s[24]||(s[24]=o=>U.value=!1),class:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-600 dark:text-white dark:ring-gray-500 sm:mt-0 sm:w-auto"},a(t(r)("cancel")),1)])])])])):k("",!0)]}),_:1})],64))}};export{Gs as default};
