import{c as n,d as t,m as C,i as b,e as _,b as s,l as j,g as u,F as x,j as k,x as f,o,r as M,z as q,a as T,h as G,t as e,f as m,k as I,v as V,w as K,p as Q}from"./app-BIJCKN2g.js";import{_ as R}from"./AuthenticatedLayout-k4WcB7hT.js";import{u as W}from"./useTranslations-ti9iItLu.js";import"./ApplicationLogo-B-F8Zccb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-AHxS1BRo.js";const X={key:0,class:"flex items-center justify-between"},Y={class:"flex flex-1 justify-between sm:hidden"},Z={class:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-center"},tt={class:"isolate inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination"},et=["innerHTML"],st={__name:"Pagination",props:{links:Array},setup(g){return(a,c)=>g.links.length>3?(o(),n("nav",X,[t("div",Y,[g.links[0].url?(o(),C(s(j),{key:0,href:g.links[0].url,class:"relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"},{default:b(()=>[...c[0]||(c[0]=[_(" Précédent ",-1)])]),_:1},8,["href"])):u("",!0),g.links[g.links.length-1].url?(o(),C(s(j),{key:1,href:g.links[g.links.length-1].url,class:"relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"},{default:b(()=>[...c[1]||(c[1]=[_(" Suivant ",-1)])]),_:1},8,["href"])):u("",!0)]),t("div",Z,[t("div",null,[t("nav",tt,[(o(!0),n(x,null,k(g.links,(i,d)=>(o(),n(x,{key:d},[i.url?(o(),C(s(j),{key:0,href:i.url,innerHTML:i.label,class:f(["relative inline-flex items-center border px-4 py-2 text-sm font-medium focus:z-20",[i.active?"z-10 border-indigo-500 bg-indigo-50 text-indigo-600 dark:border-indigo-400 dark:bg-indigo-900/50 dark:text-indigo-400":"border-gray-300 bg-white text-gray-500 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700",d===0?"rounded-l-md":"",d===g.links.length-1?"rounded-r-md":""]])},null,8,["href","innerHTML","class"])):(o(),n("span",{key:1,innerHTML:i.label,class:f(["relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-400 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-500",[d===0?"rounded-l-md":"",d===g.links.length-1?"rounded-r-md":""]])},null,10,et))],64))),128))])])])])):u("",!0)}},at={class:"flex items-center justify-between"},rt={class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"},dt={class:"py-12"},ot={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},lt={class:"mb-6 rounded-lg bg-white p-4 shadow dark:bg-gray-800"},it={class:"grid grid-cols-1 gap-4 md:grid-cols-5"},nt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},gt={value:""},ct=["value"],ut={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},yt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},xt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},mt={value:""},ht={value:"success"},kt={value:"failed"},bt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},_t=["placeholder"],ft={class:"mt-4 flex justify-end"},pt={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},vt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},wt={class:"bg-gray-50 dark:bg-gray-700"},Ct={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"},jt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"},Mt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"},Tt={class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"},Vt={class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"},$t={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},Bt={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-200"},Lt={class:"text-xs text-gray-500 dark:text-gray-400"},St={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-200"},zt={class:"mr-2"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},Nt={key:0},Ot={key:1},Pt={class:"whitespace-nowrap px-6 py-4 text-sm"},Ut={class:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400"},Ht={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},Dt=["onClick"],It={key:0},At={colspan:"6",class:"px-6 py-12 text-center text-sm text-gray-500 dark:text-gray-400"},Et={key:0,class:"border-t border-gray-200 px-4 py-3 dark:border-gray-700"},Jt={class:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0"},qt={class:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all dark:bg-gray-800 sm:my-8 sm:w-full sm:max-w-2xl sm:align-middle"},Gt={class:"bg-white px-4 pb-4 pt-5 dark:bg-gray-800 sm:p-6 sm:pb-4"},Kt={class:"flex items-start justify-between"},Qt={class:"text-lg font-medium leading-6 text-gray-900 dark:text-gray-100"},Rt={class:"mt-4 space-y-4"},Wt={class:"grid grid-cols-2 gap-4 text-sm"},Xt={class:"font-medium text-gray-500 dark:text-gray-400"},Yt={class:"ml-2 text-gray-900 dark:text-gray-100"},Zt={class:"font-medium text-gray-500 dark:text-gray-400"},te={key:0},ee={class:"font-medium text-gray-500 dark:text-gray-400"},se={class:"ml-2 text-gray-900 dark:text-gray-100"},ae={class:"ml-2 text-gray-900 dark:text-gray-100"},re={key:0},de={class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},oe={class:"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-600"},le={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-600"},ie={class:"bg-gray-50 dark:bg-gray-700"},ne={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},ge={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},ce={class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300"},ue={class:"divide-y divide-gray-200 dark:divide-gray-600"},ye={class:"px-4 py-2 text-sm font-medium text-gray-900 dark:text-gray-100"},xe={class:"px-4 py-2 text-sm text-red-600 dark:text-red-400"},me={class:"px-4 py-2 text-sm text-green-600 dark:text-green-400"},he={key:1},ke={class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},be={class:"overflow-auto rounded-lg bg-gray-100 p-3 text-xs dark:bg-gray-700"},_e={key:2},fe={class:"mb-2 font-medium text-gray-900 dark:text-gray-100"},pe={class:"break-all text-sm text-gray-600 dark:text-gray-400"},ve={class:"bg-gray-50 px-4 py-3 dark:bg-gray-700 sm:flex sm:flex-row-reverse sm:px-6"},$e={__name:"Index",props:{logs:Object,filters:Object,categories:Array},setup(g){const{t:a}=W(),c=g,i=M({category:c.filters.category||"",from:c.filters.from||"",to:c.filters.to||"",status:c.filters.status||"",search:c.filters.search||""}),d=M(null),p=M(!1),y=()=>{Q.get(route("audit-logs.index"),{...i.value},{preserveState:!0,preserveScroll:!0})},A=()=>{i.value={category:"",from:"",to:"",status:"",search:""},y()},E=h=>{d.value=h,p.value=!0},v=()=>{p.value=!1,d.value=null},J=()=>{window.location.href=route("audit-logs.export",i.value)},$=h=>h==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";let B;return q(()=>i.value.search,()=>{clearTimeout(B),B=setTimeout(y,500)}),(h,l)=>(o(),n(x,null,[T(s(G),{title:s(a)("audit_logs")},null,8,["title"]),T(R,null,{header:b(()=>[t("div",at,[t("h2",rt,e(s(a)("audit_logs")),1),t("button",{onClick:J,class:"inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-200 dark:ring-gray-600 dark:hover:bg-gray-600"},[l[5]||(l[5]=t("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),_(" "+e(s(a)("export_csv")),1)])])]),default:b(()=>{var L,S,z,F,N,O,P,U,H,D;return[t("div",dt,[t("div",ot,[t("div",lt,[t("div",it,[t("div",null,[t("label",nt,e(s(a)("category")),1),m(t("select",{"onUpdate:modelValue":l[0]||(l[0]=r=>i.value.category=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},[t("option",gt,e(s(a)("all")),1),(o(!0),n(x,null,k(g.categories,r=>(o(),n("option",{key:r.value,value:r.value},e(r.label),9,ct))),128))],544),[[I,i.value.category]])]),t("div",null,[t("label",ut,e(s(a)("from_date")),1),m(t("input",{type:"date","onUpdate:modelValue":l[1]||(l[1]=r=>i.value.from=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,544),[[V,i.value.from]])]),t("div",null,[t("label",yt,e(s(a)("to_date")),1),m(t("input",{type:"date","onUpdate:modelValue":l[2]||(l[2]=r=>i.value.to=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,544),[[V,i.value.to]])]),t("div",null,[t("label",xt,e(s(a)("status")),1),m(t("select",{"onUpdate:modelValue":l[3]||(l[3]=r=>i.value.status=r),onChange:y,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},[t("option",mt,e(s(a)("all")),1),t("option",ht,e(s(a)("success")),1),t("option",kt,e(s(a)("failed")),1)],544),[[I,i.value.status]])]),t("div",null,[t("label",bt,e(s(a)("search")),1),m(t("input",{type:"text","onUpdate:modelValue":l[4]||(l[4]=r=>i.value.search=r),placeholder:s(a)("search_placeholder"),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-200"},null,8,_t),[[V,i.value.search]])])]),t("div",ft,[t("button",{onClick:A,class:"text-sm text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200"},e(s(a)("reset_filters")),1)])]),t("div",pt,[t("table",vt,[t("thead",wt,[t("tr",null,[t("th",Ct,e(s(a)("date_time")),1),t("th",jt,e(s(a)("action")),1),t("th",Mt,e(s(a)("resource")),1),t("th",Tt,e(s(a)("status")),1),l[6]||(l[6]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-300"}," IP ",-1)),t("th",Vt,e(s(a)("actions")),1)])]),t("tbody",$t,[(o(!0),n(x,null,k(g.logs.data,r=>(o(),n("tr",{key:r.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Bt,[t("div",null,e(r.created_at),1),t("div",Lt,e(r.created_at_human),1)]),t("td",St,[t("span",zt,e(r.action_emoji),1),_(" "+e(r.action_label),1)]),t("td",Ft,[r.auditable_type?(o(),n("span",Nt,e(r.auditable_type)+" #"+e(r.auditable_id),1)):(o(),n("span",Ot,"-"))]),t("td",Pt,[t("span",{class:f([$(r.status),"inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(r.status==="success"?s(a)("success"):s(a)("failed")),3)]),t("td",Ut,e(r.ip_address||"-"),1),t("td",Ht,[t("button",{onClick:w=>E(r),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},e(s(a)("details")),9,Dt)])]))),128)),g.logs.data.length===0?(o(),n("tr",It,[t("td",At,e(s(a)("no_audit_entries")),1)])):u("",!0)])]),g.logs.data.length>0?(o(),n("div",Et,[T(st,{links:g.logs.links},null,8,["links"])])):u("",!0)])])]),p.value?(o(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:K(v,["self"])},[t("div",Jt,[l[9]||(l[9]=t("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[t("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900"})],-1)),l[10]||(l[10]=t("span",{class:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"},"​",-1)),t("div",qt,[t("div",Gt,[t("div",Kt,[t("h3",Qt,e((L=d.value)==null?void 0:L.action_emoji)+" "+e((S=d.value)==null?void 0:S.action_label),1),t("button",{onClick:v,class:"text-gray-400 hover:text-gray-500"},[...l[7]||(l[7]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Rt,[t("div",Wt,[t("div",null,[t("span",Xt,e(s(a)("date"))+" :",1),t("span",Yt,e((z=d.value)==null?void 0:z.created_at),1)]),t("div",null,[t("span",Zt,e(s(a)("status"))+" :",1),t("span",{class:f([$((F=d.value)==null?void 0:F.status),"ml-2 inline-flex rounded-full px-2 text-xs font-semibold leading-5"])},e(((N=d.value)==null?void 0:N.status)==="success"?s(a)("success"):s(a)("failed")),3)]),(O=d.value)!=null&&O.auditable_type?(o(),n("div",te,[t("span",ee,e(s(a)("resource"))+" :",1),t("span",se,e(d.value.auditable_type)+" #"+e(d.value.auditable_id),1)])):u("",!0),t("div",null,[l[8]||(l[8]=t("span",{class:"font-medium text-gray-500 dark:text-gray-400"},"IP :",-1)),t("span",ae,e(((P=d.value)==null?void 0:P.ip_address)||"-"),1)])]),(U=d.value)!=null&&U.changed_fields&&Object.keys(d.value.changed_fields).length>0?(o(),n("div",re,[t("h4",de,e(s(a)("changes"))+" :",1),t("div",oe,[t("table",le,[t("thead",ie,[t("tr",null,[t("th",ne,e(s(a)("field")),1),t("th",ge,e(s(a)("before")),1),t("th",ce,e(s(a)("after")),1)])]),t("tbody",ue,[(o(!0),n(x,null,k(d.value.changed_fields,(r,w)=>(o(),n("tr",{key:w},[t("td",ye,e(w),1),t("td",xe,e(r.old??"-"),1),t("td",me,e(r.new??"-"),1)]))),128))])])])])):u("",!0),(H=d.value)!=null&&H.metadata&&Object.keys(d.value.metadata).length>0?(o(),n("div",he,[t("h4",ke,e(s(a)("metadata"))+" :",1),t("pre",be,e(JSON.stringify(d.value.metadata,null,2)),1)])):u("",!0),(D=d.value)!=null&&D.user_agent?(o(),n("div",_e,[t("h4",fe,e(s(a)("browser"))+" :",1),t("p",pe,e(d.value.user_agent),1)])):u("",!0)])]),t("div",ve,[t("button",{onClick:v,class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-600 sm:ml-3 sm:mt-0 sm:w-auto sm:text-sm"},e(s(a)("close")),1)])])])])):u("",!0)]}),_:1})],64))}};export{$e as default};
