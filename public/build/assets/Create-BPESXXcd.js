import{e as S,c as l,a,u as s,h as T,w as p,b as e,f as M,q as g,o as n,F as f,r as y,t as k,v as _,d as V,B as m,g as U,s as $,A as C}from"./app-BNdkYu5R.js";import{_ as j}from"./AppLayout-CQ5EpIy-.js";import{_ as c,a as v}from"./InputError-j9SVREoo.js";import{P as D}from"./PrimaryButton-CRxPFKvX.js";import{_ as E}from"./VatScenarioIndicator-DuT__XLE.js";import"./ApplicationLogo-Btd2wIUd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-7-ZIUky-.js";const P={class:"flex items-center space-x-4"},z={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},I={class:"px-6 py-4"},R={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},F=["value"],H={key:0,class:"mt-2"},L={class:"mt-4"},O={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Q={class:"px-6 py-4"},G={class:"space-y-4"},J={class:"flex flex-wrap gap-4 items-end"},K={class:"flex-1 min-w-[200px]"},W=["id","onUpdate:modelValue"],X={class:"flex flex-wrap gap-4 items-end"},Y={class:"flex-1 min-w-[200px]"},Z=["id","onUpdate:modelValue"],ee={class:"w-24"},te=["id","onUpdate:modelValue"],re={class:"w-32"},oe=["id","onUpdate:modelValue"],de=["value"],ae={class:"w-32"},se=["id","onUpdate:modelValue"],ie={class:"w-32"},le=["id","onUpdate:modelValue"],ne=["value"],ue=["onClick"],ge={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},ce={class:"px-6 py-4"},me={class:"flex justify-end space-x-3"},pe={key:0},fe={key:1},Ve={__name:"Create",props:{clients:Array,vatRates:Array,units:Array,defaultClientId:[String,Number],isVatExempt:Boolean,vatScenarios:Object},setup(b){const h=b,A=h.isVatExempt?0:17,q=C(()=>{var u;return(u=h.clients)==null?void 0:u.find(t=>t.id===o.client_id)}),x=C(()=>{var u;return((u=q.value)==null?void 0:u.vat_scenario)||null}),o=S({client_id:h.defaultClientId||"",title:"",due_at:"",notes:"",currency:"EUR",items:[]}),w=()=>{o.items.push({title:"",description:"",quantity:1,unit:"hour",unit_price:0,vat_rate:A})},B=u=>{o.items.splice(u,1)},N=()=>{o.post(route("invoices.store"))};return o.items.length===0&&w(),(u,t)=>(n(),l(f,null,[a(s(T),{title:"Nouvelle facture"}),a(j,null,{header:p(()=>[e("div",P,[a(s($),{href:u.route("invoices.index"),class:"text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400"},{default:p(()=>[...t[4]||(t[4]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z","clip-rule":"evenodd"})],-1)])]),_:1},8,["href"]),t[5]||(t[5]=e("h1",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Nouvelle facture ",-1))])]),default:p(()=>[e("form",{onSubmit:M(N,["prevent"]),class:"space-y-6"},[e("div",z,[t[8]||(t[8]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Client")],-1)),e("div",I,[e("div",R,[e("div",null,[a(c,{for:"client_id",value:"Client"}),g(e("select",{id:"client_id","onUpdate:modelValue":t[0]||(t[0]=r=>s(o).client_id=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},[t[6]||(t[6]=e("option",{value:""},"Sélectionner un client",-1)),(n(!0),l(f,null,y(b.clients,r=>(n(),l("option",{key:r.id,value:r.id},k(r.name),9,F))),128))],512),[[_,s(o).client_id]]),a(v,{message:s(o).errors.client_id,class:"mt-2"},null,8,["message"]),x.value?(n(),l("div",H,[a(E,{scenario:x.value,size:"sm"},null,8,["scenario"])])):V("",!0)]),e("div",null,[a(c,{for:"title",value:"Titre (optionnel)"}),g(e("input",{id:"title","onUpdate:modelValue":t[1]||(t[1]=r=>s(o).title=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ex: Prestation janvier 2026"},null,512),[[m,s(o).title]]),a(v,{message:s(o).errors.title,class:"mt-2"},null,8,["message"])])]),e("div",L,[a(c,{for:"due_at",value:"Date d'échéance (optionnel)"}),g(e("input",{id:"due_at","onUpdate:modelValue":t[2]||(t[2]=r=>s(o).due_at=r),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white sm:max-w-xs"},null,512),[[m,s(o).due_at]]),t[7]||(t[7]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Par défaut: 30 jours après finalisation ",-1)),a(v,{message:s(o).errors.due_at,class:"mt-2"},null,8,["message"])])])]),e("div",O,[t[12]||(t[12]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Lignes de facture")],-1)),e("div",Q,[e("div",G,[(n(!0),l(f,null,y(s(o).items,(r,i)=>(n(),l("div",{key:i,class:"p-4 rounded-lg border border-gray-200 dark:border-gray-700 space-y-3"},[e("div",J,[e("div",K,[a(c,{for:`item-${i}-title`,value:"Titre *"},null,8,["for"]),g(e("input",{id:`item-${i}-title`,"onUpdate:modelValue":d=>r.title=d,type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Titre de la prestation",required:""},null,8,W),[[m,r.title]])])]),e("div",X,[e("div",Y,[a(c,{for:`item-${i}-description`,value:"Description (optionnel)"},null,8,["for"]),g(e("input",{id:`item-${i}-description`,"onUpdate:modelValue":d=>r.description=d,type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Détails supplémentaires..."},null,8,Z),[[m,r.description]])]),e("div",ee,[a(c,{for:`item-${i}-quantity`,value:"Qté"},null,8,["for"]),g(e("input",{id:`item-${i}-quantity`,"onUpdate:modelValue":d=>r.quantity=d,type:"number",step:"0.01",min:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},null,8,te),[[m,r.quantity,void 0,{number:!0}]])]),e("div",re,[a(c,{for:`item-${i}-unit`,value:"Unité"},null,8,["for"]),g(e("select",{id:`item-${i}-unit`,"onUpdate:modelValue":d=>r.unit=d,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[t[9]||(t[9]=e("option",{value:""},"-",-1)),(n(!0),l(f,null,y(b.units,d=>(n(),l("option",{key:d.value,value:d.value},k(d.label),9,de))),128))],8,oe),[[_,r.unit]])]),e("div",ae,[a(c,{for:`item-${i}-unit_price`,value:"Prix HT"},null,8,["for"]),g(e("input",{id:`item-${i}-unit_price`,"onUpdate:modelValue":d=>r.unit_price=d,type:"number",step:"0.01",min:"0",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},null,8,se),[[m,r.unit_price,void 0,{number:!0}]])]),e("div",ie,[a(c,{for:`item-${i}-vat_rate`,value:"TVA"},null,8,["for"]),g(e("select",{id:`item-${i}-vat_rate`,"onUpdate:modelValue":d=>r.vat_rate=d,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",required:""},[(n(!0),l(f,null,y(b.vatRates,d=>(n(),l("option",{key:d.value,value:d.value},k(d.label),9,ne))),128))],8,le),[[_,r.vat_rate,void 0,{number:!0}]])]),s(o).items.length>1?(n(),l("button",{key:0,type:"button",onClick:d=>B(i),class:"p-2 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300"},[...t[10]||(t[10]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 006 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 10.23 1.482l.149-.022.841 10.518A2.75 2.75 0 007.596 19h4.807a2.75 2.75 0 002.742-2.53l.841-10.519.149.023a.75.75 0 00.23-1.482A41.03 41.03 0 0014 4.193V3.75A2.75 2.75 0 0011.25 1h-2.5z","clip-rule":"evenodd"})],-1)])],8,ue)):V("",!0)])]))),128)),e("button",{type:"button",onClick:w,class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},[...t[11]||(t[11]=[e("svg",{class:"-ml-0.5 mr-1.5 h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),U(" Ajouter une ligne ",-1)])])])])]),e("div",ge,[t[13]||(t[13]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"},"Notes (optionnel)")],-1)),e("div",ce,[g(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=r=>s(o).notes=r),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Notes ou conditions particulières..."},null,512),[[m,s(o).notes]]),a(v,{message:s(o).errors.notes,class:"mt-2"},null,8,["message"])])]),e("div",me,[a(s($),{href:u.route("invoices.index"),class:"inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"},{default:p(()=>[...t[14]||(t[14]=[U(" Annuler ",-1)])]),_:1},8,["href"]),a(D,{disabled:s(o).processing},{default:p(()=>[s(o).processing?(n(),l("span",pe,"Création...")):(n(),l("span",fe,"Créer le brouillon"))]),_:1},8,["disabled"])])],32)]),_:1})],64))}};export{Ve as default};
