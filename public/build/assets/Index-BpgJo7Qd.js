import{u as S,c as d,a as p,b as s,h as I,i as y,d as e,o as i,t,g as b,C as V,F as x,j as _,f as w,k as $,s as L,B as O,r as C,p as H}from"./app-_Ll5hJPu.js";import{_ as N}from"./AppLayout-Cl3wLLjS.js";import{u as P}from"./useTranslations-BRVMXv9I.js";import"./DropdownLink-BEhWGNeD.js";const R={class:"text-xl font-semibold text-slate-900 dark:text-white"},T={class:"py-6"},U={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},E={key:0,class:"mb-6 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-2xl p-4"},W={class:"flex"},q={class:"ml-3"},G={class:"text-sm font-medium text-amber-800 dark:text-amber-300"},J={class:"mt-1 text-sm text-amber-700 dark:text-amber-400"},K={class:"bg-white dark:bg-slate-800 shadow rounded-2xl p-6 mb-6"},Q={class:"text-lg font-medium text-slate-900 dark:text-white mb-4"},X={class:"mb-4"},Y={class:"flex justify-between text-sm text-slate-600 dark:text-slate-400 mb-1"},Z={class:"w-full bg-slate-200 dark:bg-slate-700 rounded-full h-3"},ee={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},te={class:"text-center p-3 bg-slate-50 dark:bg-slate-700 rounded-2xl"},se={class:"text-2xl font-bold text-slate-900 dark:text-white"},ae={class:"text-sm text-slate-500 dark:text-slate-400"},le={class:"text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-2xl"},oe={class:"text-2xl font-bold text-green-600 dark:text-green-400"},re={class:"text-sm text-green-600 dark:text-green-400"},de={class:"text-center p-3 bg-amber-50 dark:bg-amber-900/20 rounded-2xl"},ie={class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},ne={class:"text-sm text-amber-600 dark:text-amber-400"},ce={class:"text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-2xl"},he={class:"text-2xl font-bold text-blue-600 dark:text-blue-400"},ue={class:"text-sm text-blue-600 dark:text-blue-400"},xe={key:0,class:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700"},ve={class:"text-sm text-slate-600 dark:text-slate-400"},_e={class:"flex gap-4 mt-2"},be={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},me={class:"bg-white dark:bg-slate-800 shadow rounded-2xl p-6"},ge={class:"flex items-center justify-between mb-4"},fe={class:"text-lg font-medium text-slate-900 dark:text-white"},ke=["value"],pe={key:0,class:"text-center py-8 text-slate-500 dark:text-slate-400"},ye={key:1},we={class:"flex items-center gap-4 mb-3 pb-3 border-b border-slate-200 dark:border-slate-700"},Ce={class:"flex items-center"},Ae={class:"ml-2 text-sm text-slate-600 dark:text-slate-400"},je=["disabled"],ze={key:0},Me={key:1},Be={class:"space-y-2 max-h-96 overflow-y-auto"},De={class:"flex items-center gap-3"},Fe=["checked","onChange"],Se={class:"text-sm font-medium text-slate-900 dark:text-white"},Ie={class:"text-xs text-slate-500 dark:text-slate-400"},Ve=["onClick","title"],$e={class:"bg-white dark:bg-slate-800 shadow rounded-2xl p-6"},Le={class:"text-lg font-medium text-slate-900 dark:text-white mb-4"},Oe={key:0,class:"text-center py-8 text-slate-500 dark:text-slate-400"},He={key:1,class:"space-y-2 max-h-96 overflow-y-auto"},Ne={class:"flex-1 min-w-0"},Pe={class:"flex items-center gap-2"},Re={class:"text-sm font-medium text-slate-900 dark:text-white"},Te={class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300"},Ue={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},Ee={class:"mt-1 text-xs text-slate-400 dark:text-slate-500 font-mono truncate"},We={class:"flex items-center gap-1 ml-4"},qe=["href","title"],Ge=["onClick","title"],Je={class:"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-2xl p-4"},Ke={class:"flex"},Qe={class:"ml-3"},Xe={class:"text-sm font-medium text-blue-800 dark:text-blue-300"},Ye={class:"mt-1 text-sm text-blue-700 dark:text-blue-400"},at={__name:"Index",props:{stats:Object,pendingInvoices:Array,recentlyArchived:Array,ghostscriptAvailable:Boolean,formats:Object},setup(n){const{t:a}=P(),m=n,c=C([]),v=C(!1),u=S({invoice_ids:[],format:"pdfa-1b"}),A=r=>{const o=c.value.indexOf(r);o===-1?c.value.push(r):c.value.splice(o,1)},j=()=>{v.value?c.value=m.pendingInvoices.map(r=>r.id):c.value=[]},z=r=>{H.post(route("invoices.archive",r.id),{format:u.format})},M=()=>{c.value.length!==0&&(u.invoice_ids=c.value,u.post(route("archive.batch"),{onSuccess:()=>{c.value=[],v.value=!1}}))},B=async r=>{try{const l=await(await fetch(route("invoices.archive.verify",r.id))).json();l.valid?alert(a("integrity_verified")):alert(a("integrity_error",{error:l.error}))}catch{alert(a("verification_error"))}},g=r=>r?new Date(r).toLocaleDateString("fr-FR"):"-",D=r=>r?new Date(r).toLocaleString("fr-FR"):"-",f=r=>({"pdfa-1b":"PDF/A-1b","pdfa-3b":"PDF/A-3b",pdf:"PDF"})[r]||r,F=O(()=>`${m.stats.archive_percentage}%`);return(r,o)=>(i(),d(x,null,[p(s(I),{title:s(a)("pdf_a_archiving")},null,8,["title"]),p(N,null,{header:y(()=>[e("h1",R,t(s(a)("archive_title")),1)]),default:y(()=>[e("div",T,[e("div",U,[n.ghostscriptAvailable?b("",!0):(i(),d("div",E,[e("div",W,[o[2]||(o[2]=e("svg",{class:"h-5 w-5 text-amber-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),e("div",q,[e("h3",G,t(s(a)("pdfa_not_available")),1),e("p",J,t(s(a)("ghostscript_not_installed")),1)])])])),e("div",K,[e("h2",Q,t(s(a)("global_status")),1),e("div",X,[e("div",Y,[e("span",null,t(s(a)("documents_archived",{count:n.stats.total_archived,total:n.stats.total_finalized})),1),e("span",null,t(n.stats.archive_percentage)+"%",1)]),e("div",Z,[e("div",{class:"bg-violet-600 h-3 rounded-full transition-all duration-500",style:V({width:F.value})},null,4)])]),e("div",ee,[e("div",te,[e("div",se,t(n.stats.total_finalized),1),e("div",ae,t(s(a)("total_finalized")),1)]),e("div",le,[e("div",oe,t(n.stats.total_archived),1),e("div",re,t(s(a)("archived")),1)]),e("div",de,[e("div",ie,t(n.stats.not_archived),1),e("div",ne,t(s(a)("waiting")),1)]),e("div",ce,[e("div",he,t(n.stats.expiring_this_year),1),e("div",ue,t(s(a)("expire_this_year")),1)])]),Object.keys(n.stats.by_format).length>0?(i(),d("div",xe,[e("div",ve,t(s(a)("by_format")),1),e("div",_e,[(i(!0),d(x,null,_(n.stats.by_format,(l,h)=>(i(),d("span",{key:h,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-300"},t(f(h))+": "+t(l),1))),128))])])):b("",!0)]),e("div",be,[e("div",me,[e("div",ge,[e("h2",fe,t(s(a)("unarchived_documents",{count:n.pendingInvoices.length})),1),w(e("select",{"onUpdate:modelValue":o[0]||(o[0]=l=>s(u).format=l),class:"text-sm rounded-xl border-slate-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white"},[(i(!0),d(x,null,_(n.formats,(l,h)=>(i(),d("option",{key:h,value:h},t(l),9,ke))),128))],512),[[$,s(u).format]])]),n.pendingInvoices.length===0?(i(),d("div",pe,t(s(a)("all_documents_archived")),1)):(i(),d("div",ye,[e("div",we,[e("label",Ce,[w(e("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>v.value=l),onChange:j,type:"checkbox",class:"h-4 w-4 rounded text-violet-600 focus:ring-violet-500 border-slate-300 dark:border-slate-600"},null,544),[[L,v.value]]),e("span",Ae,t(s(a)("select_all")),1)]),c.value.length>0?(i(),d("button",{key:0,onClick:M,disabled:s(u).processing,class:"ml-auto px-3 py-1 text-sm bg-violet-600 text-white rounded-2xl hover:bg-violet-700 disabled:opacity-50"},[s(u).processing?(i(),d("span",ze,t(s(a)("archiving")),1)):(i(),d("span",Me,t(s(a)("archive_selected",{count:c.value.length})),1))],8,je)):b("",!0)]),e("div",Be,[(i(!0),d(x,null,_(n.pendingInvoices,l=>{var h;return i(),d("div",{key:l.id,class:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700 rounded-2xl"},[e("div",De,[e("input",{type:"checkbox",checked:c.value.includes(l.id),onChange:k=>A(l.id),class:"h-4 w-4 rounded text-violet-600 focus:ring-violet-500 border-slate-300 dark:border-slate-600"},null,40,Fe),e("div",null,[e("div",Se,t(l.number),1),e("div",Ie,t((h=l.client)==null?void 0:h.name)+" | "+t(g(l.issued_at)),1)])]),e("button",{onClick:k=>z(l),class:"p-2 text-violet-600 hover:bg-violet-100 dark:hover:bg-violet-900/30 rounded-2xl",title:s(a)("archive_action")},[...o[3]||(o[3]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)])],8,Ve)])}),128))])]))]),e("div",$e,[e("h2",Le,t(s(a)("recently_archived")),1),n.recentlyArchived.length===0?(i(),d("div",Oe,t(s(a)("no_archived_documents")),1)):(i(),d("div",He,[(i(!0),d(x,null,_(n.recentlyArchived,l=>{var h;return i(),d("div",{key:l.id,class:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700 rounded-2xl"},[e("div",Ne,[e("div",Pe,[e("span",Re,t(l.number),1),e("span",Te,t(f(l.archive_format)),1)]),e("div",Ue,[e("span",null,t(s(a)("archived_on",{date:D(l.archived_at)})),1),o[4]||(o[4]=e("span",{class:"mx-1"},"|",-1)),e("span",null,t(s(a)("expires_on",{date:g(l.archive_expires_at)})),1)]),e("div",Ee," SHA256: "+t((h=l.archive_checksum)==null?void 0:h.substring(0,16))+"... ",1)]),e("div",We,[e("a",{href:r.route("invoices.archive.download",l.id),class:"p-2 text-violet-600 hover:bg-violet-100 dark:hover:bg-violet-900/30 rounded-2xl",title:s(a)("download")},[...o[5]||(o[5]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)])],8,qe),e("button",{onClick:k=>B(l),class:"p-2 text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-600 rounded-2xl",title:s(a)("verify_integrity")},[...o[6]||(o[6]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)])],8,Ge)])])}),128))]))])]),e("div",Je,[e("div",Ke,[o[7]||(o[7]=e("svg",{class:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",Qe,[e("h3",Xe,t(s(a)("luxembourg_archiving")),1),e("p",Ye,t(s(a)("archiving_info")),1)])])])])])]),_:1})],64))}};export{at as default};
